{
	"name": "M_PRE_DIM_GUARANTEE_ME",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "lake_raw_paris",
						"type": "DatasetReference"
					},
					"name": "ADLPpeatable"
				},
				{
					"dataset": {
						"referenceName": "lake_raw_paris",
						"type": "DatasetReference"
					},
					"name": "ADLPlgatable"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "dwh_prepare_pre_dim",
						"type": "DatasetReference"
					},
					"name": "SinkToPreDimGuarantee"
				}
			],
			"transformations": [
				{
					"name": "JoinPpeatablePlgatable"
				},
				{
					"name": "Expression"
				},
				{
					"name": "Constant"
				},
				{
					"name": "SelectFraPPeatable"
				},
				{
					"name": "SelectFraJoinerTilExpression"
				},
				{
					"name": "SelectFraJoinerTilSink"
				},
				{
					"name": "UnionPrepareSink"
				},
				{
					"name": "SelectFraExpression"
				},
				{
					"name": "PrepareSink"
				}
			],
			"script": "source(output(\n\t\tPEAPEAID as decimal(38,18),\n\t\tPEACCODE as decimal(38,18),\n\t\tPEACOMP2 as decimal(38,18),\n\t\tPEASTOPUSE as string,\n\t\tPEAINVISIBLE as string,\n\t\tPEAPERSID as string,\n\t\tPEACOLID as string,\n\t\tPEAMDESCR as string,\n\t\tPEALANG2 as string,\n\t\tPEABIRTWS as decimal(38,18),\n\t\tPEASUBTYPE as decimal(38,18),\n\t\tPEABIRTNO as string,\n\t\tPEASW10 as string,\n\t\tPEAPERSRFL as decimal(38,18),\n\t\tPEASTOPCOD as decimal(38,18),\n\t\tPEARESDAT as decimal(38,18),\n\t\tPEAINCREDAY as decimal(38,18),\n\t\tPEAINGIRO as decimal(38,18),\n\t\tPEAINGIRONO as string,\n\t\tPEANOTACO as decimal(38,18),\n\t\tPEAPURTYP as decimal(38,18),\n\t\tPEANOTLAY as decimal(38,18),\n\t\tPEANOTSORT as decimal(38,18),\n\t\tPEASWINK as decimal(38,18),\n\t\tPEAOUTCREDAY as decimal(38,18),\n\t\tPEAOUTGIRO as decimal(38,18),\n\t\tPEAOUTGIRONO as string,\n\t\tPEASWRUN as decimal(38,18),\n\t\tPEACLOMET as decimal(38,18),\n\t\tPEANOPDUE as decimal(38,18),\n\t\tPEASTATYP as decimal(38,18),\n\t\tPEASTAAMT as decimal(38,18),\n\t\tPEASTTNIV as decimal(38,18),\n\t\tPEASTANIV as decimal(38,18),\n\t\tPEACLMADV as decimal(38,18),\n\t\tPEAAPROBO as decimal(38,18),\n\t\tPEAAADDBO as decimal(38,18),\n\t\tPEAACLOBO as decimal(38,18),\n\t\tPEAACLMBO as decimal(38,18),\n\t\tPEAACORBO as decimal(38,18),\n\t\tPEAMEXCDATE as decimal(38,18),\n\t\tPEAMEXCURR as string,\n\t\tPEAMEXAMT as decimal(38,18),\n\t\tPEAMEXPRO as decimal(38,18),\n\t\tPEACCLCURR as string,\n\t\tPEACCLAMT as decimal(38,18),\n\t\tPEACCINT as string,\n\t\tPEACCINTR as decimal(38,18),\n\t\tPEACALCURR as string,\n\t\tPEACALAMT as decimal(38,18),\n\t\tPEAXLCURR as string,\n\t\tPEAXLPOIN as decimal(38,18),\n\t\tPEAIYEAR as decimal(38,18),\n\t\tPEASTENSW as decimal(38,18),\n\t\tPEASTDATE as decimal(38,18),\n\t\tPEAENDATE as decimal(38,18),\n\t\tPEAMAXPER as decimal(38,18),\n\t\tPEAIEDIV as string,\n\t\tPEAIEBUSNDIV as decimal(38,18),\n\t\tPEAIE2BUSNDIV as decimal(38,18),\n\t\tPEAIE3BUSNDIV as decimal(38,18),\n\t\tPEAIESECT as string,\n\t\tPEAIEBUSNSE as decimal(38,18),\n\t\tPEAIE2BUSNSE as decimal(38,18),\n\t\tPEAIE3BUSNSE as decimal(38,18),\n\t\tPEAIEINT as string,\n\t\tPEAIEINT1 as string,\n\t\tPEAIEINT2 as string,\n\t\tPEAIEINT3 as string,\n\t\tPEAIEINT4 as string,\n\t\tPEAIEINT5 as string,\n\t\tPEAIECOND as string,\n\t\tPEAIECON1 as decimal(38,18),\n\t\tPEAIECON2 as decimal(38,18),\n\t\tPEAIECON3 as decimal(38,18),\n\t\tPEAIECON4 as decimal(38,18),\n\t\tPEAIECON5 as decimal(38,18),\n\t\tPEACRDATE as decimal(38,18),\n\t\tPEACRSIGN as string,\n\t\tPEALUDATE as decimal(38,18),\n\t\tPEALUSIGN as string,\n\t\tPEASEX as string,\n\t\tPEAVATNO as string,\n\t\tPEAORGNO as string,\n\t\tPEANOPURR as string,\n\t\tPEAACLMADV as decimal(38,18),\n\t\tPEAADDBOR as decimal(38,18),\n\t\tPEAADDMAILFREQ as decimal(38,18),\n\t\tPEACLAMAILFREQ as decimal(38,18),\n\t\tPEACLMBOR as decimal(38,18),\n\t\tPEACLMINTYNSW as string,\n\t\tPEACLMMAILFREQ as decimal(38,18),\n\t\tPEACLOBOR as decimal(38,18),\n\t\tPEACLOSMAILFREQ as decimal(38,18),\n\t\tPEACORBO as decimal(38,18),\n\t\tPEACORRMAILFREQ as decimal(38,18),\n\t\tPEADUEDAY as decimal(38,18),\n\t\tPEAFROMCOMP as decimal(38,18),\n\t\tPEAINGIROLUDATE as decimal(38,18),\n\t\tPEAINGIROLUSIGN as string,\n\t\tPEAINVNOTIFY as decimal(38,18),\n\t\tPEAKNVMARK as string,\n\t\tPEAMAILSIZEMB as decimal(38,18),\n\t\tPEANOTDAYS as decimal(38,18),\n\t\tPEAOUTGIROLUDATE as decimal(38,18),\n\t\tPEAOUTGIROLUSIGN as string,\n\t\tPEAPRENOTIFY as decimal(38,18),\n\t\tPEAPROBOR as decimal(38,18),\n\t\tPEAPROVMAILFREQ as decimal(38,18),\n\t\tPEAPURNOTIFY as decimal(38,18),\n\t\tPEASTOPPREMNOTE as string,\n\t\tPEASTTPRMCLM as decimal(38,18),\n\t\tPEAUSECOLFEE as string,\n\t\tPEACRMID as decimal(38,18),\n\t\tPEAEXTID as string,\n\t\tPEALEICODE as string,\n\t\tPEALETNOTIFY as decimal(38,18),\n\t\tPEAEXTID2 as string,\n\t\tPEAMAILCNDNSPLIT as string,\n\t\tPEAMAILUSESERVADRESS as string,\n\t\tPEAMASKED as string,\n\t\tPEAEXTTRANSFER2 as string,\n\t\tPEAEXTTRANSFER as string,\n\t\tPEACRUSER as decimal(38,18),\n\t\tPEALUUSER as decimal(38,18),\n\t\tPEAALTERNATEPAYER as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> ADLPpeatable\nsource(output(\n\t\tLGALGAID as string,\n\t\tLGALCAID as string,\n\t\tLGALN2 as decimal(38,18),\n\t\tLGACRCODE as string,\n\t\tLGARECEIVER as decimal(38,18),\n\t\tLGASTATUS as string,\n\t\tLGASTDATE as decimal(38,18),\n\t\tLGAENDATE as decimal(38,18),\n\t\tLGAGUACURR as string,\n\t\tLGAGUAAMT as decimal(38,18),\n\t\tLGAINTNOTE as string,\n\t\tLGAJURISDICTION as string,\n\t\tLGAOBOPEAID as decimal(38,18),\n\t\tLGACLMCAT as string,\n\t\tLGACRLGAID as string,\n\t\tLGAOBOCNAME as string,\n\t\tLGACANDATE as decimal(38,18),\n\t\tLGALCCID as string,\n\t\tLGAINTYNSW as string,\n\t\tLGACRYNSW as string,\n\t\tLGALUDATE as decimal(38,18),\n\t\tLGACRDATE as decimal(38,18),\n\t\tLGALUSIGN as string,\n\t\tLGACRSIGN as string,\n\t\tLGACRCRDATE as decimal(38,18),\n\t\tLGACRCRSIGN as string,\n\t\tLGAKNVMARK as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> ADLPlgatable\nSelectFraPPeatable, ADLPlgatable join(PEAPEAID == LGARECEIVER,\n\tjoinType:'inner',\n\tbroadcast: 'none')~> JoinPpeatablePlgatable\nSelectFraJoinerTilExpression derive(GUT_KEY = concat('P',LGALGAID),\n\t\tGUT_GUARANTEE_TYPE_DESC = case(compare(LGACRCODE,'C')==0, 'Provided Guarantee', case(compare(LGACRCODE,'R')==0,'Received Guarantee','Received Counter Guarantee')),\n\t\tGUT_GUARANTEE_TYPE_CODE = LGACRCODE,\n\t\tGUT_GUARANTEE_STATUS = case(compare(LGASTATUS,'A')==0, 'Open',case(compare(LGASTATUS,'R')==0, 'Closed', 'Closed')),\n\t\tGUT_INC_KEY = concat('P',LGALCAID),\n\t\tGUT_OPEN_IND = case(compare(LGASTATUS,'A')==0, 'Y',case(compare(LGASTATUS,'R')==0,'N','N'))) ~> Expression\nSelectFraExpression derive(INSERTED_BY = 'M_PRE_DIM_GUARANTEE_ME',\n\t\tINSERTED_DATE = fromUTC(currentTimestamp(), 'CET')) ~> Constant\nADLPpeatable select(mapColumn(\n\t\tPEAPEAID,\n\t\tPEAMDESCR\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectFraPPeatable\nJoinPpeatablePlgatable select(mapColumn(\n\t\tLGALGAID,\n\t\tLGALCAID,\n\t\tLGACRCODE,\n\t\tLGASTATUS\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectFraJoinerTilExpression\nJoinPpeatablePlgatable select(mapColumn(\n\t\tGUT_GUARANTEE_ISSUED_TO = PEAMDESCR,\n\t\tGUT_DATE_GIVEN = LGASTDATE,\n\t\tGUT_DATE_EXPIRY = LGAENDATE,\n\t\tGUT_GUARANTEE_REMARKS = LGAINTNOTE,\n\t\tGUT_DATE_CREATED = LGACRCRDATE\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectFraJoinerTilSink\nConstant, SelectFraJoinerTilSink union(byName: true)~> UnionPrepareSink\nExpression select(mapColumn(\n\t\tGUT_KEY,\n\t\tGUT_GUARANTEE_TYPE_DESC,\n\t\tGUT_GUARANTEE_TYPE_CODE,\n\t\tGUT_GUARANTEE_STATUS,\n\t\tGUT_INC_KEY,\n\t\tGUT_OPEN_IND\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectFraExpression\nUnionPrepareSink select(mapColumn(\n\t\tGUT_KEY,\n\t\tGUT_GUARANTEE_TYPE_DESC,\n\t\tGUT_GUARANTEE_TYPE_CODE,\n\t\tGUT_GUARANTEE_STATUS,\n\t\tGUT_INC_KEY,\n\t\tGUT_OPEN_IND,\n\t\tINSERTED_BY,\n\t\tLAST_UPDATED_BY = INSERTED_BY,\n\t\tDATE_INSERTED = INSERTED_DATE,\n\t\tDATE_LAST_UPDATED = INSERTED_DATE,\n\t\tGUT_GUARANTEE_ISSUED_TO,\n\t\tGUT_DATE_GIVEN,\n\t\tGUT_DATE_EXPIRY,\n\t\tGUT_GUARANTEE_REMARKS,\n\t\tGUT_DATE_CREATED\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> PrepareSink\nPrepareSink sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SinkToPreDimGuarantee"
		}
	}
}