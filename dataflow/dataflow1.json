{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Parquet3",
						"type": "DatasetReference"
					},
					"name": "emp"
				},
				{
					"dataset": {
						"referenceName": "Parquet5",
						"type": "DatasetReference"
					},
					"name": "inc"
				},
				{
					"dataset": {
						"referenceName": "Parquet6",
						"type": "DatasetReference"
					},
					"name": "syn"
				},
				{
					"dataset": {
						"referenceName": "Parquet8",
						"type": "DatasetReference"
					},
					"name": "tcross"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "PRE_DIM_CLAIM_TEAM",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Filter1"
				},
				{
					"name": "emp1"
				},
				{
					"name": "inc1"
				},
				{
					"name": "syn1"
				},
				{
					"name": "Join1"
				},
				{
					"name": "Join2"
				},
				{
					"name": "Join3"
				},
				{
					"name": "Select1"
				},
				{
					"name": "dedup"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "Select2"
				}
			],
			"script": "source(output(\n\t\tEMP_ID as decimal(38,18),\n\t\tLOGIN_NAME as string,\n\t\tFULL_NAME as string,\n\t\tEMP_TYPE_ID as decimal(38,18),\n\t\tGROUP_ID as decimal(38,18),\n\t\tDEPT_ID as decimal(38,18),\n\t\tLOC_ID as decimal(38,18),\n\t\tSYND_ID as decimal(38,18),\n\t\tDISABLED_IND as decimal(38,18),\n\t\tLOGGING_IND as decimal(38,18),\n\t\tUNDERWRITER_IND as decimal(38,18),\n\t\tCLAIMS_ADJUSTER_IND as decimal(38,18),\n\t\tREMINDER_RESP_IND as string,\n\t\tPASSWORD_DATE as timestamp,\n\t\tCREATED_BY as string,\n\t\tCREATED_WHEN as timestamp,\n\t\tUPDATED_BY as string,\n\t\tUPDATED_WHEN as timestamp,\n\t\tPERSONAL_CLAIMS_IND as decimal(38,18),\n\t\tNEW_LOGIN_NAME as string,\n\t\tE_MAIL as string,\n\t\tPROMAN_EKEY as decimal(38,18),\n\t\tJOBNAME as string,\n\t\tUNDERWRITER_ASSISTANT_IND as decimal(38,18),\n\t\tOLD_LOGIN_NAME as string,\n\t\tAUTHORIZED_PAYMENT_LEVEL_ID as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> emp\nsource(output(\n\t\tINCIDENT_ID as decimal(38,18),\n\t\tUNIQUE_ENTRY_ID as decimal(38,18),\n\t\tINCIDENT_FILE_NUMBER as decimal(38,18),\n\t\tCLAIM_TYPE_ID_MAIN_CLAIM_TYPE as decimal(38,18),\n\t\tEMPLOYEE_ID_MAIN_ADJUSTER as decimal(38,18),\n\t\tMEMBERS_REFERENCE as string,\n\t\tARCHIVE_NUMBER as decimal(38,18),\n\t\tARCHIVE_DATE as timestamp,\n\t\tOLD_ARCHIVE_NUMBER as decimal(38,18),\n\t\tOLD_ARCHIVE_DATE as timestamp,\n\t\tGEOGRAPHICAL_AREA_ID_PLACE as decimal(38,18),\n\t\tGEOGRAPHICAL_AREA_ID_VOY_FROM as decimal(38,18),\n\t\tGEOGRAPHICAL_AREA_ID_VOY_TO as decimal(38,18),\n\t\tDATE_OF_INCIDENT as timestamp,\n\t\tMONTH_OR_PERIOD_OF_INCIDENT as string,\n\t\tCASUALTY_ID as decimal(38,18),\n\t\tMAIN_CAUSE_ID as decimal(38,18),\n\t\tGEOGRAPHICAL_AREA_ID_MAIN_JUR as decimal(38,18),\n\t\tCURRENCY_ID_MAIN_CURRENCY as decimal(38,18),\n\t\tINCIDENT_TEXT as string,\n\t\tEMPLOYEE_ID_REGISTERED_BY as decimal(38,18),\n\t\tREGISTERED_DATE as timestamp,\n\t\tLAST_REVIEWED_DATE as timestamp,\n\t\tLARGE_CLAIMS_GROUP_INDICATOR as string,\n\t\tTOTAL_CURRENT_RESERVE_USD as double,\n\t\tTOTAL_CURRENT_COMP_USD as double,\n\t\tCREATED_BY as string,\n\t\tCREATED_WHEN as timestamp,\n\t\tUPDATED_BY as string,\n\t\tUPDATED_WHEN as timestamp,\n\t\tTIMESTAMP_ as decimal(38,18),\n\t\tOFFICE_ROLE_ID_REFUND as decimal(38,18),\n\t\tREFUND_PERCENT as decimal(38,18),\n\t\tREFUND_MAPPER_NUMBER as decimal(38,18),\n\t\tPHYSICAL_FILE_CREATED as decimal(38,18),\n\t\tGEOGRAPHICAL_AREA_ID_1ST_PORT as decimal(38,18),\n\t\tTIMEBAR as timestamp,\n\t\tDEALT_WITH as string,\n\t\tOM_CLAIM_TYPE as decimal(38,18),\n\t\tCOMPLEXITY_ID as double,\n\t\tNO_ICR_REMINDER_DATE as timestamp,\n\t\tEVENT_ID as double,\n\t\tEVENT_DETAIL_ID as double,\n\t\tMAIN_CLAIM_DETAIL_ID as double,\n\t\tMYGARD_CLAIM_ID as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> inc\nsource(output(\n\t\tSYND_ID as decimal(38,18),\n\t\tSYND_NAME as string,\n\t\tCREATED_BY as string,\n\t\tCREATED_WHEN as timestamp,\n\t\tUPDATED_BY as string,\n\t\tUPDATED_WHEN as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> syn\nsource(output(\n\t\tSOURCE_CODE_KEY as string,\n\t\tSOURCE_SYSTEM as string,\n\t\tTARGET_CODE as string,\n\t\tTARGET_DESCRIPTION as string,\n\t\tCODE_TYPE as string,\n\t\tCODE_TYPE_ID as double,\n\t\tCODE2 as string,\n\t\tOM_X_REF as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> tcross\ntcross filter(SOURCE_SYSTEM == 'GIC' && CODE_TYPE_ID ==792) ~> Filter1\nemp select(mapColumn(\n\t\tEMP_ID,\n\t\tSYND_ID\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> emp1\ninc select(mapColumn(\n\t\tEMPLOYEE_ID_MAIN_ADJUSTER\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> inc1\nsyn select(mapColumn(\n\t\tSYND_ID,\n\t\tSYND_NAME\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> syn1\nemp1, inc1 join(EMP_ID == EMPLOYEE_ID_MAIN_ADJUSTER,\n\tjoinType:'inner',\n\tbroadcast: 'none')~> Join1\nJoin1, syn1 join(emp1@SYND_ID == syn1@SYND_ID,\n\tjoinType:'inner',\n\tbroadcast: 'none')~> Join2\nJoin2, Filter1 join(toString(syn1@SYND_ID,'number') == SOURCE_CODE_KEY,\n\tjoinType:'left',\n\tbroadcast: 'none')~> Join3\nJoin3 select(mapColumn(\n\t\tEMP_ID,\n\t\tSYND_ID = syn1@SYND_ID,\n\t\tSYND_NAME,\n\t\tTARGET_CODE,\n\t\tTARGET_DESCRIPTION\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 aggregate(groupBy(TARGET_CODE,\n\t\tTARGET_DESCRIPTION,\n\t\tSYND_ID,\n\t\tEMP_ID),\n\tSYND_NAME = first(SYND_NAME)) ~> dedup\ndedup derive(TEM_KEY = case(isNull(TARGET_CODE), concat('C', toString(SYND_ID, 'number')), TARGET_CODE),\n\t\tPK_PRE_DIM_CLAIM_TEAM = concat('G', toString(EMP_ID, 'number')),\n\t\tTEM_DESCRIPTION = case(isNull(TARGET_DESCRIPTION), SYND_NAME, TARGET_DESCRIPTION),\n\t\tDATE_INSERTED = currentTimestamp(),\n\t\tDATE_LAST_UPDATED = currentTimestamp(),\n\t\tINSERTED_BY = 'M_PRE_DIM_CLAIM_TEAM',\n\t\tLAST_UPDATED_BY = 'M_PRE_DIM_CLAIM_TEAM') ~> DerivedColumn1\nDerivedColumn1 select(mapColumn(\n\t\tEMP_ID,\n\t\tTEM_KEY,\n\t\tPK_PRE_DIM_CLAIM_TEAM,\n\t\tTEM_DESCRIPTION,\n\t\tDATE_INSERTED,\n\t\tDATE_LAST_UPDATED,\n\t\tINSERTED_BY,\n\t\tLAST_UPDATED_BY\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select2\nSelect2 sink(input(\n\t\tPEAPEAID as decimal(38,18),\n\t\tPEACCODE as decimal(38,18),\n\t\tPEACOMP2 as decimal(38,18),\n\t\tPEASTOPUSE as string,\n\t\tPEAINVISIBLE as string,\n\t\tPEAPERSID as string,\n\t\tPEACOLID as string,\n\t\tPEAMDESCR as string,\n\t\tPEALANG2 as string,\n\t\tPEABIRTWS as decimal(38,18),\n\t\tPEASUBTYPE as decimal(38,18),\n\t\tPEABIRTNO as string,\n\t\tPEASW10 as string,\n\t\tPEAPERSRFL as decimal(38,18),\n\t\tPEASTOPCOD as decimal(38,18),\n\t\tPEARESDAT as decimal(38,18),\n\t\tPEAINCREDAY as decimal(38,18),\n\t\tPEAINGIRO as decimal(38,18),\n\t\tPEAINGIRONO as string,\n\t\tPEANOTACO as decimal(38,18),\n\t\tPEAPURTYP as decimal(38,18),\n\t\tPEANOTLAY as decimal(38,18),\n\t\tPEANOTSORT as decimal(38,18),\n\t\tPEASWINK as decimal(38,18),\n\t\tPEAOUTCREDAY as decimal(38,18),\n\t\tPEAOUTGIRO as decimal(38,18),\n\t\tPEAOUTGIRONO as string,\n\t\tPEASWRUN as decimal(38,18),\n\t\tPEACLOMET as decimal(38,18),\n\t\tPEANOPDUE as decimal(38,18),\n\t\tPEASTATYP as decimal(38,18),\n\t\tPEASTAAMT as decimal(38,18),\n\t\tPEASTTNIV as decimal(38,18),\n\t\tPEASTANIV as decimal(38,18),\n\t\tPEACLMADV as decimal(38,18),\n\t\tPEAAPROBO as decimal(38,18),\n\t\tPEAAADDBO as decimal(38,18),\n\t\tPEAACLOBO as decimal(38,18),\n\t\tPEAACLMBO as decimal(38,18),\n\t\tPEAACORBO as decimal(38,18),\n\t\tPEAMEXCDATE as decimal(38,18),\n\t\tPEAMEXCURR as string,\n\t\tPEAMEXAMT as decimal(38,18),\n\t\tPEAMEXPRO as decimal(38,18),\n\t\tPEACCLCURR as string,\n\t\tPEACCLAMT as decimal(38,18),\n\t\tPEACCINT as string,\n\t\tPEACCINTR as decimal(38,18),\n\t\tPEACALCURR as string,\n\t\tPEACALAMT as decimal(38,18),\n\t\tPEAXLCURR as string,\n\t\tPEAXLPOIN as decimal(38,18),\n\t\tPEAIYEAR as decimal(38,18),\n\t\tPEASTENSW as decimal(38,18),\n\t\tPEASTDATE as decimal(38,18),\n\t\tPEAENDATE as decimal(38,18),\n\t\tPEAMAXPER as decimal(38,18),\n\t\tPEAIEDIV as string,\n\t\tPEAIEBUSNDIV as decimal(38,18),\n\t\tPEAIE2BUSNDIV as decimal(38,18),\n\t\tPEAIE3BUSNDIV as decimal(38,18),\n\t\tPEAIESECT as string,\n\t\tPEAIEBUSNSE as decimal(38,18),\n\t\tPEAIE2BUSNSE as decimal(38,18),\n\t\tPEAIE3BUSNSE as decimal(38,18),\n\t\tPEAIEINT as string,\n\t\tPEAIEINT1 as string,\n\t\tPEAIEINT2 as string,\n\t\tPEAIEINT3 as string,\n\t\tPEAIEINT4 as string,\n\t\tPEAIEINT5 as string,\n\t\tPEAIECOND as string,\n\t\tPEAIECON1 as decimal(38,18),\n\t\tPEAIECON2 as decimal(38,18),\n\t\tPEAIECON3 as decimal(38,18),\n\t\tPEAIECON4 as decimal(38,18),\n\t\tPEAIECON5 as decimal(38,18),\n\t\tPEACRDATE as decimal(38,18),\n\t\tPEACRSIGN as string,\n\t\tPEALUDATE as decimal(38,18),\n\t\tPEALUSIGN as string,\n\t\tPEASEX as string,\n\t\tPEAVATNO as string,\n\t\tPEAORGNO as string,\n\t\tPEANOPURR as string,\n\t\tPEAACLMADV as decimal(38,18),\n\t\tPEAADDBOR as decimal(38,18),\n\t\tPEAADDMAILFREQ as decimal(38,18),\n\t\tPEACLAMAILFREQ as decimal(38,18),\n\t\tPEACLMBOR as decimal(38,18),\n\t\tPEACLMINTYNSW as string,\n\t\tPEACLMMAILFREQ as decimal(38,18),\n\t\tPEACLOBOR as decimal(38,18),\n\t\tPEACLOSMAILFREQ as decimal(38,18),\n\t\tPEACORBO as decimal(38,18),\n\t\tPEACORRMAILFREQ as decimal(38,18),\n\t\tPEADUEDAY as decimal(38,18),\n\t\tPEAFROMCOMP as decimal(38,18),\n\t\tPEAINGIROLUDATE as decimal(38,18),\n\t\tPEAINGIROLUSIGN as string,\n\t\tPEAINVNOTIFY as decimal(38,18),\n\t\tPEAKNVMARK as string,\n\t\tPEAMAILSIZEMB as decimal(38,18),\n\t\tPEANOTDAYS as decimal(38,18),\n\t\tPEAOUTGIROLUDATE as decimal(38,18),\n\t\tPEAOUTGIROLUSIGN as string,\n\t\tPEAPRENOTIFY as decimal(38,18),\n\t\tPEAPROBOR as decimal(38,18),\n\t\tPEAPROVMAILFREQ as decimal(38,18),\n\t\tPEAPURNOTIFY as decimal(38,18),\n\t\tPEASTOPPREMNOTE as string,\n\t\tPEASTTPRMCLM as decimal(38,18),\n\t\tPEAUSECOLFEE as string,\n\t\tPEACRMID as decimal(38,18),\n\t\tPEAEXTID as string,\n\t\tPEALEICODE as string,\n\t\tPEALETNOTIFY as decimal(38,18),\n\t\tPEAEXTID2 as string,\n\t\tPEAMAILCNDNSPLIT as string,\n\t\tPEAMAILUSESERVADRESS as string,\n\t\tPEAMASKED as string,\n\t\tPEAEXTTRANSFER2 as string,\n\t\tPEAEXTTRANSFER as string,\n\t\tPEACRUSER as decimal(38,18),\n\t\tPEALUUSER as decimal(38,18),\n\t\tPEAALTERNATEPAYER as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}