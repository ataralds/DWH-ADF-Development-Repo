{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "DerivedColumn1"
				}
			],
			"script": "source(output(\n\t\tfilcrstamp as string,\n\t\tfilcrdate as date\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select filcrstamp, filcrdate from dwh_stage.p_filtable where filfilid=\\'L 7000397\\'',\n\tformat: 'query') ~> source1\nsource1 derive(a = case(\r\n     greaterOrEqual(length(trim(filcrstamp)),12),\r\n     case(\r\n                greater(substring(filcrstamp,1,4),'1900')\r\n                && (greaterOrEqual(substring(filcrstamp,5,2),'01') && lesserOrEqual(substring(filcrstamp,5,2),'12'))\r\n                && (greaterOrEqual(substring(filcrstamp,7,2),'01') && lesserOrEqual(substring(filcrstamp,7,2),'31'))\r\n                && (greaterOrEqual(substring(filcrstamp,9,2),'00') && lesserOrEqual(substring(filcrstamp,9,2),'23'))\r\n                && (greaterOrEqual(substring(filcrstamp,11,2),'00') && lesserOrEqual(substring(filcrstamp,11,2),'59')) \r\n               ,toTimestamp(concat(substring(filcrstamp,1,8),' ',substring(filcrstamp,9,2),':',substring(filcrstamp,11,2)),'yyyyMMdd hh:mm')\r\n               ,toTimestamp(concat(toString(filcrdate, 'yyyyMMdd'),' 12:00'),'yyyyMMdd hh:mm')\r\n                ),\r\n    toTimestamp('01/01/1900 12:00','dd/mm/yyyy hh:mm'))) ~> DerivedColumn1"
		}
	}
}