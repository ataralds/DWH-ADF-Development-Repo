{
	"name": "dataflow2",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Parquet11",
						"type": "DatasetReference"
					},
					"name": "lcatable"
				},
				{
					"dataset": {
						"referenceName": "Parquet12",
						"type": "DatasetReference"
					},
					"name": "sigtable"
				},
				{
					"dataset": {
						"referenceName": "Parquet13",
						"type": "DatasetReference"
					},
					"name": "mapsys"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "pre_dim_claim_team_me",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "lcatable2"
				},
				{
					"name": "sigtable2"
				},
				{
					"name": "Join1"
				},
				{
					"name": "Select1"
				},
				{
					"name": "Aggregate1"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "DerivedColumn2"
				},
				{
					"name": "Lookup1"
				},
				{
					"name": "Select2"
				},
				{
					"name": "DerivedColumn3"
				}
			],
			"script": "source(output(\n\t\tLCALCAID as string,\n\t\tLCAICAID as string,\n\t\tLCACLMN3 as decimal(38,18),\n\t\tLCACLMDATE as timestamp,\n\t\tLCACYEAR as decimal(38,18),\n\t\tLCATRTMCO as decimal(38,18),\n\t\tLCAACSTAT as string,\n\t\tLCALOSSCO as string,\n\t\tLCAOUTSTM as string,\n\t\tLCAUWSIGN as string,\n\t\tLCAOFFICE as decimal(38,18),\n\t\tLCALDESCR as string,\n\t\tLCACLODATE as timestamp,\n\t\tLCACEFOCC as string,\n\t\tLCACEFOCM as string,\n\t\tLCACLMCAC as string,\n\t\tLCAECAUSECO as string,\n\t\tLCACLINTC as decimal(38,18),\n\t\tLCATCAUSECO as string,\n\t\tLCABONYNSW as string,\n\t\tLCAIMPEXP as decimal(38,18),\n\t\tLCANCAUSECO as string,\n\t\tLCANMCLEF as string,\n\t\tLCACCOD2 as string,\n\t\tLCAAREACD as string,\n\t\tLCACEFOUC as string,\n\t\tLCAONOFFS as decimal(38,18),\n\t\tLCAENINTRST as string,\n\t\tLCAENASSSHR as decimal(38,18),\n\t\tLCAMPLCURR as string,\n\t\tLCAMPLAMT as decimal(38,18),\n\t\tLCAXLMREF as string,\n\t\tLCAREPDATE as timestamp,\n\t\tLCALIMCURR as string,\n\t\tLCALIMAMT as decimal(38,18),\n\t\tLCABIGEVENT as string,\n\t\tLCALODESCR as string,\n\t\tLCAINTNOTE as string,\n\t\tLCALTDATE as timestamp,\n\t\tLCACRSIGN as string,\n\t\tLCACRDATE as timestamp,\n\t\tLCALUSIGN as string,\n\t\tLCALUDATE as timestamp,\n\t\tLCAKNVMARK as string,\n\t\tLCALABID as string,\n\t\tLCAAGAID as string,\n\t\tLCAOBNO as decimal(38,18),\n\t\tLCACROBBID as string,\n\t\tLCAWRKCLAIM as decimal(38,18),\n\t\tLCAFPAREACD as string,\n\t\tLCATOAREACD as string,\n\t\tLCAJURISDICTION as string,\n\t\tLCAFILEREF as decimal(38,18),\n\t\tLCANEXTSIGN as string,\n\t\tLCAAREADESCR as string,\n\t\tLCALRGCLMYNSW as string,\n\t\tLCAFROMAREACD as string,\n\t\tLCANEXTDATE as timestamp,\n\t\tLCAWORKPLACE as decimal(38,18),\n\t\tLCAOCCOFFDATE as timestamp,\n\t\tLCAWRKPLCCOD as decimal(38,18),\n\t\tLCAREGNDATE as timestamp,\n\t\tLCAOCCOFFYNSW as string,\n\t\tLCAREGRESS as decimal(38,18),\n\t\tLCACLMPEAID as decimal(38,18),\n\t\tLCAOCCOWNYNSW as string,\n\t\tLCAREGNSIGN as string,\n\t\tLCAMUOFFPROS as decimal(38,18),\n\t\tLCAREGCURR as string,\n\t\tLCAREGAMT as decimal(38,18),\n\t\tLCAMUOWNPROS as decimal(38,18),\n\t\tLCALIMDAYS as decimal(38,18),\n\t\tLCAREGTEXT70 as string,\n\t\tLCAEUOFFPROS as decimal(38,18),\n\t\tLCAMUOFFGRP as decimal(38,18),\n\t\tLCAEUOWNPROS as decimal(38,18),\n\t\tLCABIRTNO as string,\n\t\tDATE_INSERTED as timestamp,\n\t\tDATE_LAST_UPDATED as timestamp,\n\t\tINSERTED_BY as string,\n\t\tLAST_UPDATED_BY as string,\n\t\tMAP_DATE as timestamp,\n\t\tLCAADJSIGN as string,\n\t\tLCACLMID as string,\n\t\tLCALOADATE as timestamp,\n\t\tLCAEXTCLMID as string,\n\t\tLCATLOTYPE as double,\n\t\tLCACATEGORYTYPE as string,\n\t\tLCARECOVPOTAMT as decimal(38,18),\n\t\tLCARECOVCCVID as decimal(38,18),\n\t\tLCARECOVREMDATE as timestamp,\n\t\tLCARECOVACHCURR as string,\n\t\tLCARECOVPOTINTNOTE as string,\n\t\tLCARECOVACHYNSW as string,\n\t\tLCARECOVACHINTNOTE as string,\n\t\tLCARECOVACHDATE as timestamp,\n\t\tLCARECOVPOTCURR as string,\n\t\tLCARECOVACHSIGN as string,\n\t\tLCARECOVPOTYNSW as string,\n\t\tLCARECOVACHAMT as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> lcatable\nsource(output(\n\t\tSIGSIGN as string,\n\t\tSIGMDESCR as string,\n\t\tSIGLDESCR as string,\n\t\tSIGCPHONE as string,\n\t\tSIGCFAX as string,\n\t\tSIGCMAIL as string,\n\t\tSIGPEAID as decimal(38,18),\n\t\tSIGMAINSIGN as string,\n\t\tSIGHIERARC as string,\n\t\tSIGORGPLACE as string,\n\t\tSIGFUNC as string,\n\t\tSIGBPRTPL as string,\n\t\tSIGCOMP2 as decimal(38,18),\n\t\tSIGDEFCCODE as decimal(38,18),\n\t\tSIGDEFAGTYPE as decimal(38,18),\n\t\tSIGDEFOBRT as decimal(38,18),\n\t\tSIGOFFICE as decimal(38,18),\n\t\tSIGBUSNDIV as decimal(38,18),\n\t\tSIGBUSNSEC as decimal(38,18),\n\t\tSIGBUSNCLA as decimal(38,18),\n\t\tSIGBUSNTYP as decimal(38,18),\n\t\tSIGLANG2 as string,\n\t\tSIGIYEAR as decimal(38,18),\n\t\tSIGCURR as string,\n\t\tSIGPWDATE as decimal(38,18),\n\t\tSIGSQLSEQ as decimal(38,18),\n\t\tSIGGENSEC as decimal(38,18),\n\t\tSIGMAISEC as decimal(38,18),\n\t\tSIGPERSSECUR as string,\n\t\tSIGCREATEFUNC as string,\n\t\tSIGCLOSEFUNC as string,\n\t\tSIGCLAIMFUNC as string,\n\t\tSIGELREMITFUNC as string,\n\t\tSIGPLTRANSFUNC as string,\n\t\tSIGLOCDEFTAB as decimal(38,18),\n\t\tSIGLOCSWITCHES as string,\n\t\tSIGCREATESWITCHES as string,\n\t\tSIGPREMSWITCHES as string,\n\t\tSIGCLMDEFUPDATE as string,\n\t\tSIGCLMSWITCHES as string,\n\t\tSIGACCOACCG as decimal(38,18),\n\t\tSIGACCOSREF as string,\n\t\tSIGACCOSUBREF as string,\n\t\tSIGACCOSWITCHES as string,\n\t\tSIGPOLPRLABEL as string,\n\t\tSIGLETTERPRLABEL as string,\n\t\tSIGNOTEPRLABEL as string,\n\t\tSIGMISCPRLABEL as string,\n\t\tSIGSTOPUSE as string,\n\t\tSIGNAMEID as string,\n\t\tSIGEFILEDOMAIN as string,\n\t\tSIGAACYNSW as string,\n\t\tSIGACCYNSW as string,\n\t\tSIGEFILEPLACE as string,\n\t\tSIGEFILELIBRARY as string,\n\t\tSIGEFILEPASSWORD as string,\n\t\tSIGEFILEUSERID as string,\n\t\tSIGACLYNSW as string,\n\t\tSIGAUWYNSW as string,\n\t\tSIGUWAYNSW as string,\n\t\tSIGCLMYNSW as string,\n\t\tSIGFRYEAR as decimal(38,18),\n\t\tSIGSPECIALVERSION as string,\n\t\tSIGTOYEAR as decimal(38,18),\n\t\tSIGINTSELECTION as string,\n\t\tSIGDEBUGMACRO as string,\n\t\tSIGINTAIE as string,\n\t\tSIGDEBUGIDENTIFY as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> sigtable\nsource(output(\n\t\tSOURCE_CODE_KEY as string,\n\t\tSOURCE_SYSTEM as string,\n\t\tTARGET_CODE as string,\n\t\tTARGET_DESCRIPTION as string,\n\t\tCODE_TYPE as string,\n\t\tCODE_TYPE_ID as double,\n\t\tCODE2 as string,\n\t\tOM_X_REF as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> mapsys\nlcatable select(mapColumn(\n\t\tLCAUWSIGN\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> lcatable2\nsigtable select(mapColumn(\n\t\tSIGSIGN,\n\t\tSIGOFFICE\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sigtable2\nlcatable2, sigtable2 join(LCAUWSIGN == SIGSIGN,\n\tjoinType:'inner',\n\tbroadcast: 'both')~> Join1\nJoin1 select(mapColumn(\n\t\tSIGSIGN,\n\t\tSIGOFFICE\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nDerivedColumn3 aggregate(groupBy(SIGSIGN),\n\tSIGOFFICE = first(SIGOFFICE)) ~> Aggregate1\nAggregate1 derive(SIGOFFICE = toString(SIGSIGN),\n\t\tTEM_KEY = concat('P', toString(SIGSIGN)),\n\t\tPK_PRE_DIM_CLAIM_TEAM = concat('P', SIGSIGN),\n\t\tSOURCE_SYSTEM = 'PARIS',\n\t\tCODE_TYPE_ID = '792.0',\n\t\tDATE_INSERTED = toTimestamp(currentDate() )) ~> DerivedColumn1\nmapsys derive(CODE_TYPE_ID_STRING = toString(toInteger(CODE_TYPE_ID))) ~> DerivedColumn2\nDerivedColumn1, DerivedColumn2 lookup(SIGOFFICE == SOURCE_CODE_KEY\n\t&& DerivedColumn1@SOURCE_SYSTEM == mapsys@SOURCE_SYSTEM\n\t&& DerivedColumn1@CODE_TYPE_ID == CODE_TYPE_ID_STRING,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'none')~> Lookup1\nLookup1 select(mapColumn(\n\t\tSIGSIGN,\n\t\tPK_PRE_DIM_CLAIM_TEAM,\n\t\tTEM_KEY = TARGET_CODE,\n\t\tTEM_DESC = TARGET_DESCRIPTION,\n\t\tDATE_INSERTED\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select2\nSelect1 derive(SIGOFFICE = toString(SIGOFFICE)) ~> DerivedColumn3\nSelect2 sink(input(\n\t\tLCALCAID as string,\n\t\tLCAICAID as string,\n\t\tLCACLMN3 as decimal(38,18),\n\t\tLCACLMDATE as timestamp,\n\t\tLCACYEAR as decimal(38,18),\n\t\tLCATRTMCO as decimal(38,18),\n\t\tLCAACSTAT as string,\n\t\tLCALOSSCO as string,\n\t\tLCAOUTSTM as string,\n\t\tLCAUWSIGN as string,\n\t\tLCAOFFICE as decimal(38,18),\n\t\tLCALDESCR as string,\n\t\tLCACLODATE as timestamp,\n\t\tLCACEFOCC as string,\n\t\tLCACEFOCM as string,\n\t\tLCACLMCAC as string,\n\t\tLCAECAUSECO as string,\n\t\tLCACLINTC as decimal(38,18),\n\t\tLCATCAUSECO as string,\n\t\tLCABONYNSW as string,\n\t\tLCAIMPEXP as decimal(38,18),\n\t\tLCANCAUSECO as string,\n\t\tLCANMCLEF as string,\n\t\tLCACCOD2 as string,\n\t\tLCAAREACD as string,\n\t\tLCACEFOUC as string,\n\t\tLCAONOFFS as decimal(38,18),\n\t\tLCAENINTRST as string,\n\t\tLCAENASSSHR as decimal(38,18),\n\t\tLCAMPLCURR as string,\n\t\tLCAMPLAMT as decimal(38,18),\n\t\tLCAXLMREF as string,\n\t\tLCAREPDATE as timestamp,\n\t\tLCALIMCURR as string,\n\t\tLCALIMAMT as decimal(38,18),\n\t\tLCABIGEVENT as string,\n\t\tLCALODESCR as string,\n\t\tLCAINTNOTE as string,\n\t\tLCALTDATE as timestamp,\n\t\tLCACRSIGN as string,\n\t\tLCACRDATE as timestamp,\n\t\tLCALUSIGN as string,\n\t\tLCALUDATE as timestamp,\n\t\tLCAKNVMARK as string,\n\t\tLCALABID as string,\n\t\tLCAAGAID as string,\n\t\tLCAOBNO as decimal(38,18),\n\t\tLCACROBBID as string,\n\t\tLCAWRKCLAIM as decimal(38,18),\n\t\tLCAFPAREACD as string,\n\t\tLCATOAREACD as string,\n\t\tLCAJURISDICTION as string,\n\t\tLCAFILEREF as decimal(38,18),\n\t\tLCANEXTSIGN as string,\n\t\tLCAAREADESCR as string,\n\t\tLCALRGCLMYNSW as string,\n\t\tLCAFROMAREACD as string,\n\t\tLCANEXTDATE as timestamp,\n\t\tLCAWORKPLACE as decimal(38,18),\n\t\tLCAOCCOFFDATE as timestamp,\n\t\tLCAWRKPLCCOD as decimal(38,18),\n\t\tLCAREGNDATE as timestamp,\n\t\tLCAOCCOFFYNSW as string,\n\t\tLCAREGRESS as decimal(38,18),\n\t\tLCACLMPEAID as decimal(38,18),\n\t\tLCAOCCOWNYNSW as string,\n\t\tLCAREGNSIGN as string,\n\t\tLCAMUOFFPROS as decimal(38,18),\n\t\tLCAREGCURR as string,\n\t\tLCAREGAMT as decimal(38,18),\n\t\tLCAMUOWNPROS as decimal(38,18),\n\t\tLCALIMDAYS as decimal(38,18),\n\t\tLCAREGTEXT70 as string,\n\t\tLCAEUOFFPROS as decimal(38,18),\n\t\tLCAMUOFFGRP as decimal(38,18),\n\t\tLCAEUOWNPROS as decimal(38,18),\n\t\tLCABIRTNO as string,\n\t\tDATE_INSERTED as timestamp,\n\t\tDATE_LAST_UPDATED as timestamp,\n\t\tINSERTED_BY as string,\n\t\tLAST_UPDATED_BY as string,\n\t\tMAP_DATE as timestamp,\n\t\tLCAADJSIGN as string,\n\t\tLCACLMID as string,\n\t\tLCALOADATE as timestamp,\n\t\tLCAEXTCLMID as string,\n\t\tLCATLOTYPE as double,\n\t\tLCACATEGORYTYPE as string,\n\t\tLCARECOVPOTAMT as decimal(38,18),\n\t\tLCARECOVCCVID as decimal(38,18),\n\t\tLCARECOVREMDATE as timestamp,\n\t\tLCARECOVACHCURR as string,\n\t\tLCARECOVPOTINTNOTE as string,\n\t\tLCARECOVACHYNSW as string,\n\t\tLCARECOVACHINTNOTE as string,\n\t\tLCARECOVACHDATE as timestamp,\n\t\tLCARECOVPOTCURR as string,\n\t\tLCARECOVACHSIGN as string,\n\t\tLCARECOVPOTYNSW as string,\n\t\tLCARECOVACHAMT as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['PRE_DIM_CLAIM_TEAM_ME.PARQUET'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}