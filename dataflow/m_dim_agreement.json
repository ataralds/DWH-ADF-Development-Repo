{
	"name": "m_dim_agreement",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "pre_dim_agreement",
						"type": "DatasetReference"
					},
					"name": "PreDimAgreement"
				}
			],
			"sinks": [
				{
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Aggregate1"
				}
			],
			"script": "source(output(\n\t\tpk_key as string,\n\t\tagr_sf_client_lost_reason as string,\n\t\tagr_sf_company_name_broker as string,\n\t\tagr_def_clhandl_casualty_pri as string,\n\t\tagr_sf_company_owner as string,\n\t\tagr_uw_description as string,\n\t\tagr_dummy_ind as string,\n\t\tagr_market_area_desc as string,\n\t\tagr_agreement_type_detail_code as string,\n\t\tagr_abatement_usd as decimal(28,10),\n\t\tgic_cover_request_id as decimal(28,10),\n\t\tagr_sf_company_name_client as string,\n\t\tgic_small_craft_ind as decimal(28,10),\n\t\tagr_date_end as date,\n\t\tagr_agreement_type_detail_desc as string,\n\t\tagr_main_vessel_type_code as string,\n\t\tagr_def_clhandl_defence_pri as string,\n\t\tagr_def_clhandl_defence_sec as string,\n\t\tagr_main_vessel_type_desc as string,\n\t\tagr_uw_assist_team_desc as string,\n\t\tagr_market_area_short_desc as string,\n\t\tagr_date_established as date,\n\t\tagr_def_clhandl_environm_sec as string,\n\t\tagr_sf_market_area_desc as string,\n\t\tagr_uw_year as string,\n\t\tagr_order_code as string,\n\t\tinserted_by as string,\n\t\tagr_sf_top_group_broker_id as decimal(28,10),\n\t\tagr_sf_company_id as decimal(28,10),\n\t\tagr_est_premium_org as decimal(28,10),\n\t\tagr_def_clhndl_pi_crew_pri as string,\n\t\tlast_updated_by as string,\n\t\tagr_uw_code as string,\n\t\tagr_reference as string,\n\t\tagr_internal_note as string,\n\t\tagr_main_office_ind as string,\n\t\tagr_abatement_stat as decimal(28,10),\n\t\tdate_inserted as timestamp,\n\t\tagr_resp_uw_desc as string,\n\t\tagr_sf_market_area_short_desc as string,\n\t\tagr_def_clhndl_dry_cargo_sec as string,\n\t\tagr_club_retention_stat as decimal(28,10),\n\t\tagr_uw_assist_description as string,\n\t\tagr_market_segment_code as string,\n\t\tagr_sf_market_area_code as string,\n\t\tagr_def_clhndl_pi_crew_sec as string,\n\t\tagr_uw_assist_code as string,\n\t\tagr_sf_key as string,\n\t\tdate_last_updated as timestamp,\n\t\tagr_club_retention as decimal(28,10),\n\t\tagr_sf_top_group_broker as string,\n\t\tagr_est_total_gross_ton as decimal(28,10),\n\t\tagr_uw_assist_team_code as string,\n\t\tagr_resp_uw_code as string,\n\t\tagr_def_clhandl_casualty_sec as string,\n\t\tagr_sf_company_broker_id as decimal(28,10),\n\t\tagr_sf_top_group_client as string,\n\t\tagr_uw_year_days as decimal(28,10),\n\t\tagr_market_segment_split_code as string,\n\t\tagr_def_clhandl_liquid_ca_pri as string,\n\t\tagr_market_segm_cnt_grp_code as string,\n\t\toffice as string,\n\t\tagr_def_claim_adjuster as string,\n\t\tagr_market_segment as string,\n\t\tcharterers_trad_clm_team_ind as string,\n\t\tagr_market_segm_cnt_grp_sort as string,\n\t\tagr_est_premium_currency_code as string,\n\t\tagr_def_clhandl_environm_pri as string,\n\t\tagr_market_segm_country_group as string,\n\t\tagr_ext_adjuster_ind as string,\n\t\tagr_def_claims_handler_paris as string,\n\t\tagr_member_number as decimal(28,10),\n\t\tagr_date_start as date,\n\t\tagr_market_segment_split as string,\n\t\tagr_market_area_sort as string,\n\t\tagr_def_clhndl_dry_cargo_pri as string,\n\t\tagr_agreement_name as string,\n\t\tagr_def_clhandl_liquid_ca_sec as string,\n\t\tagr_sf_top_group_client_id as decimal(28,10),\n\t\tagr_market_area_code as string,\n\t\tagr_est_number_of_objects as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select * from dwh_prepare.pre_dim_agreement',\n\tformat: 'query') ~> PreDimAgreement\nPreDimAgreement aggregate(groupBy(pk_key),\n\teach(match(name!='pk_key'), $$ = max($$))) ~> Aggregate1\nAggregate1 sink(skipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}