{
	"name": "m_dim_incident",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "preDimIncidentPa"
				}
			],
			"sinks": [
				{
					"name": "dimIncident"
				}
			],
			"transformations": [
				{
					"name": "DeriveColumns"
				},
				{
					"name": "AlterRow1"
				}
			],
			"script": "source(output(\n\t\tpk_key_inc as string,\n\t\tinc_retention as decimal(28,10),\n\t\tinc_gic_incident_id as decimal(28,10),\n\t\tinc_mygard_claim_id as string,\n\t\tinc_date_archive as date,\n\t\tinc_deleted_ind as string,\n\t\tinc_year_of_registered as decimal(28,10),\n\t\tinc_ind_open as string,\n\t\tinc_reg_in_paris_pool_ind as string,\n\t\tinc_claim_process_desc as string,\n\t\tgrp_text as string,\n\t\tinc_team_description as string,\n\t\tinc_longitude as decimal(28,10),\n\t\tdate_last_updated as timestamp,\n\t\tinc_voyage_to as string,\n\t\tinc_ded_used_text_1 as string,\n\t\tinc_registered_by_desc as string,\n\t\tinc_ded_used_amount_2 as decimal(28,10),\n\t\tbest_value_estimate as decimal(28,10),\n\t\tinc_vessel_name as string,\n\t\tinc_yearmonth_of_registered as decimal(28,10),\n\t\tinc_reserve_created_by_desc as string,\n\t\tinc_text_restricted as string,\n\t\tinc_claim_adjuster_desc as string,\n\t\tgrp_description as string,\n\t\tinc_gard_claim_id as string,\n\t\tgrp_event_detail_description as string,\n\t\tinc_registered_date as date,\n\t\tinc_voyage_from as string,\n\t\tinc_main_claim_detail_desc as string,\n\t\tinc_main_claim_handler_desc as string,\n\t\tgrp_ind_major_incient as string,\n\t\tgrp_key as string,\n\t\tgrp_main_event_code as string,\n\t\tinc_latitude as decimal(28,10),\n\t\tinc_om_rule_code as string,\n\t\tinc_ded_used_amount_usd_1 as decimal(28,10),\n\t\tinc_reserve_created_by_code as string,\n\t\tinc_year_of_incident_calyear as decimal(28,10),\n\t\tinc_description as string,\n\t\tinc_year_of_incident as decimal(28,10),\n\t\tlast_updated_by as string,\n\t\tinc_incident_risk_group_desc as string,\n\t\tinc_me_tlo_ind as string,\n\t\tinc_complexity_desc as string,\n\t\tinc_date_of_incident as date,\n\t\tinc_geotag_reference as string,\n\t\tinc_claim_process_code as string,\n\t\tinc_casualty_cause as string,\n\t\treserve_worst_outcome as decimal(28,10),\n\t\tinc_status_desc as string,\n\t\tinc_imono as string,\n\t\tinc_text as string,\n\t\tinc_ded_used_amount_1 as decimal(28,10),\n\t\tinc_ded_used_days_1 as decimal(28,10),\n\t\tinc_me_tlo_type as string,\n\t\tdate_inserted as timestamp,\n\t\tinc_ded_used_curr_2 as string,\n\t\tinc_ded_used_amount_usd_2 as decimal(28,10),\n\t\tinc_om_rule_desc as string,\n\t\tinc_me_claim_cat_type as string,\n\t\tinc_registered_by_code as string,\n\t\tinc_text_unresticted as string,\n\t\tinc_claim_adjuster_code as string,\n\t\tinc_code as string,\n\t\tinc_immediate_cause as string,\n\t\tgrp_claim_incurred_gross_usd as decimal(28,10),\n\t\tinc_ded_used_curr_1 as string,\n\t\tinc_main_claim_detail_code as string,\n\t\tinc_ded_used_text_2 as string,\n\t\tgrp_event_deatil_code as string,\n\t\tinc_date_archive_old as date,\n\t\tinserted_by as string,\n\t\tinc_place_of_incident as string,\n\t\tinc_main_claim_type_desc as string,\n\t\tinc_yearmonth_of_incident as decimal(28,10),\n\t\tinc_date_last_reviewed as date,\n\t\tinc_members_reference as string,\n\t\tinc_payment_created_by_desc as string,\n\t\tinc_main_jurisdiction as string,\n\t\tinc_complexity_code as string,\n\t\tinc_ded_used_days_2 as decimal(28,10),\n\t\tgrp_main_event_description as string,\n\t\tinc_incident_risk_group as string,\n\t\tinc_main_claim_type_code as string,\n\t\tinc_incident_reference as string,\n\t\tgrp_code as string,\n\t\treserve_best_outcome as decimal(28,10),\n\t\tinc_file_number as string,\n\t\tgrp_id as decimal(28,10),\n\t\tinc_payment_created_by_code as string,\n\t\tinc_main_claim_handler_code as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select * from dwh_prepare.pre_dim_incident',\n\tformat: 'query',\n\twildcardPaths:['Pre_Dim/pre_dim_incident_pa.parquet']) ~> preDimIncidentPa\npreDimIncidentPa derive(top_key = 'ALL',\n\t\ttop_description = 'All Incidents',\n\t\tinc_me_tlo_ind = coalesce(inc_me_tlo_ind,'N')) ~> DeriveColumns\nDeriveColumns alterRow(upsertIf(1==1)) ~> AlterRow1\nAlterRow1 sink(skipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> dimIncident"
		}
	}
}