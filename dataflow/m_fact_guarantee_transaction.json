{
	"name": "m_fact_guarantee_transaction",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "preFactGuaranteeTrans"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimEmployee"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimTransactionType"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimClaimType"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimCoverage"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimClaimCategory"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimPartner"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimAgreementType"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimCurrency"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimSubClaim"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimTime"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimBusinessArea"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimIncident"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimRiskObject"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimCountry"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimSourceSystem"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimVesselTypeGroup"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimGuarantee"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimAgreement"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimCapital"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "dimObject"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "dimClaimHandler"
				},
				{
					"name": "dimUnderwriter"
				},
				{
					"name": "dimBroker"
				},
				{
					"name": "dimClient"
				},
				{
					"name": "timeAgreement"
				},
				{
					"name": "claimTransDate"
				},
				{
					"name": "LookupClmHandler"
				},
				{
					"name": "LookupTransactionType"
				},
				{
					"name": "LookupClmType"
				},
				{
					"name": "LookupCoverage"
				},
				{
					"name": "LookupClmCategory"
				},
				{
					"name": "LookupBroker"
				},
				{
					"name": "LookupUnderwriter"
				},
				{
					"name": "LookupAgreementType"
				},
				{
					"name": "LookupCurrency"
				},
				{
					"name": "LookupSubClaim"
				},
				{
					"name": "LookupClient"
				},
				{
					"name": "LookupClaimTransDate"
				},
				{
					"name": "LookupBusinessArea"
				},
				{
					"name": "LookupIncident"
				},
				{
					"name": "LookupRiskObject"
				},
				{
					"name": "LookupCountry"
				},
				{
					"name": "LookupSourceSystem"
				},
				{
					"name": "LookupVesselTypeGroup"
				},
				{
					"name": "LookupGuarantee"
				},
				{
					"name": "LookupAgreement"
				},
				{
					"name": "LookupCapital"
				},
				{
					"name": "LookupObject"
				},
				{
					"name": "DerivedColumn"
				}
			],
			"script": "source(output(\n\t\tpk_transaction_key as string,\n\t\tdim_claim_handler_key as string,\n\t\tguarantee_amount_org as decimal(28,10),\n\t\tdim_transaction_type_key as string,\n\t\tdim_claim_type_key as string,\n\t\tinc_status_at_trans_date as string,\n\t\tmap_date as date,\n\t\tdim_coverage_key as string,\n\t\tdim_claim_category as string,\n\t\tdim_broker as string,\n\t\tcreated_date as date,\n\t\tlast_updated_by as string,\n\t\tdim_underwriter_key as string,\n\t\tdim_agreement_type_key as string,\n\t\tdate_last_updated as timestamp,\n\t\tcreated_by as string,\n\t\tdate_inserted as timestamp,\n\t\tguarantee_amount_stat as decimal(28,10),\n\t\tdim_currency_key as string,\n\t\tdeleted_ind as string,\n\t\tguarantee_amount_usd as decimal(28,10),\n\t\tdim_sub_claim as string,\n\t\tinserted_by as string,\n\t\tdim_client_key as string,\n\t\tdim_claim_trans_date as long,\n\t\tdim_business_area_key as string,\n\t\tdim_incident_key as string,\n\t\tdim_risk_object_key as string,\n\t\tdim_country_key as string,\n\t\tdim_source_system_key as string,\n\t\tdim_vessel_type_3ltr as string,\n\t\tdim_guarantee as string,\n\t\tdim_agreement_key as string,\n\t\tdim_capital_branch as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select * from \\ndwh_prepare.pre_fact_guarantee_trans\\nwhere map_date IS NULL',\n\tformat: 'query') ~> preFactGuaranteeTrans\nsource(output(\n\t\temp_source_key as string,\n\t\temp_dimension_key as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select emp_source_key, dimension_key as emp_dimension_key from marts.dim_employee',\n\tformat: 'query') ~> dimEmployee\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select * from marts.dim_transaction_type',\n\tformat: 'query') ~> dimTransactionType\nsource(output(\n\t\tclm_key as string,\n\t\tdimension_key_claim_type as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select clm_key, dimension_key as dimension_key_claim_type from marts.dim_claim_type',\n\tformat: 'query') ~> dimClaimType\nsource(output(\n\t\tcov_key as string,\n\t\tcov_dimension_key as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select cov_key, dimension_key as cov_dimension_key from marts.dim_coverage',\n\tformat: 'query') ~> dimCoverage\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select * from dim_claim_category',\n\tformat: 'query') ~> dimClaimCategory\nsource(output(\n\t\tprt_key as string,\n\t\tprt_dimension_key as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select prt_key, dimension_key as prt_dimension_key from marts.dim_partner',\n\tformat: 'query') ~> dimPartner\nsource(output(\n\t\tagt_key as string,\n\t\tagt_dimension_key as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select \t\\nagt_key, dimension_key as agt_dimension_key from marts.dim_agreement_type',\n\tformat: 'query') ~> dimAgreementType\nsource(output(\n\t\tcur_iso_code as string,\n\t\tdim_dimension_key as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select cur_iso_code, dimension_key as dim_dimension_key from marts.dim_currency',\n\tformat: 'query') ~> dimCurrency\nsource(output(\n\t\tscl_key as string,\n\t\tscl_dimension_key as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select scl_key, dimension_key as scl_dimension_key from marts.dim_sub_claim',\n\tformat: 'query') ~> dimSubClaim\nsource(output(\n\t\tcalendar_date_key as long,\n\t\tdimension_key as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select calendar_date_key, dimension_key from marts.dim_time',\n\tformat: 'query') ~> dimTime\nsource(output(\n\t\tbus_key as string,\n\t\tdimension_key_businessArea as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select bus_key, dimension_key as dimension_key_businessArea from marts.dim_business_area',\n\tformat: 'query') ~> dimBusinessArea\nsource(output(\n\t\tinc_key as string,\n\t\tdimension_key_inc as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select inc_key, dimension_key as dimension_key_inc from marts.dim_incident',\n\tformat: 'query') ~> dimIncident\nsource(output(\n\t\trob_key as string,\n\t\tdimension_key_rob as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select rob_key, dimension_key as dimension_key_rob from marts.dim_risk_object',\n\tformat: 'query') ~> dimRiskObject\nsource(output(\n\t\tcon_iso_code as string,\n\t\tdimension_key_country as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select con_iso_code, dimension_key as dimension_key_country from marts.dim_country',\n\tformat: 'query') ~> dimCountry\nsource(output(\n\t\tsou_key as string,\n\t\tdimension_key_sourceSystem as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select sou_key, dimension_key as dimension_key_sourceSystem from marts.dim_source_system',\n\tformat: 'query') ~> dimSourceSystem\nsource(output(\n\t\tvtg_key as string,\n\t\tdimension_key_vtg as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select vtg_key, dimension_key as dimension_key_vtg from marts.dim_vessel_type_group',\n\tformat: 'query') ~> dimVesselTypeGroup\nsource(output(\n\t\tgut_key as string,\n\t\tdimension_key_guarantee as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select gut_key, dimension_key as dimension_key_guarantee from marts.dim_guarantee',\n\tformat: 'query') ~> dimGuarantee\nsource(output(\n\t\tagr_key as string,\n\t\tdimension_key_agreement as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select \t\\nagr_key, dimension_key as dimension_key_agreement from marts.dim_agreement',\n\tformat: 'query') ~> dimAgreement\nsource(output(\n\t\tcpt_key as string,\n\t\tdimension_key_capital as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select cpt_key, dimension_key as dimension_key_capital from marts.dim_capital',\n\tformat: 'query') ~> dimCapital\nsource(output(\n\t\tobj_key as string,\n\t\tdimension_key_object as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select obj_key, dimension_key as dimension_key_object from \\nmarts.dim_object',\n\tformat: 'query') ~> dimObject\ndimEmployee select(mapColumn(\n\t\tsource_key_clmHandler = emp_source_key,\n\t\tdimension_key_clmHandler = emp_dimension_key\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> dimClaimHandler\ndimEmployee select(mapColumn(\n\t\t{source_key underwriter} = emp_source_key,\n\t\tdimension_key_underwriter = emp_dimension_key\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> dimUnderwriter\ndimPartner select(mapColumn(\n\t\tkey_broker = prt_key,\n\t\tdimension_key_broker = prt_dimension_key\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> dimBroker\ndimPartner select(mapColumn(\n\t\tkey_client = prt_key,\n\t\tdimension_key_client = prt_dimension_key\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> dimClient\ndimTime select(mapColumn(\n\t\tcalendar_date_key,\n\t\tdimension_key_timeAgreement = dimension_key\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> timeAgreement\ndimTime select(mapColumn(\n\t\tcalendar_date_key_clmTransDate = calendar_date_key,\n\t\tdimension_key_clmTransDate = dimension_key\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> claimTransDate\nDerivedColumn, dimClaimHandler lookup(dim_claim_handler_key == source_key_clmHandler,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupClmHandler\nLookupClmHandler, dimTransactionType lookup(dim_transaction_type_key == ERROR_FUNCTION(''),\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupTransactionType\nLookupTransactionType, dimClaimType lookup(dim_claim_type_key == clm_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupClmType\nLookupClmType, dimCoverage lookup(dim_coverage_key == cov_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupCoverage\nLookupCoverage, dimClaimCategory lookup(preFactGuaranteeTrans@dim_claim_category == ERROR_FUNCTION(''),\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupClmCategory\nLookupClmCategory, dimBroker lookup(dim_broker == key_broker,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupBroker\nLookupBroker, dimUnderwriter lookup(dim_underwriter_key == {source_key underwriter},\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupUnderwriter\nLookupUnderwriter, dimAgreementType lookup(dim_agreement_type_key == agt_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupAgreementType\nLookupAgreementType, dimCurrency lookup(dim_currency_key == cur_iso_code,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupCurrency\nLookupCurrency, dimSubClaim lookup(dim_sub_claim == scl_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupSubClaim\nLookupSubClaim, dimClient lookup(dim_client_key == key_client,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupClient\nLookupClient, claimTransDate lookup(dim_claim_trans_date == calendar_date_key_clmTransDate,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupClaimTransDate\nLookupClaimTransDate, dimBusinessArea lookup(dim_business_area_key == bus_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupBusinessArea\nLookupBusinessArea, dimIncident lookup(dim_incident_key == inc_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupIncident\nLookupIncident, dimRiskObject lookup(dim_risk_object_key == rob_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupRiskObject\nLookupRiskObject, dimCountry lookup(dim_country_key == con_iso_code,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupCountry\nLookupCountry, dimSourceSystem lookup(dim_source_system_key == sou_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupSourceSystem\nLookupSourceSystem, dimVesselTypeGroup lookup(dim_vessel_type_3ltr == vtg_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupVesselTypeGroup\nLookupVesselTypeGroup, dimGuarantee lookup(dim_guarantee == gut_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupGuarantee\nLookupGuarantee, dimAgreement lookup(dim_agreement_key == agr_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupAgreement\nLookupAgreement, dimCapital lookup(dim_capital_branch == cpt_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupCapital\nLookupCapital, dimObject lookup(ERROR_FUNCTION('') == obj_key,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LookupObject\npreFactGuaranteeTrans derive(dim_claim_category = coalesce(dim_claim_category,'N/A')) ~> DerivedColumn"
		}
	}
}