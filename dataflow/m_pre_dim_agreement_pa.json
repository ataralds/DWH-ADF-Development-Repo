{
	"name": "m_pre_dim_agreement_pa",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "Pagatable"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "Pagztable"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "Ppebtable"
				},
				{
					"dataset": {
						"referenceName": "Other",
						"type": "DatasetReference"
					},
					"name": "tcrossreference"
				},
				{
					"dataset": {
						"referenceName": "Oltp05",
						"type": "DatasetReference"
					},
					"name": "SrcSfCompany"
				},
				{
					"dataset": {
						"referenceName": "Oltp05",
						"type": "DatasetReference"
					},
					"name": "DimTime"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "pebtableselect"
				},
				{
					"name": "pebtablemax"
				},
				{
					"name": "MaxPebver"
				},
				{
					"name": "pebisolan",
					"description": "Get last pebisolan pr pabpeaid"
				},
				{
					"name": "agatable"
				},
				{
					"name": "agztable"
				},
				{
					"name": "AgaAgz"
				},
				{
					"name": "AgaPeb"
				},
				{
					"name": "AgaCol"
				},
				{
					"name": "pebtable",
					"description": "Get last pebisolan pr pebpeaid"
				},
				{
					"name": "ParisMarketArea",
					"description": "source_system=PARIS and code_type_id=460"
				},
				{
					"name": "XrefMarketArea",
					"description": "code_type_id=460"
				},
				{
					"name": "ParisEmployee",
					"description": "source_system=PARIS and code_type_id=329"
				},
				{
					"name": "XrefEmpDefClmHandler",
					"description": "Default Claim Handler - Employee - 329"
				},
				{
					"name": "ParisVesslType",
					"description": "source_system=PARIS and code_type_id=45"
				},
				{
					"name": "XrefVesselType",
					"description": "code_type_id=45"
				},
				{
					"name": "ParisMarketSegment",
					"description": "source_system=PARIS and code_type_id=806"
				},
				{
					"name": "XrefMarketSegment",
					"description": "code_type_id=806"
				},
				{
					"name": "XrefEmpDefClmAdjuster",
					"description": "Default Claim Adjuster - Employee - 329"
				},
				{
					"name": "XrefEmpUW",
					"description": "Underwriter - Employee - 329"
				},
				{
					"name": "XrefEmpUwResp",
					"description": "Responsible Underwriter - Employee - 329"
				},
				{
					"name": "XrefEmpUwAss",
					"description": "Underwriter Assistant - Employee - 329"
				},
				{
					"name": "ParisAgreementTypeDetail",
					"description": "Source_system=PARIS and code_type_id=813"
				},
				{
					"name": "XrefAgreementTypeDet",
					"description": "Agreement Type Detail - 813"
				},
				{
					"name": "ParisOffice",
					"description": "Source_system=PARIS and code_type_id=112"
				},
				{
					"name": "XrefOffice",
					"description": "code_tye_id=112"
				},
				{
					"name": "ParisUwAssistTeam",
					"description": "Source_system=PARIS and code_type_id=809"
				},
				{
					"name": "XrefUwAssistTeam",
					"description": "Code_type_id=809"
				},
				{
					"name": "AgaBroker",
					"description": "Include broker_id"
				},
				{
					"name": "ParisCompany",
					"description": "Source_system='PARIS'"
				},
				{
					"name": "SfCompanyBroker",
					"description": "Broker name and id"
				},
				{
					"name": "SfCompanyClient"
				},
				{
					"name": "JoinOffice",
					"description": "Include Office_name"
				},
				{
					"name": "JoinAgreementTypeDet",
					"description": "Include Agreement Type Details"
				},
				{
					"name": "JoinUwAssistTeam",
					"description": "Include Underwriting Assistant Team"
				},
				{
					"name": "JoinUwAssist",
					"description": "Include Underwriter Assistant"
				},
				{
					"name": "JoinUw",
					"description": "Include Underwriter"
				},
				{
					"name": "JoinUwResp",
					"description": "Include Responsible Underwriter"
				},
				{
					"name": "JoinDefClmAdj",
					"description": "Include Default Claim Adjuster"
				},
				{
					"name": "JoinSfClient"
				},
				{
					"name": "JoinSfBroker"
				},
				{
					"name": "JoinMarketArea"
				},
				{
					"name": "JoinMarketSegment"
				},
				{
					"name": "JoinVesselType"
				}
			],
			"script": "source(output(\n\t\tagaadjsign as string,\n\t\tagaadmcode as string,\n\t\tagaagaid as string,\n\t\tagaagname as string,\n\t\tagaagno as decimal(38,18),\n\t\tagaagnorf as decimal(38,18),\n\t\tagaagtype as decimal(38,18),\n\t\tagaalgid as string,\n\t\tagaareacd as string,\n\t\tagaassetno as decimal(38,18),\n\t\tagaassetsubno as decimal(38,18),\n\t\tagaausign as string,\n\t\tagaautoconpol as string,\n\t\tagaavttrkeep as string,\n\t\tagaavttrnote as string,\n\t\tagaavttrpeaid as decimal(38,18),\n\t\tagaavttrpros as decimal(38,18),\n\t\tagaavttrstatus as string,\n\t\tagaavttrynsw as string,\n\t\tagabusnbranch as decimal(38,18),\n\t\tagabusncla as decimal(38,18),\n\t\tagabusndiv as decimal(38,18),\n\t\tagabusnregion as decimal(38,18),\n\t\tagabusnsec as decimal(38,18),\n\t\tagacantxt as string,\n\t\tagacashbefcovdate as timestamp,\n\t\tagacashbeforecover as string,\n\t\tagaccpid as string,\n\t\tagachartradeteam as string,\n\t\tagaclasstype as string,\n\t\tagaclmsign as string,\n\t\tagaclmuat as string,\n\t\tagaclosedate as timestamp,\n\t\tagaclosesign as string,\n\t\tagacloseynsw as string,\n\t\tagacomfacnote as string,\n\t\tagacomfacpeaid as decimal(38,18),\n\t\tagacomfacynsw as string,\n\t\tagacomp2 as decimal(38,18),\n\t\tagacompdisckeep as string,\n\t\tagacompdiscnote as string,\n\t\tagacompdiscpeaid as decimal(38,18),\n\t\tagacompdiscpros as decimal(38,18),\n\t\tagacompdiscynsw as string,\n\t\tagacomtarnote as string,\n\t\tagacomtarpeaid as decimal(38,18),\n\t\tagacomtarstknote as string,\n\t\tagacomtarstkpeaid as decimal(38,18),\n\t\tagacomtarstkynsw as string,\n\t\tagacomtarynsw as string,\n\t\tagaconcern as decimal(38,18),\n\t\tagaconnectsw as string,\n\t\tagaconsrnote as string,\n\t\tagaconsrynsw as string,\n\t\tagacontinsagaid as string,\n\t\tagacontinsagno as decimal(38,18),\n\t\tagacontinsynsw as string,\n\t\tagacrdate as timestamp,\n\t\tagacrsign as string,\n\t\tagacumul as string,\n\t\tagadatcan as timestamp,\n\t\tagadatest as timestamp,\n\t\tagadatora as timestamp,\n\t\tagadatore as timestamp,\n\t\tagadatpca as timestamp,\n\t\tagadecltyp as string,\n\t\tagadwbs as string,\n\t\tagaeldocynsw as string,\n\t\tagaelinvynsw as string,\n\t\tagaendate as timestamp,\n\t\tagaenhour as decimal(38,18),\n\t\tagaentrytype as string,\n\t\tagaeosign as string,\n\t\tagafileref as decimal(38,18),\n\t\tagafixprnote as string,\n\t\tagafixprpeaid as decimal(38,18),\n\t\tagafixprynsw as string,\n\t\tagafromcomp as decimal(38,18),\n\t\tagagday as decimal(38,18),\n\t\tagagen1keep as string,\n\t\tagagen1note as string,\n\t\tagagen1peaid as decimal(38,18),\n\t\tagagen1prov as decimal(38,18),\n\t\tagagen1ynsw as string,\n\t\tagagen2keep as string,\n\t\tagagen2note as string,\n\t\tagagen2peaid as decimal(38,18),\n\t\tagagen2prov as decimal(38,18),\n\t\tagagen2ynsw as string,\n\t\tagagen3keep as string,\n\t\tagagen3note as string,\n\t\tagagen3peaid as decimal(38,18),\n\t\tagagen3prov as decimal(38,18),\n\t\tagagen3ynsw as string,\n\t\tagagident as string,\n\t\tagagmonth as decimal(38,18),\n\t\tagagtype as string,\n\t\tagahealthdate as timestamp,\n\t\tagahealthynsw as string,\n\t\tagaincprovkeep as string,\n\t\tagaincprovnote as string,\n\t\tagaincprovpeaid as decimal(38,18),\n\t\tagaincprovpros as decimal(38,18),\n\t\tagaincprovynsw as string,\n\t\tagaincrebkeep as string,\n\t\tagaincrebnote as string,\n\t\tagaincrebpeaid as decimal(38,18),\n\t\tagaincrebpros as decimal(38,18),\n\t\tagaincrebynsw as string,\n\t\tagaindustrytxt as string,\n\t\tagainstti as string,\n\t\tagaintnote as string,\n\t\tagaisic as string,\n\t\tagaiyear as decimal(38,18),\n\t\tagaknvmark as string,\n\t\tagaktocred as decimal(38,18),\n\t\tagaktocust as decimal(38,18),\n\t\tagaktodeb as decimal(38,18),\n\t\tagaliabendate as timestamp,\n\t\tagalocpolissued as string,\n\t\tagalongname as string,\n\t\tagalostcode as string,\n\t\tagalosttxt35 as string,\n\t\tagaludate as timestamp,\n\t\tagalusign as string,\n\t\tagamaiper as decimal(38,18),\n\t\tagamgrpnote as string,\n\t\tagamgrpynsw as string,\n\t\tagamincurr as string,\n\t\tagaminpre as decimal(38,18),\n\t\taganoterm as decimal(38,18),\n\t\tagansalecom as decimal(38,18),\n\t\taganscomynsw as string,\n\t\taganumpers as decimal(38,18),\n\t\tagaoffice as decimal(38,18),\n\t\tagaoiltyp as decimal(38,18),\n\t\tagaopencover as string,\n\t\tagaordercode as string,\n\t\tagaordertxt35 as string,\n\t\tagaorgcrdate as timestamp,\n\t\tagaorgins as decimal(38,18),\n\t\tagaoxno as decimal(38,18),\n\t\tagaoxrefid as string,\n\t\tagaoyrno as decimal(38,18),\n\t\tagaoyrnote as string,\n\t\tagaoyrto as decimal(38,18),\n\t\tagapeoid as string,\n\t\tagapictype as string,\n\t\tagapwcode as decimal(38,18),\n\t\tagapwfrdate as timestamp,\n\t\tagaratcod as string,\n\t\tagaratemodel as decimal(38,18),\n\t\tagarefcod as string,\n\t\tagareftxt as string,\n\t\tagaremove as decimal(38,18),\n\t\tagarenbatchid as decimal(38,18),\n\t\tagarencod as decimal(38,18),\n\t\tagarentxt as string,\n\t\tagasalesdiv as decimal(38,18),\n\t\tagasetfreq as decimal(38,18),\n\t\tagasettldetprt as string,\n\t\tagashut as string,\n\t\tagasitid as string,\n\t\tagaskipinstadynsw as string,\n\t\tagasource as decimal(38,18),\n\t\tagastat1 as string,\n\t\tagastat2 as string,\n\t\tagastateareacd as string,\n\t\tagastdate as timestamp,\n\t\tagasthour as decimal(38,18),\n\t\tagaswo as string,\n\t\tagatocomp as decimal(38,18),\n\t\tagatrackit as string,\n\t\tagatrackit1 as string,\n\t\tagatrackit2 as string,\n\t\tagatrackit3 as string,\n\t\tagatreatas as string,\n\t\tagaturnover as decimal(38,18),\n\t\tagatzone as string,\n\t\tagauat as string,\n\t\tagaufafpynsw as string,\n\t\tagausage as string,\n\t\tagausecod as string,\n\t\tagauwsign as string,\n\t\tagawbs as string,\n\t\tagawbscust as string,\n\t\tagawntnocperiod as decimal(38,18),\n\t\tagawnttext35 as string,\n\t\tagawntynsw as string,\n\t\tagaxmednote as string,\n\t\tagaxmedpeaid as decimal(38,18),\n\t\tagaxmedynsw as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> Pagatable\nsource(output(\n\t\tagzaccadrpeaid as decimal(38,18),\n\t\tagzactnodate as timestamp,\n\t\tagzactnoofemp as decimal(38,18),\n\t\tagzagzid as string,\n\t\tagzamtcod as string,\n\t\tagzbusntyp as decimal(38,18),\n\t\tagzcedent as decimal(38,18),\n\t\tagzcefoty as string,\n\t\tagzclmadrpeaid as decimal(38,18),\n\t\tagzclmlead as decimal(38,18),\n\t\tagzcooroccynsw as string,\n\t\tagzcshind as decimal(38,18),\n\t\tagzcurrgrosepi as decimal(38,18),\n\t\tagzcurrosgrosepi as decimal(38,18),\n\t\tagzdefcurr as string,\n\t\tagzdefexchrate as decimal(38,18),\n\t\tagzdefinstcalctype as decimal(38,18),\n\t\tagzdefinstpertype as decimal(38,18),\n\t\tagzdefintrst as string,\n\t\tagzdefwarrsw as string,\n\t\tagzepicurr as string,\n\t\tagzextadjynsw as string,\n\t\tagzfagntno as decimal(38,18),\n\t\tagzgtepi as decimal(38,18),\n\t\tagzgvalue as decimal(38,18),\n\t\tagzinstadynz as string,\n\t\tagzleadownline as string,\n\t\tagzndisc as decimal(38,18),\n\t\tagznoofemp as decimal(38,18),\n\t\tagznoofobjepi as decimal(38,18),\n\t\tagzoforder as decimal(38,18),\n\t\tagzordtxt35 as string,\n\t\tagzosgrosepi as decimal(38,18),\n\t\tagzosnetepi as decimal(38,18),\n\t\tagzosnpml as decimal(38,18),\n\t\tagzospml as decimal(38,18),\n\t\tagzourlin as decimal(38,18),\n\t\tagzratind as decimal(38,18),\n\t\tagztogrosepi as decimal(38,18),\n\t\tagztonetepi as decimal(38,18),\n\t\tagztonpml as decimal(38,18),\n\t\tagztotind as decimal(38,18),\n\t\tagztotpml as decimal(38,18),\n\t\tagzuwradrpeaid as decimal(38,18),\n\t\tagzvescod as string,\n\t\tagzwarrenty as decimal(38,18),\n\t\tagzwroforder as decimal(38,18),\n\t\tagzwrshare as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> Pagztable\nsource(output(\n\t\tpebbrdate as timestamp,\n\t\tpebcivilstatus as decimal(38,18),\n\t\tpebconbusncla as decimal(38,18),\n\t\tpebconbusndiv as decimal(38,18),\n\t\tpebconbusnsec as decimal(38,18),\n\t\tpebconcomp2 as decimal(38,18),\n\t\tpebconoffice as decimal(38,18),\n\t\tpebdistrict as string,\n\t\tpebdunco as decimal(38,18),\n\t\tpebemlcurr as string,\n\t\tpebemlmdescr as string,\n\t\tpebetcbroker as string,\n\t\tpebfortsector as decimal(38,18),\n\t\tpebforttrade as string,\n\t\tpebgeneml as decimal(38,18),\n\t\tpebgroup as decimal(38,18),\n\t\tpebhourprice as decimal(38,18),\n\t\tpebinstadynz as string,\n\t\tpebisolan as string,\n\t\tpebkycapprdate as timestamp,\n\t\tpebkycapproved as string,\n\t\tpebkyccompany as decimal(38,18),\n\t\tpebkyccompdescr as string,\n\t\tpebkycid as string,\n\t\tpebludate as timestamp,\n\t\tpeblusign as string,\n\t\tpebmacheml as decimal(38,18),\n\t\tpebmansanctdescr as string,\n\t\tpebmansanction as string,\n\t\tpebmdescr as string,\n\t\tpebmvaynsw as string,\n\t\tpebnmisic as string,\n\t\tpebnmnyk as string,\n\t\tpeboffsanctdescr as string,\n\t\tpeboffsanction as string,\n\t\tpebonrisk as string,\n\t\tpebonriskdate as timestamp,\n\t\tpebpaylevel as decimal(38,18),\n\t\tpebpeaid as decimal(38,18),\n\t\tpebpebid as string,\n\t\tpebpeoid as string,\n\t\tpebpeoopeaid as decimal(38,18),\n\t\tpebpersacc as decimal(38,18),\n\t\tpebpever as decimal(38,18),\n\t\tpebpibregdate as timestamp,\n\t\tpebpibregsign as string,\n\t\tpebpidcname as string,\n\t\tpebpidid as decimal(38,18),\n\t\tpebpricecurr as string,\n\t\tpebqadate as timestamp,\n\t\tpebqasign as string,\n\t\tpebqastatus as string,\n\t\tpebratcod as string,\n\t\tpebratcomp as decimal(38,18),\n\t\tpebratedate as timestamp,\n\t\tpebratludate as timestamp,\n\t\tpebratsign as string,\n\t\tpebreason as string,\n\t\tpebressign as string,\n\t\tpebsitid as string,\n\t\tpebsupporter as string,\n\t\tpebtaxno as string,\n\t\tpebtypelevel as decimal(38,18),\n\t\tpebusstate as string,\n\t\tpebvaldate as timestamp,\n\t\tpebverstat as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> Ppebtable\nsource(output(\n\t\tsource_code_key as string,\n\t\tsource_system as string,\n\t\ttarget_code as string,\n\t\ttarget_description as string,\n\t\tcode_type_id as double,\n\t\tcode2 as string,\n\t\tom_x_ref as string,\n\t\tcode_type as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> tcrossreference\nsource(output(\n\t\taccount_resp_me as string,\n\t\taccount_resp_pi as string,\n\t\taccount_status as string,\n\t\tclient_lost_reason as string,\n\t\tcompany_email as string,\n\t\tcompany_id as double,\n\t\tcompany_name as string,\n\t\tcompany_owner_full_name as string,\n\t\tcompany_owner_id as string,\n\t\tcountry as string,\n\t\tcuo_full_name as string,\n\t\tcuo_user_id as string,\n\t\tdate_inserted as timestamp,\n\t\tdate_updated as timestamp,\n\t\tgard_contact_id as string,\n\t\tmarket_area_code as string,\n\t\tmarket_area_description as string,\n\t\tmarket_area_id as string,\n\t\tparent_company_id as double,\n\t\tparent_company_name as string,\n\t\tparis_gic_id as double,\n\t\tprimary_contact_email as string,\n\t\tprimary_contact_name as string,\n\t\tsf_last_updated_date as timestamp,\n\t\tsource_system as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\trowUrlColumn: 'sf_company',\n\tformat: 'parquet') ~> SrcSfCompany\nsource(output(\n\t\taccounting_month_end_date as timestamp,\n\t\taccounting_month_id as double,\n\t\taccounting_month_key as decimal(38,18),\n\t\taccounting_month_of_quarter as double,\n\t\taccounting_month_of_year as double,\n\t\taccounting_month_start_date as timestamp,\n\t\taccounting_month_time_span as double,\n\t\taccounting_qtr_end_date as timestamp,\n\t\taccounting_qtr_of_year as double,\n\t\taccounting_qtr_start_date as timestamp,\n\t\taccounting_qtr_time_span as double,\n\t\taccounting_quarter_id as double,\n\t\taccounting_quarter_key as decimal(38,18),\n\t\taccounting_year_end_date as timestamp,\n\t\taccounting_year_id as double,\n\t\taccounting_year_key as decimal(38,18),\n\t\taccounting_year_number as double,\n\t\taccounting_year_start_date as timestamp,\n\t\taccounting_year_time_span as double,\n\t\tall_years as string,\n\t\tcalendar_date_id as double,\n\t\tcalendar_date_key as timestamp,\n\t\tday as timestamp,\n\t\tday_name as string,\n\t\tday_of_accounting_month as double,\n\t\tday_of_accounting_quarter as double,\n\t\tday_of_accounting_year as double,\n\t\tday_of_policy_month as double,\n\t\tday_of_policy_quarter as double,\n\t\tday_of_policy_year as double,\n\t\tday_of_underwriting_month as double,\n\t\tday_of_underwriting_quarter as double,\n\t\tday_of_underwriting_year as double,\n\t\tdimension_key as double,\n\t\tpolicy_month_end_date as timestamp,\n\t\tpolicy_month_id as double,\n\t\tpolicy_month_key as decimal(38,18),\n\t\tpolicy_month_name as string,\n\t\tpolicy_month_of_quarter as double,\n\t\tpolicy_month_of_year as double,\n\t\tpolicy_month_start_date as timestamp,\n\t\tpolicy_month_time_span as double,\n\t\tpolicy_qtr_end_date as timestamp,\n\t\tpolicy_qtr_of_year as double,\n\t\tpolicy_qtr_start_date as timestamp,\n\t\tpolicy_qtr_time_span as double,\n\t\tpolicy_quarter_id as double,\n\t\tpolicy_quarter_key as decimal(38,18),\n\t\tpolicy_year_end_date as timestamp,\n\t\tpolicy_year_id as double,\n\t\tpolicy_year_key as decimal(38,18),\n\t\tpolicy_year_number as double,\n\t\tpolicy_year_start_date as timestamp,\n\t\tpolicy_year_time_span as double,\n\t\ttop_id as double,\n\t\ttop_key as decimal(38,18),\n\t\tunderwriting_month_end_date as timestamp,\n\t\tunderwriting_month_id as double,\n\t\tunderwriting_month_key as decimal(38,18),\n\t\tunderwriting_month_of_quarter as double,\n\t\tunderwriting_month_of_year as double,\n\t\tunderwriting_month_start_date as timestamp,\n\t\tunderwriting_month_time_span as double,\n\t\tunderwriting_qtr_end_date as timestamp,\n\t\tunderwriting_qtr_of_year as double,\n\t\tunderwriting_qtr_start_date as timestamp,\n\t\tunderwriting_qtr_time_span as double,\n\t\tunderwriting_quarter_id as double,\n\t\tunderwriting_quarter_key as decimal(38,18),\n\t\tunderwriting_year_end_date as timestamp,\n\t\tunderwriting_year_id as double,\n\t\tunderwriting_year_key as decimal(38,18),\n\t\tunderwriting_year_number as double,\n\t\tunderwriting_year_start_date as timestamp,\n\t\tunderwriting_year_time_span as double\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> DimTime\nPpebtable select(mapColumn(\n\t\tpebpeaid,\n\t\tpebpever,\n\t\tpebisolan\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> pebtableselect\nPpebtable select(mapColumn(\n\t\tpebpeaid,\n\t\tpebpever\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> pebtablemax\npebtablemax aggregate(groupBy(pebpeaid),\n\tpebpever = max(pebpever)) ~> MaxPebver\npebtableselect, MaxPebver join(pebtableselect@pebpeaid == MaxPebver@pebpeaid\n\t&& pebtableselect@pebpever == MaxPebver@pebpever,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> pebisolan\nPagatable select(mapColumn(\n\t\tagaagaid,\n\t\tagaiyear,\n\t\tagaagno,\n\t\tagaagname,\n\t\tagaoffice,\n\t\tagabusndiv,\n\t\tagabusnsec,\n\t\tagabusncla,\n\t\tagasource,\n\t\tagaorgins,\n\t\tagastdate,\n\t\tagaendate,\n\t\tagauwsign,\n\t\tagaausign,\n\t\tagaclmsign,\n\t\tagaisic,\n\t\tagaadjsign,\n\t\tagaeosign,\n\t\tagasitid,\n\t\tagaadjsign = agaordercode,\n\t\tagaintnote,\n\t\tagadatest,\n\t\tagauat\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> agatable\nPagztable select(mapColumn(\n\t\tagzagzid,\n\t\tagzcefoty,\n\t\tagzcurrgrosepi,\n\t\tagzepicurr,\n\t\tagzextadjynsw,\n\t\tagzfagntno,\n\t\tagzgtepi,\n\t\tagznoofobjepi\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> agztable\nagatable, agztable join(agaagaid == agzagzid,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> AgaAgz\nAgaAgz, pebtable join(agasource == pebpeaid,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> AgaPeb\nAgaPeb select(mapColumn(\n\t\tagaagaid,\n\t\tagaiyear,\n\t\tagaagno,\n\t\tagaagname,\n\t\tagaoffice,\n\t\tagabusndiv,\n\t\tagabusnsec,\n\t\tagabusncla,\n\t\tagasource,\n\t\tagaorgins,\n\t\tagastdate,\n\t\tagaendate,\n\t\tagauwsign,\n\t\tagaausign,\n\t\tagaclmsign,\n\t\tagaisic,\n\t\tagaadjsign,\n\t\tagaeosign,\n\t\tagasitid,\n\t\tagaintnote,\n\t\tagadatest,\n\t\tagauat,\n\t\tagzagzid,\n\t\tagzcefoty,\n\t\tagzcurrgrosepi,\n\t\tagzepicurr,\n\t\tagzextadjynsw,\n\t\tagzfagntno,\n\t\tagzgtepi,\n\t\tagznoofobjepi,\n\t\tpebisolan\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AgaCol\npebisolan select(mapColumn(\n\t\tpebpeaid = pebtableselect@pebpeaid,\n\t\tpebpever = pebtableselect@pebpever,\n\t\tpebisolan\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> pebtable\ntcrossreference filter(SOURCE_SYSTEM=='PARIS' && CODE_TYPE_ID==460) ~> ParisMarketArea\nParisMarketArea select(mapColumn(\n\t\tsource_code_key_market_area = SOURCE_CODE_KEY,\n\t\ttarget_code_market_area = TARGET_CODE,\n\t\ttarget_desc_market_area = TARGET_DESCRIPTION\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> XrefMarketArea\ntcrossreference filter(source_system=='PARIS' && code_type_id==329) ~> ParisEmployee\nParisEmployee select(mapColumn(\n\t\tsource_code_key_def_clm_h = SOURCE_CODE_KEY,\n\t\ttarge_code_def_clm_h = TARGET_CODE\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> XrefEmpDefClmHandler\ntcrossreference filter(source_system=='PARIS' && code_type_id==45) ~> ParisVesslType\nParisVesslType select(mapColumn(\n\t\tsource_code_key_vessel_type = source_code_key,\n\t\ttarget_code_vessel_type = target_code,\n\t\ttarget_desc_vessel_type = target_description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> XrefVesselType\ntcrossreference filter(source_system=='PARIS' && code_type_id==806) ~> ParisMarketSegment\nParisMarketSegment select(mapColumn(\n\t\tsource_code_key_MarkSegemnt = source_code_key,\n\t\ttarget_code_MarkSegemnt = target_code,\n\t\ttarget_desc_MarkSegemnt = target_description,\n\t\tcode2_MarkSegemnt = code2\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> XrefMarketSegment\nParisEmployee select(mapColumn(\n\t\tsource_code_defclmadj = source_code_key,\n\t\ttarge_code_defclmadj = target_code\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> XrefEmpDefClmAdjuster\nParisEmployee select(mapColumn(\n\t\tsource_code_key_UW = source_code_key,\n\t\ttarget_code_UW = target_code,\n\t\ttarge_desc_UW = target_description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> XrefEmpUW\nParisEmployee select(mapColumn(\n\t\tsource_code_key_UwResp = source_code_key,\n\t\ttarge_code_UwResp = target_code,\n\t\ttarget_desc_UwResp = target_description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> XrefEmpUwResp\nParisEmployee select(mapColumn(\n\t\tsource_system_uwass = source_code_key,\n\t\ttarget_code_uwass = target_code,\n\t\ttarget_desc_uwass = target_description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> XrefEmpUwAss\ntcrossreference filter(source_system=='PARIS' && code_type_id==813) ~> ParisAgreementTypeDetail\nParisAgreementTypeDetail select(mapColumn(\n\t\tsource_code_key_agt_det = source_code_key,\n\t\ttarge_code_agt_det = target_code,\n\t\ttarget_desc_agt_det = target_description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> XrefAgreementTypeDet\ntcrossreference filter(source_system=='PARIS' && code_type_id==112) ~> ParisOffice\nParisOffice select(mapColumn(\n\t\tsource_code_key_office = source_code_key,\n\t\ttarget_desc_office = target_description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> XrefOffice\ntcrossreference filter(source_system=='PARIS' && code_type_id==809) ~> ParisUwAssistTeam\nParisUwAssistTeam select(mapColumn(\n\t\tsource_code_key_uwassteam = source_code_key,\n\t\ttarget_code_uwassteam = target_code,\n\t\ttarget_desc_uwassteam = target_description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> XrefUwAssistTeam\nAgaCol derive(broker_id = case(agabusncla==8, iifNull(agzfagntno,case(agasource==agaorgins, toDecimal(null()), agasource)), case(agasource==agaorgins, toDecimal(null()), agasource)),\n\t\tagaoffice_string = toString(agaoffice,'##########0')) ~> AgaBroker\nSrcSfCompany filter(source_system=='Paris') ~> ParisCompany\nParisCompany select(mapColumn(\n\t\tcompany_id_broker = company_id,\n\t\tcompany_name_broker = company_name,\n\t\tparis_gic_id_broker = paris_gic_id\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SfCompanyBroker\nParisCompany select(mapColumn(\n\t\taccount_resp_me,\n\t\taccount_resp_pi,\n\t\taccount_status,\n\t\tclient_lost_reason,\n\t\tcompany_email,\n\t\tcompany_id_client = company_id,\n\t\tcompany_name_client = company_name,\n\t\tcompany_owner_full_name,\n\t\tgard_contact_id,\n\t\tmarket_area_code,\n\t\tmarket_area_description,\n\t\tparis_gic_id_client = paris_gic_id,\n\t\tprimary_contact_email,\n\t\tprimary_contact_name,\n\t\tsource_system,\n\t\tsf_company\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SfCompanyClient\nAgaBroker, XrefOffice join(toString(agaoffice,'########0') == source_code_key_office,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinOffice\nJoinOffice, XrefAgreementTypeDet join(toString(agabusncla,'#########0') == source_code_key_agt_det,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinAgreementTypeDet\nJoinAgreementTypeDet, XrefUwAssistTeam join(agauat == source_code_key_uwassteam,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinUwAssistTeam\nJoinUwAssistTeam, XrefEmpUwAss join(agaausign == source_system_uwass,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinUwAssist\nJoinUwAssist, XrefEmpUW join(agauwsign == source_code_key_UW,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinUw\nJoinUw, XrefEmpUwResp join(agaeosign == source_code_key_UwResp,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinUwResp\nJoinUwResp, XrefEmpDefClmAdjuster join(agaadjsign == source_code_defclmadj,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinDefClmAdj\nJoinVesselType, SfCompanyClient join(agaorgins == paris_gic_id_client,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinSfClient\nJoinSfClient, SfCompanyBroker join(agasource == paris_gic_id_broker,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinSfBroker\nJoinDefClmAdj, XrefMarketArea join(agasitid == source_code_key_market_area,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinMarketArea\nJoinMarketArea, XrefMarketSegment join(pebisolan == source_code_key_MarkSegemnt,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinMarketSegment\nJoinMarketSegment, XrefVesselType join(agzcefoty == source_code_key_vessel_type,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinVesselType"
		}
	}
}