{
	"name": "m_pre_dim_claim_rule",
	"properties": {
		"folder": {
			"name": "dwh_prepare/paris"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "TCross",
						"type": "DatasetReference"
					},
					"name": "Tcrossreference"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "pre_dim_claim_rule",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Filter1"
				},
				{
					"name": "Constant"
				},
				{
					"name": "Select1"
				}
			],
			"script": "source(output(\n\t\tSOURCE_CODE_KEY as string,\n\t\tSOURCE_SYSTEM as string,\n\t\tTARGET_CODE as string,\n\t\tTARGET_DESCRIPTION as string,\n\t\tCODE_TYPE as string,\n\t\tCODE_TYPE_ID as double,\n\t\tCODE2 as string,\n\t\tOM_X_REF as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> Tcrossreference\nTcrossreference filter(SOURCE_SYSTEM == 'GIC' && CODE_TYPE_ID == 167) ~> Filter1\nFilter1 derive(mapping_name = 'M_PRE_DIM_CLAIM_RULE',\n\t\tmapping_name_2 = 'M_PRE_DIM_CLAIM_RULE',\n\t\tload_date = currentTimestamp(),\n\t\tload_date_2 = currentTimestamp(),\n\t\tig_rule_code = 'N/A',\n\t\tig_rule_desc = 'Not Applicable',\n\t\tom_claim_type_id = toInteger(SOURCE_CODE_KEY)) ~> Constant\nConstant select(mapColumn(\n\t\trul_description = TARGET_DESCRIPTION,\n\t\trul_key = TARGET_CODE,\n\t\tinserted_by = mapping_name_2,\n\t\tdate_last_updated = load_date_2,\n\t\trul_ig_rule_code = ig_rule_code,\n\t\trul_ig_rule_desc = ig_rule_desc,\n\t\tom_claim_type_id,\n\t\tdate_inserted = load_date,\n\t\tlast_updated_by = mapping_name\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['pre_dim_claim_rule'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}