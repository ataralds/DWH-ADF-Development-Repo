{
	"name": "m_pre_dim_claim_rule",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "dwh_stage_t_crossreference",
						"type": "DatasetReference"
					},
					"name": "Tcrossreference"
				}
			],
			"sinks": [
				{
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Filter1"
				},
				{
					"name": "Constant"
				},
				{
					"name": "Select1"
				}
			],
			"script": "source(output(\n\t\tcode_type_id as long,\n\t\tcode2 as string,\n\t\ttarget_description as string,\n\t\tsource_system as string,\n\t\tom_x_ref as string,\n\t\ttarget_code as string,\n\t\tcode_type as string,\n\t\tsource_code_key as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> Tcrossreference\nTcrossreference filter(source_system == 'GIC' && code_type_id == 167) ~> Filter1\nFilter1 derive(mapping_name = 'M_PRE_DIM_CLAIM_RULE',\n\t\tmapping_name_2 = 'M_PRE_DIM_CLAIM_RULE',\n\t\tload_date = currentTimestamp(),\n\t\tload_date_2 = currentTimestamp(),\n\t\tig_rule_code = 'N/A',\n\t\tig_rule_desc = 'Not Applicable',\n\t\tom_claim_type_id = toInteger(source_code_key)) ~> Constant\nConstant select(mapColumn(\n\t\trul_description = target_description,\n\t\trul_key = target_code,\n\t\tinserted_by = mapping_name_2,\n\t\tdate_last_updated = load_date_2,\n\t\trul_ig_rule_code = ig_rule_code,\n\t\trul_ig_rule_desc = ig_rule_desc,\n\t\tom_claim_type_id,\n\t\tdate_inserted = load_date,\n\t\tlast_updated_by = mapping_name\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 sink(skipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}