{
	"name": "m_pre_dim_object",
	"properties": {
		"folder": {
			"name": "dwh_prepare/pre_dim"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "lloydsvesselhistory"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "lloydscompany"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "tcrossreference"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "pre_dim_object",
						"type": "DatasetReference"
					},
					"name": "preDimObject"
				}
			],
			"transformations": [
				{
					"name": "companyMgr"
				},
				{
					"name": "benificialOwner"
				},
				{
					"name": "commercialOperator"
				},
				{
					"name": "regOwner"
				},
				{
					"name": "manager"
				},
				{
					"name": "companyGBowner"
				},
				{
					"name": "companyOperator"
				},
				{
					"name": "companyRegOwner"
				},
				{
					"name": "companyGBOwnerCnty"
				},
				{
					"name": "companyMgrCnty"
				},
				{
					"name": "companyOperatorCnty"
				},
				{
					"name": "tmptable"
				},
				{
					"name": "derivedColumns"
				},
				{
					"name": "marketDesc"
				},
				{
					"name": "countryDesc"
				},
				{
					"name": "objectTypeDesc"
				},
				{
					"name": "flagDesc"
				},
				{
					"name": "beneficialOwnerCountry"
				},
				{
					"name": "managerCountry"
				},
				{
					"name": "operatorCountry"
				},
				{
					"name": "commercialOwnerCntry"
				},
				{
					"name": "companyComOwnerCnty"
				},
				{
					"name": "xrefMarketArea"
				},
				{
					"name": "xrefCountry"
				},
				{
					"name": "xrefObjType"
				},
				{
					"name": "xrefFlagDesc"
				},
				{
					"name": "selectOutputColumn"
				},
				{
					"name": "expression"
				},
				{
					"name": "alterRow"
				},
				{
					"name": "flag"
				},
				{
					"name": "objectType"
				},
				{
					"name": "country"
				},
				{
					"name": "market"
				}
			],
			"script": "source(output(\n\t\tvessel_key_column as long,\n\t\tteu_capacity as integer,\n\t\tcommon_gear_type_code as string,\n\t\tinsert_date as date,\n\t\tno_centre_tanks as integer,\n\t\tore_capacity_tonnes as integer,\n\t\tgas_capacity as integer,\n\t\tengine_position as string,\n\t\tco2_ind as string,\n\t\tinmarsat_number as string,\n\t\tport_of_registry as string,\n\t\tclass1_start_date as date,\n\t\ttank_coated_ind as string,\n\t\tinspections_last_12_months as short,\n\t\tstroke as decimal(28,10),\n\t\trefrigerated_ind as string,\n\t\tearliest_engine_dob as date,\n\t\tmaterial_of_build as string,\n\t\tbroken_place as string,\n\t\tpump_description as string,\n\t\ttechnical_manager_id as integer,\n\t\tstroke_type as integer,\n\t\tflag as string,\n\t\tconstruction_end as date,\n\t\tthird_party_operator_id as integer,\n\t\tteu_hold_capacity as integer,\n\t\toriginal_sched_cons_end as date,\n\t\tpump_capacity_cubic as integer,\n\t\tbeneficial_owner_id as integer,\n\t\ttotal_casualties_last_5_years as short,\n\t\tcar_capacity as integer,\n\t\ttotal_boilers as short,\n\t\tbow_load_discharge as string,\n\t\tpanama_nrt as integer,\n\t\ttotal_casualties as short,\n\t\tfuel_consumption as string,\n\t\tlt_tonnes as integer,\n\t\tpressurised_ind as string,\n\t\tloa as decimal(28,10),\n\t\tno_reefer_plugs as integer,\n\t\tclass2_ice_class as string,\n\t\tlane_length as integer,\n\t\ttotal_casualties_last_12_month as short,\n\t\tclass2_last_survey_date as date,\n\t\tgross as integer,\n\t\tclass1_vessel_id as string,\n\t\tvessel_id as integer,\n\t\tliquid_capacity_barrels as integer,\n\t\tflag_official_number as string,\n\t\tcasualty_date as date,\n\t\timo_rating_2 as string,\n\t\tteu_14t_capacity as integer,\n\t\tdepth as decimal(28,10),\n\t\tpropulsion_type as string,\n\t\tregistered_owner_start_date as date,\n\t\ttrailer_capacity as integer,\n\t\tconvention_69_ind as string,\n\t\tclass2_ice_class_text as string,\n\t\tmaximum_rpm as integer,\n\t\tconstruction_start as date,\n\t\tpiracy as short,\n\t\tno_lines as integer,\n\t\tbreadth_extreme as decimal(28,10),\n\t\tsemi_pressurised_ind as string,\n\t\tstatus as string,\n\t\ttotal_generator_power as decimal(28,10),\n\t\tmaximum_hold_length as integer,\n\t\trefrigerated_capacity as integer,\n\t\tno_wing_tanks as integer,\n\t\tspeed as decimal(28,10),\n\t\tcurrent_flag as string,\n\t\tmaximum_hold_depth as integer,\n\t\tdisplacement as integer,\n\t\tballast_capacity as integer,\n\t\tstainles_steel_tanks as string,\n\t\tincident_result_in_los_of_life as short,\n\t\timo as integer,\n\t\tmachinery_damage as short,\n\t\ttotal_holds as short,\n\t\tmaximum_hold_width as integer,\n\t\tno_crew as integer,\n\t\tlane_width as integer,\n\t\tyear_of_build as short,\n\t\tinspection_precis as string,\n\t\tfuel_type2 as string,\n\t\tspm_ind as string,\n\t\tfuel_type as string,\n\t\ttotal_dead as integer,\n\t\trecord_last_updated as date,\n\t\tvessel_type as string,\n\t\tstrengthened_for_heavy_cargo as string,\n\t\tcurrent_name as string,\n\t\tconversion_text as string,\n\t\tclass1_ice_class as string,\n\t\tnumber_deficienci_last_3_year as short,\n\t\ttotal_generators as integer,\n\t\tvessel_name as string,\n\t\tlbp as decimal(28,10),\n\t\tupdate_date as date,\n\t\tclass2_suspension_ind as string,\n\t\tgrain_capacity as integer,\n\t\ttpcmi as decimal(28,10),\n\t\tgas_min_pressure as integer,\n\t\tcls_ind as string,\n\t\tpi_club_id as string,\n\t\thull_damage as short,\n\t\tmaximum_hatch_width as integer,\n\t\tengine_type as string,\n\t\torder_cancelled as date,\n\t\tthird_party_operator_start_dat as date,\n\t\ttechnical_manager_start_date as date,\n\t\tcommon_gear_type as string,\n\t\tclass1_notation as string,\n\t\tcurrent_flag_start_date as date,\n\t\tslop_tank_capacity as integer,\n\t\tprevious_name as string,\n\t\tore_cargo_ind as string,\n\t\thull_type as string,\n\t\tno_cylinders as short,\n\t\tsuez_nrt as integer,\n\t\tloss_date as date,\n\t\thp as integer,\n\t\tclass2_provisional_ind as string,\n\t\tnet as integer,\n\t\tvessel_type_code as string,\n\t\tcollisions as short,\n\t\tclass2_notation as string,\n\t\tbuilt_place as string,\n\t\tregistered_owner_id as integer,\n\t\ttotal_injured as integer,\n\t\tcow_ind as string,\n\t\tengine_designer as string,\n\t\ttotal_pumps as integer,\n\t\tno_berths as integer,\n\t\tbore as decimal(28,10),\n\t\tno_passengers as integer,\n\t\ttotal_dc_current_generators as integer,\n\t\tclass2_provisional_end_date as date,\n\t\tengine_action as string,\n\t\ttotal_hatches as short,\n\t\tconversion_date as date,\n\t\tmanifold_to_bow as decimal(28,10),\n\t\tengine_builder as string,\n\t\tclass2_rating as string,\n\t\tvalid_to as date,\n\t\tclass2_start_date as date,\n\t\tmaximum_individual_gear_swl as integer,\n\t\tcommon_boiler_type as string,\n\t\tcount_gbowner_chg_5y as long,\n\t\tsbt_ind as string,\n\t\tlng_containment_ind as string,\n\t\tnominal_owner_start_date as date,\n\t\tfuel_capacity as integer,\n\t\tclass1_provisional_ind as string,\n\t\tcommercial_op_start_date as date,\n\t\tbollard_pull as integer,\n\t\tclass1_suspension_ind as string,\n\t\tclass1_provisional_end_date as date,\n\t\tteu_operation_capacity as integer,\n\t\tbale_capacity as integer,\n\t\tformula_dwt as integer,\n\t\tclass1_last_survey_date as date,\n\t\theli_deck_ind as string,\n\t\tlatest_inspection_date as date,\n\t\tengine_built_town as string,\n\t\tinspections_last_3_years as short,\n\t\tdead_date as date,\n\t\tpi_start_date as date,\n\t\tlrg as decimal(28,10),\n\t\tdetention_ind as string,\n\t\tstart_date as date,\n\t\tno_stainless_steel_tanks as integer,\n\t\tclass2 as string,\n\t\tvessel_builder as string,\n\t\tcommercial_operator_id as integer,\n\t\tbroken_end_date as date,\n\t\tclass1_ice_class_text as string,\n\t\tnominal_owner_id as integer,\n\t\tcylinder_arrangement as string,\n\t\tprevious_flag as string,\n\t\tbeneficial_owner_start_date as date,\n\t\tlatest_incident_precis as string,\n\t\tno_decks as short,\n\t\tno_watertight_compartments as short,\n\t\tflash_point_60_ind as string,\n\t\tmmsi as string,\n\t\tdetentions_last_12_months as short,\n\t\tcommon_propeller_type as string,\n\t\tanswer_back as string,\n\t\tdwt as integer,\n\t\tname_changes_previous_3_years as short,\n\t\tclass2_code as string,\n\t\trefrigerated_teu_capacity as integer,\n\t\tgas_max_pressure as integer,\n\t\tcoil_ind as string,\n\t\tdeck_tank_capacity as integer,\n\t\timo_rating_3 as string,\n\t\tclass1_esp_ind as string,\n\t\tpropulsion_text as string,\n\t\tno_grades as integer,\n\t\ttotal_ac_current_generators as integer,\n\t\thatch_type as string,\n\t\tclass1 as string,\n\t\tmaximum_hatch_length as integer,\n\t\tpi_changes_previous_3_years as short,\n\t\ttank_text as string,\n\t\tmanifold_type as string,\n\t\tclass_changes_previous_3_years as short,\n\t\tstern_load_discharge as string,\n\t\tethylene_ind as string,\n\t\tparallel_body_length as decimal(28,10),\n\t\tbreadth_moulded as decimal(28,10),\n\t\tclass1_code as string,\n\t\tclass1_rating as string,\n\t\tflag_changes_previous_3_years as short,\n\t\ttotal_missing as integer,\n\t\tpower_kw as integer,\n\t\tcount_designation as long,\n\t\timo_rating_1 as string,\n\t\tbreaker_company as string,\n\t\tcoil_text as string,\n\t\ttotal_tanks as integer,\n\t\tbow_chain_stoppers as string,\n\t\tno_engines as short,\n\t\tteu_deck_capacity as integer,\n\t\tktm as decimal(28,10),\n\t\torder_value as decimal(28,10),\n\t\tyard_number as string,\n\t\tclass2_vessel_id as string,\n\t\tnumber_owner as long,\n\t\tspeed_type as string,\n\t\tpump_capacity_tonnes as integer,\n\t\tcount_eng_builder as long,\n\t\ttotal_lifting_gear as integer,\n\t\tammonia_ind as string,\n\t\tthruster_ind as string,\n\t\tliquid_capacity as integer,\n\t\ttank_coated_text as string,\n\t\tgearless_ind as string,\n\t\tincidents_result_in_pollution as short,\n\t\tcommon_propeller_type_code as string,\n\t\ttotal_inspections as short,\n\t\tlaunch_date as date,\n\t\tscheduled_construction_end as date,\n\t\tcall_sign as string,\n\t\tpi_club as string,\n\t\tigs_ind as string,\n\t\tfreeboard as decimal(28,10),\n\t\tdraft as decimal(28,10),\n\t\tclass2_esp_ind as string,\n\t\tvalid_from as date,\n\t\tbulbous_bow_ind as string,\n\t\ttotal_propellers as short,\n\t\tinmarsat_code as string,\n\t\tno_bulkheads as short,\n\t\tdetentions_last_3_years as short,\n\t\ttotal_detentions as short,\n\t\theat_exchangers as string,\n\t\torder_date as date,\n\t\thull_design as string,\n\t\tvcm_ind as string,\n\t\tno_cabins as integer,\n\t\tengine_designation as string,\n\t\tmanifold_distance as decimal(28,10)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select * from dwh_stage.lloyds_vessel_history',\n\tformat: 'query',\n\twildcardPaths:['Other/lloyds_vessel_history.parquet']) ~> lloydsvesselhistory\nsource(output(\n\t\tcompany_id as integer,\n\t\ttelephone as string,\n\t\tpost_code_2 as string,\n\t\temail as string,\n\t\twebsite as string,\n\t\tiso3 as string,\n\t\tcompany_status as string,\n\t\tcountry as string,\n\t\ttown_city as string,\n\t\tcompany_first_year_qualifier as string,\n\t\toffice_status as string,\n\t\tcompany_first_year as short,\n\t\tpost_code_1 as string,\n\t\taudit_created as date,\n\t\taddress_line_3 as string,\n\t\taddress_line_2 as string,\n\t\tcompany_name as string,\n\t\taddress_line_1 as string,\n\t\taddress_line_4 as string,\n\t\taudit_updated as date,\n\t\tfax as string,\n\t\tcounty_state as string,\n\t\tsnapshot_date as date,\n\t\trecord_last_updated as date\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select * from dwh_stage.lloyds_company',\n\tformat: 'query') ~> lloydscompany\nsource(output(\n\t\tcode_type_id as long,\n\t\tcode2 as string,\n\t\ttarget_description as string,\n\t\tsource_system as string,\n\t\tom_x_ref as string,\n\t\ttarget_code as string,\n\t\tcode_type as string,\n\t\tsource_code_key as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select * from dwh_stage.t_crossreference',\n\tformat: 'query') ~> tcrossreference\nlloydsvesselhistory, manager lookup(technical_manager_id == company_id_mgr,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyMgr\nlloydscompany select(mapColumn(\n\t\tcompany_id_benOwner = company_id,\n\t\tobj_gbo_owner = company_name\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> benificialOwner\nlloydscompany select(mapColumn(\n\t\tcompany_id_comOper = company_id,\n\t\tobj_operator = company_name\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> commercialOperator\nlloydscompany select(mapColumn(\n\t\tcompany_id_regOwner = company_id,\n\t\tobj_reg_owner = company_name\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> regOwner\nlloydscompany select(mapColumn(\n\t\tcompany_id_mgr = company_id,\n\t\tobj_manager = company_name\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> manager\ncompanyMgr, benificialOwner lookup(beneficial_owner_id == company_id_benOwner,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyGBowner\ncompanyGBowner, commercialOperator lookup(commercial_operator_id == company_id_comOper,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyOperator\ncompanyOperator, regOwner lookup(registered_owner_id == company_id_regOwner,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyRegOwner\ncompanyRegOwner, beneficialOwnerCountry lookup(beneficial_owner_id == company_id_benOwnCtry,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyGBOwnerCnty\ncompanyGBOwnerCnty, managerCountry lookup(technical_manager_id == company_id_mgrCntry,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyMgrCnty\ncompanyMgrCnty, operatorCountry lookup(commercial_operator_id == company_id_operCntry,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyOperatorCnty\ncompanyComOwnerCnty select(mapColumn(\n\t\tkey = vessel_key_column,\n\t\tobj_object_name = vessel_name,\n\t\tobj_sourceid = vessel_id,\n\t\tobj_imo_number = imo,\n\t\tobj_built_year = year_of_build,\n\t\tobj_flag_iso3_code = flag,\n\t\tobj_status_code = status,\n\t\tobj_object_type_code = vessel_type_code,\n\t\tobj_object_type = vessel_type,\n\t\tobj_dwt = dwt,\n\t\tobj_fdwt = formula_dwt,\n\t\tobj_gt = gross,\n\t\tobj_breadth_extreme = breadth_extreme,\n\t\tobj_breadth_moulded = breadth_moulded,\n\t\tobj_depth = depth,\n\t\tobj_hull_type_code = hull_type,\n\t\tobj_material_build_code = material_of_build,\n\t\tobj_num_of_decks = no_decks,\n\t\tobj_num_of_total_tanks = total_tanks,\n\t\tobj_propulsion_code = propulsion_type,\n\t\tobj_speed = speed,\n\t\tobj_num_of_crew = no_crew,\n\t\tobj_num_of_passengers = no_passengers,\n\t\tobj_cap_bale = bale_capacity,\n\t\tobj_cap_car = car_capacity,\n\t\tobj_cap_trailer = trailer_capacity,\n\t\tobj_cap_gas = gas_capacity,\n\t\tobj_cap_grain = grain_capacity,\n\t\tobj_cap_liquid = liquid_capacity,\n\t\tobj_cap_teu = teu_capacity,\n\t\tobj_num_of_hatches = total_hatches,\n\t\tobj_num_of_holds = total_holds,\n\t\tobj_num_of_propellers = total_propellers,\n\t\tobj_propeller_type_code = common_propeller_type_code,\n\t\tobj_ship_builder = vessel_builder,\n\t\tobj_date_construction_start = construction_start,\n\t\tobj_date_launch = launch_date,\n\t\tobj_date_construction_end = construction_end,\n\t\tobj_date_dead = dead_date,\n\t\tobj_class1_code = class1_code,\n\t\tobj_class1 = class1,\n\t\tobj_iceclass = class1_ice_class,\n\t\tobj_iceclasstext = class1_ice_class_text,\n\t\tobj_class2_code = class2_code,\n\t\tobj_class2 = class2,\n\t\tobj_pandi_club_code = pi_club_id,\n\t\tobj_pandi_club = pi_club,\n\t\tobj_total_kw = power_kw,\n\t\tobj_rpm = maximum_rpm,\n\t\tobj_hp = hp,\n\t\tobj_engine_builder = engine_builder,\n\t\tobj_engine_designation = engine_designation,\n\t\tobj_engine_designer = engine_designer,\n\t\tobj_num_of_cylinders = no_cylinders,\n\t\tobj_cylinder_arrangement = cylinder_arrangement,\n\t\tobj_engine_type = engine_type,\n\t\tobj_stroke_type = stroke_type,\n\t\tobj_fuel_type = fuel_type,\n\t\tobj_fuel_type_2 = fuel_type2,\n\t\tobj_manager_code = technical_manager_id,\n\t\tobj_date_valid_from = valid_from,\n\t\tobj_date_valid_to = valid_to,\n\t\tobj_manager,\n\t\tobj_gbo_owner,\n\t\tobj_operator,\n\t\tobj_reg_owner,\n\t\tobj_gb_owner_country_desc,\n\t\tobj_gbo_owner_country,\n\t\tobj_manager_country_desc,\n\t\tobj_manager_country_code,\n\t\tobj_operator_country_desc,\n\t\tobj_operator_country_code,\n\t\tobj_reg_owner_country_desc,\n\t\tobj_reg_owner_country\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> tmptable\ntmptable derive(obj_gard_objectid = '',\n\t\tobj_flag_iso3 = '',\n\t\tobj_status = '',\n\t\tobj_class3 = '',\n\t\tobj_class3_code = '',\n\t\tobj_m3 = '',\n\t\tobj_ship_builder_country = '',\n\t\tobj_service_speed = '',\n\t\tobj_length_overall = '',\n\t\tobj_hullid = '',\n\t\tobj_date_built = '',\n\t\tobj_propeller_type_desc = '',\n\t\tobj_hull_type = '',\n\t\tobj_propulsion = '',\n\t\tobj_material_build = '',\n\t\ticeclass = '',\n\t\ticeclasstext = '',\n\t\tlast_updated_by = 'pre_dim_object',\n\t\tlloyds_vessel_id = obj_sourceid) ~> derivedColumns\nderivedColumns, xrefMarketArea lookup(obj_gbo_owner_country == source_code_key_xref_market,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> marketDesc\nmarketDesc, xrefCountry lookup(obj_gbo_owner_country == source_code_key_xref_country,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> countryDesc\ncountryDesc, xrefObjType lookup(obj_object_type_code == source_code_key_xref_OTDesc,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> objectTypeDesc\nobjectTypeDesc, xrefFlagDesc lookup(obj_flag_iso3_code == source_code_key_flagDesc,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> flagDesc\nlloydscompany select(mapColumn(\n\t\tcompany_id_benOwnCtry = company_id,\n\t\tobj_gb_owner_country_desc = country,\n\t\tobj_gbo_owner_country = iso3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> beneficialOwnerCountry\nlloydscompany select(mapColumn(\n\t\tcompany_id_mgrCntry = company_id,\n\t\tobj_manager_country_desc = country,\n\t\tobj_manager_country_code = iso3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> managerCountry\nlloydscompany select(mapColumn(\n\t\tcompany_id_operCntry = company_id,\n\t\tobj_operator_country_desc = country,\n\t\tobj_operator_country_code = iso3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> operatorCountry\nlloydscompany select(mapColumn(\n\t\tcompany_id_cowcnty = company_id,\n\t\tobj_reg_owner_country_desc = country,\n\t\tobj_reg_owner_country = iso3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> commercialOwnerCntry\ncompanyOperatorCnty, commercialOwnerCntry lookup(commercial_operator_id == company_id_cowcnty,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyComOwnerCnty\nmarket select(mapColumn(\n\t\tsource_code_key_xref_market = source_code_key,\n\t\tsource_system_xref_market = source_system,\n\t\tobj_market_area_code = target_code,\n\t\tobj_market_area_desc = target_description,\n\t\tcode_type_id_xref_market = code_type_id\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> xrefMarketArea\ncountry select(mapColumn(\n\t\tcode_type_id_xref_country = code_type_id,\n\t\tsource_system_xref_country = source_system,\n\t\tsource_code_key_xref_country = source_code_key,\n\t\tobj_market_area_country_code = target_code,\n\t\tobj_market_area_country_desc = target_description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> xrefCountry\nobjectType select(mapColumn(\n\t\tsource_code_key_xref_OTDesc = source_code_key,\n\t\tsource_system_xref_OTDesc = source_system,\n\t\ttarget_description_object_type = target_description,\n\t\tcode_type_id_xref_OTDesc = code_type_id\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> xrefObjType\nflag select(mapColumn(\n\t\tsource_code_key_flagDesc = source_code_key,\n\t\tsource_system_flagDesc = source_system,\n\t\ttarget_code_flag = target_code,\n\t\ttarget_description_flag = target_description,\n\t\tcode_type_id_flagDesc = code_type_id\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> xrefFlagDesc\nexpression select(mapColumn(\n\t\tobj_key = key,\n\t\tobj_sourceid,\n\t\tobj_object_name,\n\t\tobj_imo_number,\n\t\tobj_built_year,\n\t\tobj_flag_iso3_code,\n\t\tobj_status_code,\n\t\tobj_object_type_code,\n\t\tobj_object_type,\n\t\tobj_dwt,\n\t\tobj_fdwt,\n\t\tobj_gt,\n\t\tobj_breadth_extreme,\n\t\tobj_breadth_moulded,\n\t\tobj_depth,\n\t\tobj_hull_type_code,\n\t\tobj_num_of_decks,\n\t\tobj_num_of_total_tanks,\n\t\tobj_propulsion_code,\n\t\tobj_speed,\n\t\tobj_num_of_crew,\n\t\tobj_num_of_passengers,\n\t\tobj_cap_bale,\n\t\tobj_cap_car,\n\t\tobj_cap_trailer,\n\t\tobj_cap_gas,\n\t\tobj_cap_grain,\n\t\tobj_cap_liquid,\n\t\tobj_cap_teu,\n\t\tobj_num_of_hatches,\n\t\tobj_num_of_holds,\n\t\tobj_num_of_propellers,\n\t\tobj_propeller_type_code,\n\t\tobj_ship_builder,\n\t\tobj_date_construction_start,\n\t\tobj_date_launch,\n\t\tobj_date_construction_end,\n\t\tobj_date_dead,\n\t\tobj_class1_code,\n\t\tobj_class1,\n\t\tobj_iceclass,\n\t\tobj_iceclasstext,\n\t\tobj_class2_code,\n\t\tobj_class2,\n\t\tobj_pandi_club_code,\n\t\tobj_pandi_club,\n\t\tobj_total_kw,\n\t\tobj_rpm,\n\t\tobj_hp,\n\t\tobj_engine_builder,\n\t\tobj_engine_designation,\n\t\tobj_engine_designer,\n\t\tobj_num_of_cylinders,\n\t\tobj_cylinder_arrangement,\n\t\tobj_engine_type,\n\t\tobj_stroke_type,\n\t\tobj_fuel_type_code = obj_fuel_type,\n\t\tobj_manager_code,\n\t\tobj_date_valid_from,\n\t\tobj_date_valid_to,\n\t\tobj_manager,\n\t\tobj_gbo_owner,\n\t\tobj_operator,\n\t\tobj_reg_owner,\n\t\tobj_gb_owner_country_desc,\n\t\tobj_gbo_owner_country,\n\t\tobj_manager_country_desc,\n\t\tobj_manager_country_code,\n\t\tobj_operator_country_desc,\n\t\tobj_operator_country_code,\n\t\tobj_reg_owner_country_desc,\n\t\tobj_reg_owner_country,\n\t\tobj_gard_objectid,\n\t\tobj_flag_iso3,\n\t\tobj_status,\n\t\tobj_class3,\n\t\tobj_class3_code,\n\t\tobj_m3,\n\t\tobj_ship_builder_country,\n\t\tobj_service_speed,\n\t\tobj_length_overall,\n\t\tobj_hullid,\n\t\tobj_date_built,\n\t\tobj_propeller_type_desc,\n\t\tobj_hull_type,\n\t\tobj_propulsion,\n\t\tobj_material_build,\n\t\tlast_updated_by,\n\t\tlloyds_vessel_id,\n\t\tobj_market_area_code,\n\t\tobj_market_area_desc,\n\t\tobj_market_area_country_code,\n\t\tobj_market_area_country_desc\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> selectOutputColumn\nflagDesc derive(obj_object_type = case(isNull(target_description_object_type), obj_object_type, target_description_object_type),\n\t\tobj_flag_iso3 = case(isNull(target_description_flag), obj_flag_iso3, target_description_flag)) ~> expression\nselectOutputColumn alterRow(upsertIf(true())) ~> alterRow\ntcrossreference filter(CODE_TYPE_ID==100 && SOURCE_SYSTEM=='LLOYDS') ~> flag\ntcrossreference filter(CODE_TYPE_ID==45 && SOURCE_SYSTEM=='LLOYDS') ~> objectType\ntcrossreference filter(CODE_TYPE_ID==50 && SOURCE_SYSTEM=='LLOYDS') ~> country\ntcrossreference filter(CODE_TYPE_ID==806 && SOURCE_SYSTEM=='LLOYDS') ~> market\nalterRow sink(input(\n\t\tobj_engine_builder as string,\n\t\tobj_propulsion_code as string,\n\t\tobj_engine_designation as string,\n\t\tobj_fuel_type as string,\n\t\tobj_pandi_club as string,\n\t\tobj_hullid as long,\n\t\tobj_sourceid as long,\n\t\tobj_num_of_holds as decimal(28,10),\n\t\tobj_date_valid_from as date,\n\t\tobj_flag_iso3 as string,\n\t\tobj_fdwt as decimal(28,10),\n\t\tobj_lifting_geartype_desc as string,\n\t\tobj_gbo_owner as string,\n\t\tobj_num_of_passengers as decimal(28,10),\n\t\tobj_operator as string,\n\t\tobj_date_construction_end as date,\n\t\tobj_date_valid_to as date,\n\t\tobj_date_built as date,\n\t\tlloyds_vessel_id as long,\n\t\tobj_class3 as string,\n\t\tobj_rpm as decimal(28,10),\n\t\tobj_pandi_club_code as string,\n\t\tobj_class2 as string,\n\t\tobj_breadth_moulded as decimal(28,10),\n\t\tobj_num_of_decks as decimal(28,10),\n\t\tobj_propeller_type_code as string,\n\t\tobj_engine_designer as string,\n\t\tobj_market_area_country_desc as string,\n\t\tobj_hull_type_code as string,\n\t\tobj_ship_builder as string,\n\t\tobj_depth as decimal(28,10),\n\t\tobj_num_of_crew as decimal(28,10),\n\t\tobj_hull_type as string,\n\t\tobj_lifting_geartype_code as string,\n\t\tobj_operator_country_desc as string,\n\t\tobj_cap_trailer as decimal(28,10),\n\t\tobj_m3 as decimal(28,10),\n\t\tobj_manager_code as string,\n\t\tobj_cap_grain as decimal(28,10),\n\t\tobj_engine_type as string,\n\t\tobj_date_construction_start as date,\n\t\tobj_num_of_propellers as decimal(28,10),\n\t\tobj_breadth_extreme as decimal(28,10),\n\t\tobj_reg_owner as string,\n\t\tobj_market_area_code as string,\n\t\tobj_operator_country_code as string,\n\t\tobj_id as long,\n\t\tobj_material_build as string,\n\t\tobj_reg_owner_country_desc as string,\n\t\tobj_ship_builder_country as string,\n\t\tobj_date_launch as date,\n\t\tobj_propeller_type_desc as string,\n\t\tobj_cap_gas as decimal(28,10),\n\t\tobj_cap_teu as decimal(28,10),\n\t\tobj_manager as string,\n\t\tobj_key as string,\n\t\tobj_reg_owner_country as string,\n\t\ttop_id as long,\n\t\tobj_class1_code as string,\n\t\tobj_status as string,\n\t\tobj_cap_liquid as long,\n\t\tobj_market_area_desc as string,\n\t\tobj_iceclasstext as string,\n\t\tobj_class1 as string,\n\t\tobj_class3_code as string,\n\t\tobj_market_area_country_code as string,\n\t\tobj_cap_car as decimal(28,10),\n\t\tobj_cylinder_arrangement as string,\n\t\tobj_object_type_code as string,\n\t\tobj_object_name as string,\n\t\tobj_dwt as decimal(28,10),\n\t\tobj_status_code as string,\n\t\tobj_gt as decimal(28,10),\n\t\tobj_built_year as integer,\n\t\tobj_hp as decimal(28,10),\n\t\tobj_gb_owner_country_desc as string,\n\t\tobj_speed as decimal(28,10),\n\t\tobj_iceclass as string,\n\t\tobj_cap_bale as decimal(28,10),\n\t\tobj_date_dead as date,\n\t\tobj_manager_country_desc as string,\n\t\tobj_total_kw as decimal(28,10),\n\t\tobj_object_type as string,\n\t\tobj_fuel_type_code as string,\n\t\tobj_propulsion as string,\n\t\tobj_class2_code as string,\n\t\tobj_imo_number as decimal(28,10),\n\t\tobj_num_of_hatches as decimal(28,10),\n\t\tobj_num_of_cylinders as decimal(28,10),\n\t\tobj_service_speed as string,\n\t\tobj_gbo_owner_country as string,\n\t\tobj_gard_objectid as long,\n\t\tobj_length_overall as decimal(28,10),\n\t\tobj_manager_country_code as string,\n\t\tobj_stroke_type as string,\n\t\tobj_flag_iso3_code as string,\n\t\tobj_num_of_total_tanks as decimal(28,10),\n\t\tdate_last_updated as timestamp,\n\t\tlast_updated_by as string,\n\t\tinserted_by as string,\n\t\tdate_inserted as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:true,\n\tformat: 'table',\n\tmapColumn(\n\t\tobj_flag_iso3,\n\t\tobj_class3,\n\t\tobj_hull_type,\n\t\tobj_material_build,\n\t\tobj_ship_builder_country,\n\t\tobj_propeller_type_desc,\n\t\tobj_status,\n\t\tobj_class3_code,\n\t\tobj_propulsion,\n\t\tobj_service_speed,\n\t\tlast_updated_by\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> preDimObject"
		}
	}
}