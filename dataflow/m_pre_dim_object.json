{
	"name": "m_pre_dim_object",
	"properties": {
		"folder": {
			"name": "dwh_prepare/pre_dim"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Other",
						"type": "DatasetReference"
					},
					"name": "lloydsvesselhistory"
				},
				{
					"dataset": {
						"referenceName": "Other",
						"type": "DatasetReference"
					},
					"name": "lloydscompany"
				},
				{
					"dataset": {
						"referenceName": "Other",
						"type": "DatasetReference"
					},
					"name": "tcrossreference"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "companyMgr"
				},
				{
					"name": "benificialOwner"
				},
				{
					"name": "commercialOperator"
				},
				{
					"name": "regOwner"
				},
				{
					"name": "manager"
				},
				{
					"name": "companyGBowner"
				},
				{
					"name": "companyOperator"
				},
				{
					"name": "companyRegOwner"
				},
				{
					"name": "companyGBOwnerCnty"
				},
				{
					"name": "companyMgrCnty"
				},
				{
					"name": "companyOperatorCnty"
				},
				{
					"name": "tmptabell"
				},
				{
					"name": "derivedColumns"
				},
				{
					"name": "marketArea"
				},
				{
					"name": "country"
				},
				{
					"name": "objectTypeDesc"
				},
				{
					"name": "falgDesc"
				},
				{
					"name": "expression"
				},
				{
					"name": "beneficialOwnerCountry"
				},
				{
					"name": "managerCountry"
				},
				{
					"name": "operatorCountry"
				},
				{
					"name": "commercialOwnerCntry"
				},
				{
					"name": "companyComOwnerCnty"
				}
			],
			"script": "source(output(\n\t\tVESSEL_KEY_COLUMN as double,\n\t\tVESSEL_ID as decimal(38,18),\n\t\tIMO as decimal(38,18),\n\t\tVESSEL_NAME as string,\n\t\tYEAR_OF_BUILD as decimal(38,18),\n\t\tFLAG as string,\n\t\tCALL_SIGN as string,\n\t\tMMSI as string,\n\t\tPORT_OF_REGISTRY as string,\n\t\tGROSS as decimal(38,18),\n\t\tNET as decimal(38,18),\n\t\tDWT as decimal(38,18),\n\t\tVESSEL_TYPE_CODE as string,\n\t\tVESSEL_TYPE as string,\n\t\tSTATUS as string,\n\t\tRECORD_LAST_UPDATED as timestamp,\n\t\tBREADTH_EXTREME as decimal(38,18),\n\t\tBREADTH_MOULDED as decimal(38,18),\n\t\tDEPTH as decimal(38,18),\n\t\tDRAFT as decimal(38,18),\n\t\tFREEBOARD as decimal(38,18),\n\t\tLBP as decimal(38,18),\n\t\tLOA as decimal(38,18),\n\t\tLRG as decimal(38,18),\n\t\tTPCMI as decimal(38,18),\n\t\tMANIFOLD_TO_BOW as decimal(38,18),\n\t\tPARALLEL_BODY_LENGTH as decimal(38,18),\n\t\tKTM as decimal(38,18),\n\t\tFORMULA_DWT as decimal(38,18),\n\t\tCONVENTION_69_IND as string,\n\t\tDISPLACEMENT as decimal(38,18),\n\t\tPANAMA_NRT as decimal(38,18),\n\t\tSUEZ_NRT as decimal(38,18),\n\t\tBULBOUS_BOW_IND as string,\n\t\tHULL_TYPE as string,\n\t\tHULL_DESIGN as string,\n\t\tMATERIAL_OF_BUILD as string,\n\t\tNO_DECKS as decimal(38,18),\n\t\tHELI_DECK_IND as string,\n\t\tNO_WATERTIGHT_COMPARTMENTS as decimal(38,18),\n\t\tNO_BULKHEADS as decimal(38,18),\n\t\tTHRUSTER_IND as string,\n\t\tENGINE_POSITION as string,\n\t\tTOTAL_TANKS as decimal(38,18),\n\t\tNO_WING_TANKS as decimal(38,18),\n\t\tNO_CENTRE_TANKS as decimal(38,18),\n\t\tSTRENGTHENED_FOR_HEAVY_CARGO as string,\n\t\tORE_CARGO_IND as string,\n\t\tFUEL_CAPACITY as decimal(38,18),\n\t\tFUEL_CONSUMPTION as string,\n\t\tPROPULSION_TYPE as string,\n\t\tPROPULSION_TEXT as string,\n\t\tSPEED as decimal(38,18),\n\t\tSPEED_TYPE as string,\n\t\tNO_CREW as decimal(38,18),\n\t\tNO_PASSENGERS as decimal(38,18),\n\t\tNO_BERTHS as decimal(38,18),\n\t\tNO_CABINS as decimal(38,18),\n\t\tLANE_LENGTH as decimal(38,18),\n\t\tLANE_WIDTH as decimal(38,18),\n\t\tNO_REEFER_PLUGS as decimal(38,18),\n\t\tCONVERSION_TEXT as string,\n\t\tCONVERSION_DATE as timestamp,\n\t\tHATCH_TYPE as string,\n\t\tGEARLESS_IND as string,\n\t\tCO2_IND as string,\n\t\tBALE_CAPACITY as decimal(38,18),\n\t\tBALLAST_CAPACITY as decimal(38,18),\n\t\tBOLLARD_PULL as decimal(38,18),\n\t\tCAR_CAPACITY as decimal(38,18),\n\t\tTRAILER_CAPACITY as decimal(38,18),\n\t\tGAS_CAPACITY as decimal(38,18),\n\t\tGRAIN_CAPACITY as decimal(38,18),\n\t\tLIQUID_CAPACITY as decimal(38,18),\n\t\tLIQUID_CAPACITY_BARRELS as decimal(38,18),\n\t\tORE_CAPACITY_TONNES as decimal(38,18),\n\t\tPUMP_CAPACITY_CUBIC as decimal(38,18),\n\t\tPUMP_CAPACITY_TONNES as decimal(38,18),\n\t\tPUMP_DESCRIPTION as string,\n\t\tREFRIGERATED_CAPACITY as decimal(38,18),\n\t\tDECK_TANK_CAPACITY as decimal(38,18),\n\t\tSLOP_TANK_CAPACITY as decimal(38,18),\n\t\tTEU_CAPACITY as decimal(38,18),\n\t\tTEU_DECK_CAPACITY as decimal(38,18),\n\t\tTEU_HOLD_CAPACITY as decimal(38,18),\n\t\tTEU_OPERATION_CAPACITY as decimal(38,18),\n\t\tREFRIGERATED_TEU_CAPACITY as decimal(38,18),\n\t\tTEU_14T_CAPACITY as decimal(38,18),\n\t\tTOTAL_HATCHES as decimal(38,18),\n\t\tMAXIMUM_HATCH_WIDTH as decimal(38,18),\n\t\tMAXIMUM_HATCH_LENGTH as decimal(38,18),\n\t\tTOTAL_HOLDS as decimal(38,18),\n\t\tMAXIMUM_HOLD_WIDTH as decimal(38,18),\n\t\tMAXIMUM_HOLD_LENGTH as decimal(38,18),\n\t\tMAXIMUM_HOLD_DEPTH as decimal(38,18),\n\t\tBOW_CHAIN_STOPPERS as string,\n\t\tSPM_IND as string,\n\t\tBOW_LOAD_DISCHARGE as string,\n\t\tSTERN_LOAD_DISCHARGE as string,\n\t\tMANIFOLD_TYPE as string,\n\t\tMANIFOLD_DISTANCE as decimal(38,18),\n\t\tCLS_IND as string,\n\t\tIMO_RATING_1 as string,\n\t\tIMO_RATING_2 as string,\n\t\tIMO_RATING_3 as string,\n\t\tNO_GRADES as decimal(38,18),\n\t\tNO_LINES as decimal(38,18),\n\t\tSBT_IND as string,\n\t\tSTAINLES_STEEL_TANKS as string,\n\t\tNO_STAINLESS_STEEL_TANKS as decimal(38,18),\n\t\tTANK_COATED_IND as string,\n\t\tTANK_COATED_TEXT as string,\n\t\tTANK_TEXT as string,\n\t\tTOTAL_PUMPS as decimal(38,18),\n\t\tHEAT_EXCHANGERS as string,\n\t\tCOIL_IND as string,\n\t\tCOIL_TEXT as string,\n\t\tCOW_IND as string,\n\t\tFLASH_POINT_60_IND as string,\n\t\tAMMONIA_IND as string,\n\t\tETHYLENE_IND as string,\n\t\tIGS_IND as string,\n\t\tLNG_CONTAINMENT_IND as string,\n\t\tGAS_MIN_PRESSURE as decimal(38,18),\n\t\tGAS_MAX_PRESSURE as decimal(38,18),\n\t\tPRESSURISED_IND as string,\n\t\tSEMI_PRESSURISED_IND as string,\n\t\tREFRIGERATED_IND as string,\n\t\tVCM_IND as string,\n\t\tTOTAL_GENERATORS as decimal(38,18),\n\t\tTOTAL_GENERATOR_POWER as decimal(38,18),\n\t\tTOTAL_AC_CURRENT_GENERATORS as decimal(38,18),\n\t\tTOTAL_DC_CURRENT_GENERATORS as decimal(38,18),\n\t\tTOTAL_BOILERS as decimal(38,18),\n\t\tCOMMON_BOILER_TYPE as string,\n\t\tTOTAL_LIFTING_GEAR as decimal(38,18),\n\t\tCOMMON_GEAR_TYPE_CODE as string,\n\t\tCOMMON_GEAR_TYPE as string,\n\t\tMAXIMUM_INDIVIDUAL_GEAR_SWL as decimal(38,18),\n\t\tTOTAL_PROPELLERS as decimal(38,18),\n\t\tCOMMON_PROPELLER_TYPE_CODE as string,\n\t\tCOMMON_PROPELLER_TYPE as string,\n\t\tBUILT_PLACE as string,\n\t\tYARD_NUMBER as string,\n\t\tVESSEL_BUILDER as string,\n\t\tORDER_DATE as timestamp,\n\t\tORDER_VALUE as decimal(38,18),\n\t\tORDER_CANCELLED as timestamp,\n\t\tSCHEDULED_CONSTRUCTION_END as timestamp,\n\t\tORIGINAL_SCHED_CONS_END as timestamp,\n\t\tCONSTRUCTION_START as timestamp,\n\t\tLAUNCH_DATE as timestamp,\n\t\tCONSTRUCTION_END as timestamp,\n\t\tDEAD_DATE as timestamp,\n\t\tLOSS_DATE as timestamp,\n\t\tBROKEN_END_DATE as timestamp,\n\t\tBREAKER_COMPANY as string,\n\t\tBROKEN_PLACE as string,\n\t\tLT_TONNES as decimal(38,18),\n\t\tCURRENT_NAME as string,\n\t\tSTART_DATE as timestamp,\n\t\tPREVIOUS_NAME as string,\n\t\tNAME_CHANGES_PREVIOUS_3_YEARS as decimal(38,18),\n\t\tCURRENT_FLAG as string,\n\t\tCURRENT_FLAG_START_DATE as timestamp,\n\t\tFLAG_OFFICIAL_NUMBER as string,\n\t\tPREVIOUS_FLAG as string,\n\t\tFLAG_CHANGES_PREVIOUS_3_YEARS as decimal(38,18),\n\t\tCLASS1_CODE as string,\n\t\tCLASS1 as string,\n\t\tCLASS1_START_DATE as timestamp,\n\t\tCLASS1_NOTATION as string,\n\t\tCLASS1_RATING as string,\n\t\tCLASS1_VESSEL_ID as string,\n\t\tCLASS1_ESP_IND as string,\n\t\tCLASS1_ICE_CLASS as string,\n\t\tCLASS1_ICE_CLASS_TEXT as string,\n\t\tCLASS1_SUSPENSION_IND as string,\n\t\tCLASS1_PROVISIONAL_IND as string,\n\t\tCLASS1_PROVISIONAL_END_DATE as timestamp,\n\t\tCLASS1_LAST_SURVEY_DATE as timestamp,\n\t\tCLASS2_CODE as string,\n\t\tCLASS2 as string,\n\t\tCLASS2_START_DATE as timestamp,\n\t\tCLASS2_NOTATION as string,\n\t\tCLASS2_RATING as string,\n\t\tCLASS2_VESSEL_ID as string,\n\t\tCLASS2_ESP_IND as string,\n\t\tCLASS2_ICE_CLASS as string,\n\t\tCLASS2_ICE_CLASS_TEXT as string,\n\t\tCLASS2_SUSPENSION_IND as string,\n\t\tCLASS2_PROVISIONAL_IND as string,\n\t\tCLASS2_PROVISIONAL_END_DATE as timestamp,\n\t\tCLASS2_LAST_SURVEY_DATE as timestamp,\n\t\tCLASS_CHANGES_PREVIOUS_3_YEARS as decimal(38,18),\n\t\tPI_CLUB_ID as string,\n\t\tPI_CLUB as string,\n\t\tPI_START_DATE as timestamp,\n\t\tPI_CHANGES_PREVIOUS_3_YEARS as decimal(38,18),\n\t\tEARLIEST_ENGINE_DOB as timestamp,\n\t\tNO_ENGINES as decimal(38,18),\n\t\tPOWER_KW as decimal(38,18),\n\t\tMAXIMUM_RPM as decimal(38,18),\n\t\tHP as decimal(38,18),\n\t\tENGINE_BUILDER as string,\n\t\tENGINE_BUILT_TOWN as string,\n\t\tENGINE_DESIGNATION as string,\n\t\tENGINE_DESIGNER as string,\n\t\tBORE as decimal(38,18),\n\t\tSTROKE as decimal(38,18),\n\t\tENGINE_ACTION as string,\n\t\tNO_CYLINDERS as decimal(38,18),\n\t\tCYLINDER_ARRANGEMENT as string,\n\t\tENGINE_TYPE as string,\n\t\tSTROKE_TYPE as decimal(38,18),\n\t\tFUEL_TYPE as string,\n\t\tFUEL_TYPE2 as string,\n\t\tINMARSAT_CODE as string,\n\t\tINMARSAT_NUMBER as string,\n\t\tANSWER_BACK as string,\n\t\tBENEFICIAL_OWNER_ID as decimal(38,18),\n\t\tBENEFICIAL_OWNER_START_DATE as timestamp,\n\t\tCOMMERCIAL_OPERATOR_ID as decimal(38,18),\n\t\tCOMMERCIAL_OP_START_DATE as timestamp,\n\t\tREGISTERED_OWNER_ID as decimal(38,18),\n\t\tREGISTERED_OWNER_START_DATE as timestamp,\n\t\tTHIRD_PARTY_OPERATOR_ID as decimal(38,18),\n\t\tTHIRD_PARTY_OPERATOR_START_DAT as timestamp,\n\t\tTECHNICAL_MANAGER_ID as decimal(38,18),\n\t\tTECHNICAL_MANAGER_START_DATE as timestamp,\n\t\tNOMINAL_OWNER_ID as decimal(38,18),\n\t\tNOMINAL_OWNER_START_DATE as timestamp,\n\t\tTOTAL_CASUALTIES as decimal(38,18),\n\t\tTOTAL_CASUALTIES_LAST_5_YEARS as decimal(38,18),\n\t\tTOTAL_CASUALTIES_LAST_12_MONTH as decimal(38,18),\n\t\tCASUALTY_DATE as timestamp,\n\t\tCOLLISIONS as decimal(38,18),\n\t\tMACHINERY_DAMAGE as decimal(38,18),\n\t\tHULL_DAMAGE as decimal(38,18),\n\t\tPIRACY as decimal(38,18),\n\t\tINCIDENTS_RESULT_IN_POLLUTION as decimal(38,18),\n\t\tINCIDENT_RESULT_IN_LOS_OF_LIFE as decimal(38,18),\n\t\tTOTAL_DEAD as decimal(38,18),\n\t\tTOTAL_MISSING as decimal(38,18),\n\t\tTOTAL_INJURED as decimal(38,18),\n\t\tLATEST_INCIDENT_PRECIS as string,\n\t\tTOTAL_INSPECTIONS as decimal(38,18),\n\t\tTOTAL_DETENTIONS as decimal(38,18),\n\t\tINSPECTIONS_LAST_3_YEARS as decimal(38,18),\n\t\tDETENTIONS_LAST_3_YEARS as decimal(38,18),\n\t\tINSPECTIONS_LAST_12_MONTHS as decimal(38,18),\n\t\tDETENTIONS_LAST_12_MONTHS as decimal(38,18),\n\t\tLATEST_INSPECTION_DATE as timestamp,\n\t\tNUMBER_DEFICIENCI_LAST_3_YEAR as decimal(38,18),\n\t\tDETENTION_IND as string,\n\t\tINSPECTION_PRECIS as string,\n\t\tNUMBER_OWNER as double,\n\t\tCOUNT_ENG_BUILDER as double,\n\t\tCOUNT_DESIGNATION as double,\n\t\tCOUNT_GBOWNER_CHG_5Y as double,\n\t\tVALID_FROM as timestamp,\n\t\tVALID_TO as timestamp,\n\t\tINSERT_DATE as timestamp,\n\t\tUPDATE_DATE as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\twildcardPaths:['Other/lloyds_vessel_history.parquet']) ~> lloydsvesselhistory\nsource(output(\n\t\tSNAPSHOT_DATE as timestamp,\n\t\tCOMPANY_ID as decimal(38,18),\n\t\tCOMPANY_NAME as string,\n\t\tCOMPANY_FIRST_YEAR as decimal(38,18),\n\t\tCOMPANY_FIRST_YEAR_QUALIFIER as string,\n\t\tCOMPANY_STATUS as string,\n\t\tOFFICE_STATUS as string,\n\t\tADDRESS_LINE_1 as string,\n\t\tADDRESS_LINE_2 as string,\n\t\tADDRESS_LINE_3 as string,\n\t\tADDRESS_LINE_4 as string,\n\t\tTOWN_CITY as string,\n\t\tCOUNTY_STATE as string,\n\t\tPOST_CODE_1 as string,\n\t\tPOST_CODE_2 as string,\n\t\tCOUNTRY as string,\n\t\tTELEPHONE as string,\n\t\tFAX as string,\n\t\tEMAIL as string,\n\t\tWEBSITE as string,\n\t\tISO3 as string,\n\t\tRECORD_LAST_UPDATED as timestamp,\n\t\tAUDIT_CREATED as timestamp,\n\t\tAUDIT_UPDATED as timestamp,\n\t\tLOAD_DATE as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> lloydscompany\nsource(output(\n\t\tFROM_CURRENCY_ID as double,\n\t\tTO_CURRENCY_ID as double,\n\t\tEXCHANGE_FROM_DATE as timestamp,\n\t\tEXCHANGE_RATE as decimal(38,18),\n\t\tEXCHANGE_TO_DATE as timestamp,\n\t\tFROM_CURRENCY_CODE as string,\n\t\tTO_CURRENCY_CODE as string,\n\t\tSNAPSHOT_DATE as timestamp,\n\t\tCOMPANY_ID as decimal(38,18),\n\t\tCOMPANY_NAME as string,\n\t\tCOMPANY_FIRST_YEAR as decimal(38,18),\n\t\tCOMPANY_FIRST_YEAR_QUALIFIER as string,\n\t\tCOMPANY_STATUS as string,\n\t\tOFFICE_STATUS as string,\n\t\tADDRESS_LINE_1 as string,\n\t\tADDRESS_LINE_2 as string,\n\t\tADDRESS_LINE_3 as string,\n\t\tADDRESS_LINE_4 as string,\n\t\tTOWN_CITY as string,\n\t\tCOUNTY_STATE as string,\n\t\tPOST_CODE_1 as string,\n\t\tPOST_CODE_2 as string,\n\t\tCOUNTRY as string,\n\t\tTELEPHONE as string,\n\t\tFAX as string,\n\t\tEMAIL as string,\n\t\tWEBSITE as string,\n\t\tISO3 as string,\n\t\tRECORD_LAST_UPDATED as timestamp,\n\t\tAUDIT_CREATED as timestamp,\n\t\tAUDIT_UPDATED as timestamp,\n\t\tLOAD_DATE as timestamp,\n\t\tVESSEL_KEY_COLUMN as double,\n\t\tVESSEL_ID as decimal(38,18),\n\t\tIMO as decimal(38,18),\n\t\tVESSEL_NAME as string,\n\t\tYEAR_OF_BUILD as decimal(38,18),\n\t\tFLAG as string,\n\t\tCALL_SIGN as string,\n\t\tMMSI as string,\n\t\tPORT_OF_REGISTRY as string,\n\t\tGROSS as decimal(38,18),\n\t\tNET as decimal(38,18),\n\t\tDWT as decimal(38,18),\n\t\tVESSEL_TYPE_CODE as string,\n\t\tVESSEL_TYPE as string,\n\t\tSTATUS as string,\n\t\tBREADTH_EXTREME as decimal(38,18),\n\t\tBREADTH_MOULDED as decimal(38,18),\n\t\tDEPTH as decimal(38,18),\n\t\tDRAFT as decimal(38,18),\n\t\tFREEBOARD as decimal(38,18),\n\t\tLBP as decimal(38,18),\n\t\tLOA as decimal(38,18),\n\t\tLRG as decimal(38,18),\n\t\tTPCMI as decimal(38,18),\n\t\tMANIFOLD_TO_BOW as decimal(38,18),\n\t\tPARALLEL_BODY_LENGTH as decimal(38,18),\n\t\tKTM as decimal(38,18),\n\t\tFORMULA_DWT as decimal(38,18),\n\t\tCONVENTION_69_IND as string,\n\t\tDISPLACEMENT as decimal(38,18),\n\t\tPANAMA_NRT as decimal(38,18),\n\t\tSUEZ_NRT as decimal(38,18),\n\t\tBULBOUS_BOW_IND as string,\n\t\tHULL_TYPE as string,\n\t\tHULL_DESIGN as string,\n\t\tMATERIAL_OF_BUILD as string,\n\t\tNO_DECKS as decimal(38,18),\n\t\tHELI_DECK_IND as string,\n\t\tNO_WATERTIGHT_COMPARTMENTS as decimal(38,18),\n\t\tNO_BULKHEADS as decimal(38,18),\n\t\tTHRUSTER_IND as string,\n\t\tENGINE_POSITION as string,\n\t\tTOTAL_TANKS as decimal(38,18),\n\t\tNO_WING_TANKS as decimal(38,18),\n\t\tNO_CENTRE_TANKS as decimal(38,18),\n\t\tSTRENGTHENED_FOR_HEAVY_CARGO as string,\n\t\tORE_CARGO_IND as string,\n\t\tFUEL_CAPACITY as decimal(38,18),\n\t\tFUEL_CONSUMPTION as string,\n\t\tPROPULSION_TYPE as string,\n\t\tPROPULSION_TEXT as string,\n\t\tSPEED as decimal(38,18),\n\t\tSPEED_TYPE as string,\n\t\tNO_CREW as decimal(38,18),\n\t\tNO_PASSENGERS as decimal(38,18),\n\t\tNO_BERTHS as decimal(38,18),\n\t\tNO_CABINS as decimal(38,18),\n\t\tLANE_LENGTH as decimal(38,18),\n\t\tLANE_WIDTH as decimal(38,18),\n\t\tNO_REEFER_PLUGS as decimal(38,18),\n\t\tCONVERSION_TEXT as string,\n\t\tCONVERSION_DATE as timestamp,\n\t\tHATCH_TYPE as string,\n\t\tGEARLESS_IND as string,\n\t\tCO2_IND as string,\n\t\tBALE_CAPACITY as decimal(38,18),\n\t\tBALLAST_CAPACITY as decimal(38,18),\n\t\tBOLLARD_PULL as decimal(38,18),\n\t\tCAR_CAPACITY as decimal(38,18),\n\t\tTRAILER_CAPACITY as decimal(38,18),\n\t\tGAS_CAPACITY as decimal(38,18),\n\t\tGRAIN_CAPACITY as decimal(38,18),\n\t\tLIQUID_CAPACITY as decimal(38,18),\n\t\tLIQUID_CAPACITY_BARRELS as decimal(38,18),\n\t\tORE_CAPACITY_TONNES as decimal(38,18),\n\t\tPUMP_CAPACITY_CUBIC as decimal(38,18),\n\t\tPUMP_CAPACITY_TONNES as decimal(38,18),\n\t\tPUMP_DESCRIPTION as string,\n\t\tREFRIGERATED_CAPACITY as decimal(38,18),\n\t\tDECK_TANK_CAPACITY as decimal(38,18),\n\t\tSLOP_TANK_CAPACITY as decimal(38,18),\n\t\tTEU_CAPACITY as decimal(38,18),\n\t\tTEU_DECK_CAPACITY as decimal(38,18),\n\t\tTEU_HOLD_CAPACITY as decimal(38,18),\n\t\tTEU_OPERATION_CAPACITY as decimal(38,18),\n\t\tREFRIGERATED_TEU_CAPACITY as decimal(38,18),\n\t\tTEU_14T_CAPACITY as decimal(38,18),\n\t\tTOTAL_HATCHES as decimal(38,18),\n\t\tMAXIMUM_HATCH_WIDTH as decimal(38,18),\n\t\tMAXIMUM_HATCH_LENGTH as decimal(38,18),\n\t\tTOTAL_HOLDS as decimal(38,18),\n\t\tMAXIMUM_HOLD_WIDTH as decimal(38,18),\n\t\tMAXIMUM_HOLD_LENGTH as decimal(38,18),\n\t\tMAXIMUM_HOLD_DEPTH as decimal(38,18),\n\t\tBOW_CHAIN_STOPPERS as string,\n\t\tSPM_IND as string,\n\t\tBOW_LOAD_DISCHARGE as string,\n\t\tSTERN_LOAD_DISCHARGE as string,\n\t\tMANIFOLD_TYPE as string,\n\t\tMANIFOLD_DISTANCE as decimal(38,18),\n\t\tCLS_IND as string,\n\t\tIMO_RATING_1 as string,\n\t\tIMO_RATING_2 as string,\n\t\tIMO_RATING_3 as string,\n\t\tNO_GRADES as decimal(38,18),\n\t\tNO_LINES as decimal(38,18),\n\t\tSBT_IND as string,\n\t\tSTAINLES_STEEL_TANKS as string,\n\t\tNO_STAINLESS_STEEL_TANKS as decimal(38,18),\n\t\tTANK_COATED_IND as string,\n\t\tTANK_COATED_TEXT as string,\n\t\tTANK_TEXT as string,\n\t\tTOTAL_PUMPS as decimal(38,18),\n\t\tHEAT_EXCHANGERS as string,\n\t\tCOIL_IND as string,\n\t\tCOIL_TEXT as string,\n\t\tCOW_IND as string,\n\t\tFLASH_POINT_60_IND as string,\n\t\tAMMONIA_IND as string,\n\t\tETHYLENE_IND as string,\n\t\tIGS_IND as string,\n\t\tLNG_CONTAINMENT_IND as string,\n\t\tGAS_MIN_PRESSURE as decimal(38,18),\n\t\tGAS_MAX_PRESSURE as decimal(38,18),\n\t\tPRESSURISED_IND as string,\n\t\tSEMI_PRESSURISED_IND as string,\n\t\tREFRIGERATED_IND as string,\n\t\tVCM_IND as string,\n\t\tTOTAL_GENERATORS as decimal(38,18),\n\t\tTOTAL_GENERATOR_POWER as decimal(38,18),\n\t\tTOTAL_AC_CURRENT_GENERATORS as decimal(38,18),\n\t\tTOTAL_DC_CURRENT_GENERATORS as decimal(38,18),\n\t\tTOTAL_BOILERS as decimal(38,18),\n\t\tCOMMON_BOILER_TYPE as string,\n\t\tTOTAL_LIFTING_GEAR as decimal(38,18),\n\t\tCOMMON_GEAR_TYPE_CODE as string,\n\t\tCOMMON_GEAR_TYPE as string,\n\t\tMAXIMUM_INDIVIDUAL_GEAR_SWL as decimal(38,18),\n\t\tTOTAL_PROPELLERS as decimal(38,18),\n\t\tCOMMON_PROPELLER_TYPE_CODE as string,\n\t\tCOMMON_PROPELLER_TYPE as string,\n\t\tBUILT_PLACE as string,\n\t\tYARD_NUMBER as string,\n\t\tVESSEL_BUILDER as string,\n\t\tORDER_DATE as timestamp,\n\t\tORDER_VALUE as decimal(38,18),\n\t\tORDER_CANCELLED as timestamp,\n\t\tSCHEDULED_CONSTRUCTION_END as timestamp,\n\t\tORIGINAL_SCHED_CONS_END as timestamp,\n\t\tCONSTRUCTION_START as timestamp,\n\t\tLAUNCH_DATE as timestamp,\n\t\tCONSTRUCTION_END as timestamp,\n\t\tDEAD_DATE as timestamp,\n\t\tLOSS_DATE as timestamp,\n\t\tBROKEN_END_DATE as timestamp,\n\t\tBREAKER_COMPANY as string,\n\t\tBROKEN_PLACE as string,\n\t\tLT_TONNES as decimal(38,18),\n\t\tCURRENT_NAME as string,\n\t\tSTART_DATE as timestamp,\n\t\tPREVIOUS_NAME as string,\n\t\tNAME_CHANGES_PREVIOUS_3_YEARS as decimal(38,18),\n\t\tCURRENT_FLAG as string,\n\t\tCURRENT_FLAG_START_DATE as timestamp,\n\t\tFLAG_OFFICIAL_NUMBER as string,\n\t\tPREVIOUS_FLAG as string,\n\t\tFLAG_CHANGES_PREVIOUS_3_YEARS as decimal(38,18),\n\t\tCLASS1_CODE as string,\n\t\tCLASS1 as string,\n\t\tCLASS1_START_DATE as timestamp,\n\t\tCLASS1_NOTATION as string,\n\t\tCLASS1_RATING as string,\n\t\tCLASS1_VESSEL_ID as string,\n\t\tCLASS1_ESP_IND as string,\n\t\tCLASS1_ICE_CLASS as string,\n\t\tCLASS1_ICE_CLASS_TEXT as string,\n\t\tCLASS1_SUSPENSION_IND as string,\n\t\tCLASS1_PROVISIONAL_IND as string,\n\t\tCLASS1_PROVISIONAL_END_DATE as timestamp,\n\t\tCLASS1_LAST_SURVEY_DATE as timestamp,\n\t\tCLASS2_CODE as string,\n\t\tCLASS2 as string,\n\t\tCLASS2_START_DATE as timestamp,\n\t\tCLASS2_NOTATION as string,\n\t\tCLASS2_RATING as string,\n\t\tCLASS2_VESSEL_ID as string,\n\t\tCLASS2_ESP_IND as string,\n\t\tCLASS2_ICE_CLASS as string,\n\t\tCLASS2_ICE_CLASS_TEXT as string,\n\t\tCLASS2_SUSPENSION_IND as string,\n\t\tCLASS2_PROVISIONAL_IND as string,\n\t\tCLASS2_PROVISIONAL_END_DATE as timestamp,\n\t\tCLASS2_LAST_SURVEY_DATE as timestamp,\n\t\tCLASS_CHANGES_PREVIOUS_3_YEARS as decimal(38,18),\n\t\tPI_CLUB_ID as string,\n\t\tPI_CLUB as string,\n\t\tPI_START_DATE as timestamp,\n\t\tPI_CHANGES_PREVIOUS_3_YEARS as decimal(38,18),\n\t\tEARLIEST_ENGINE_DOB as timestamp,\n\t\tNO_ENGINES as decimal(38,18),\n\t\tPOWER_KW as decimal(38,18),\n\t\tMAXIMUM_RPM as decimal(38,18),\n\t\tHP as decimal(38,18),\n\t\tENGINE_BUILDER as string,\n\t\tENGINE_BUILT_TOWN as string,\n\t\tENGINE_DESIGNATION as string,\n\t\tENGINE_DESIGNER as string,\n\t\tBORE as decimal(38,18),\n\t\tSTROKE as decimal(38,18),\n\t\tENGINE_ACTION as string,\n\t\tNO_CYLINDERS as decimal(38,18),\n\t\tCYLINDER_ARRANGEMENT as string,\n\t\tENGINE_TYPE as string,\n\t\tSTROKE_TYPE as decimal(38,18),\n\t\tFUEL_TYPE as string,\n\t\tFUEL_TYPE2 as string,\n\t\tINMARSAT_CODE as string,\n\t\tINMARSAT_NUMBER as string,\n\t\tANSWER_BACK as string,\n\t\tBENEFICIAL_OWNER_ID as decimal(38,18),\n\t\tBENEFICIAL_OWNER_START_DATE as timestamp,\n\t\tCOMMERCIAL_OPERATOR_ID as decimal(38,18),\n\t\tCOMMERCIAL_OP_START_DATE as timestamp,\n\t\tREGISTERED_OWNER_ID as decimal(38,18),\n\t\tREGISTERED_OWNER_START_DATE as timestamp,\n\t\tTHIRD_PARTY_OPERATOR_ID as decimal(38,18),\n\t\tTHIRD_PARTY_OPERATOR_START_DAT as timestamp,\n\t\tTECHNICAL_MANAGER_ID as decimal(38,18),\n\t\tTECHNICAL_MANAGER_START_DATE as timestamp,\n\t\tNOMINAL_OWNER_ID as decimal(38,18),\n\t\tNOMINAL_OWNER_START_DATE as timestamp,\n\t\tTOTAL_CASUALTIES as decimal(38,18),\n\t\tTOTAL_CASUALTIES_LAST_5_YEARS as decimal(38,18),\n\t\tTOTAL_CASUALTIES_LAST_12_MONTH as decimal(38,18),\n\t\tCASUALTY_DATE as timestamp,\n\t\tCOLLISIONS as decimal(38,18),\n\t\tMACHINERY_DAMAGE as decimal(38,18),\n\t\tHULL_DAMAGE as decimal(38,18),\n\t\tPIRACY as decimal(38,18),\n\t\tINCIDENTS_RESULT_IN_POLLUTION as decimal(38,18),\n\t\tINCIDENT_RESULT_IN_LOS_OF_LIFE as decimal(38,18),\n\t\tTOTAL_DEAD as decimal(38,18),\n\t\tTOTAL_MISSING as decimal(38,18),\n\t\tTOTAL_INJURED as decimal(38,18),\n\t\tLATEST_INCIDENT_PRECIS as string,\n\t\tTOTAL_INSPECTIONS as decimal(38,18),\n\t\tTOTAL_DETENTIONS as decimal(38,18),\n\t\tINSPECTIONS_LAST_3_YEARS as decimal(38,18),\n\t\tDETENTIONS_LAST_3_YEARS as decimal(38,18),\n\t\tINSPECTIONS_LAST_12_MONTHS as decimal(38,18),\n\t\tDETENTIONS_LAST_12_MONTHS as decimal(38,18),\n\t\tLATEST_INSPECTION_DATE as timestamp,\n\t\tNUMBER_DEFICIENCI_LAST_3_YEAR as decimal(38,18),\n\t\tDETENTION_IND as string,\n\t\tINSPECTION_PRECIS as string,\n\t\tNUMBER_OWNER as double,\n\t\tCOUNT_ENG_BUILDER as double,\n\t\tCOUNT_DESIGNATION as double,\n\t\tCOUNT_GBOWNER_CHG_5Y as double,\n\t\tVALID_FROM as timestamp,\n\t\tVALID_TO as timestamp,\n\t\tINSERT_DATE as timestamp,\n\t\tUPDATE_DATE as timestamp,\n\t\tcompany_id as integer,\n\t\taccount_resp_me as string,\n\t\taccount_resp_pi as string,\n\t\taccount_status as string,\n\t\tclient_lost_reason as string,\n\t\tcompany_email as string,\n\t\tcompany_name as string,\n\t\tcompany_owner_full_name as string,\n\t\tgard_contact_id as string,\n\t\tgard_market_area_code as string,\n\t\tgard_market_area_desc as string,\n\t\tparent_company_id as double,\n\t\tparent_company_name as string,\n\t\tsource_system_id as integer,\n\t\tprimary_contact_email as string,\n\t\tprimary_contact_name as string,\n\t\tsource_system as string,\n\t\tSOURCE_CODE_KEY as string,\n\t\tSOURCE_SYSTEM as string,\n\t\tTARGET_CODE as string,\n\t\tTARGET_DESCRIPTION as string,\n\t\tCODE_TYPE as string,\n\t\tCODE_TYPE_ID as double,\n\t\tCODE2 as string,\n\t\tOM_X_REF as string,\n\t\tID as string,\n\t\tPRG_PRODUCT_GROUP_ID as string,\n\t\tPRG_PRODUCT_GROUP_NAME as string,\n\t\tPRG_PRODUCT_GROUP_SHORT_NAME as string,\n\t\tPRO_PRODUCT_ID as string,\n\t\tPRO_PRODUCT_NAME as string,\n\t\tPRO_PRODUCT_SHORT_NAME as string,\n\t\tPRO_SOURCE_INDICATOR as string,\n\t\tPRO_PRODUCT_TYPE as string,\n\t\tsource_code_key as string,\n\t\ttarget_code as string,\n\t\ttarget_description as string,\n\t\tcode_type_id as double,\n\t\tcode2 as string,\n\t\tom_x_ref as string,\n\t\tcode_type as string,\n\t\tPARENT_CODE_TYPE_ID as double,\n\t\tPARENT_TARGET_CODE as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\twildcardPaths:['Other']) ~> tcrossreference\nlloydsvesselhistory, manager lookup(TECHNICAL_MANAGER_ID == company_id_mgr,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyMgr\nlloydscompany select(mapColumn(\n\t\tcompany_id_benOwner = COMPANY_ID,\n\t\tobj_gbo_owner = COMPANY_NAME\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> benificialOwner\nlloydscompany select(mapColumn(\n\t\tcompany_id_comOper = COMPANY_ID,\n\t\tobj_operator = COMPANY_NAME\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> commercialOperator\nlloydscompany select(mapColumn(\n\t\tcompany_id_regOwner = COMPANY_ID,\n\t\tobj_reg_owner = COMPANY_NAME\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> regOwner\nlloydscompany select(mapColumn(\n\t\tcompany_id_mgr = COMPANY_ID,\n\t\tobj_manager = COMPANY_NAME\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> manager\ncompanyMgr, benificialOwner lookup(BENEFICIAL_OWNER_ID == company_id_benOwner,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyGBowner\ncompanyGBowner, commercialOperator lookup(COMMERCIAL_OPERATOR_ID == company_id_comOper,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyOperator\ncompanyOperator, regOwner lookup(REGISTERED_OWNER_ID == company_id_regOwner,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyRegOwner\ncompanyRegOwner, beneficialOwnerCountry lookup(BENEFICIAL_OWNER_ID == company_id_benOwnCtry,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyGBOwnerCnty\ncompanyGBOwnerCnty, managerCountry lookup(TECHNICAL_MANAGER_ID == company_id_mgrCntry,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyMgrCnty\ncompanyMgrCnty, operatorCountry lookup(COMMERCIAL_OPERATOR_ID == company_id_operCntry,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyOperatorCnty\ncompanyComOwnerCnty select(mapColumn(\n\t\tkey = VESSEL_KEY_COLUMN,\n\t\tobj_imo = IMO,\n\t\tobj_object_name = VESSEL_NAME,\n\t\tlloyds_vessel_id = VESSEL_ID,\n\t\tobj_sourceid = VESSEL_ID,\n\t\tobj_built_year = YEAR_OF_BUILD,\n\t\tobj_flag_iso3_code = FLAG,\n\t\tobj_status_code = STATUS,\n\t\tobj_object_type_code = VESSEL_TYPE_CODE,\n\t\tobj_object_type = VESSEL_TYPE,\n\t\tobj_dwt = DWT,\n\t\tobj_fdwt = FORMULA_DWT,\n\t\tobj_gt = GROSS,\n\t\tCALL_SIGN,\n\t\tMMSI,\n\t\tPORT_OF_REGISTRY,\n\t\tNET,\n\t\tRECORD_LAST_UPDATED,\n\t\tBREADTH_EXTREME,\n\t\tBREADTH_MOULDED,\n\t\tDEPTH,\n\t\tDRAFT,\n\t\tFREEBOARD,\n\t\tLBP,\n\t\tLOA,\n\t\tLRG,\n\t\tTPCMI,\n\t\tMANIFOLD_TO_BOW,\n\t\tPARALLEL_BODY_LENGTH,\n\t\tKTM,\n\t\tCONVENTION_69_IND,\n\t\tDISPLACEMENT,\n\t\tPANAMA_NRT,\n\t\tSUEZ_NRT,\n\t\tBULBOUS_BOW_IND,\n\t\tHULL_TYPE,\n\t\tHULL_DESIGN,\n\t\tMATERIAL_OF_BUILD,\n\t\tNO_DECKS,\n\t\tHELI_DECK_IND,\n\t\tNO_WATERTIGHT_COMPARTMENTS,\n\t\tNO_BULKHEADS,\n\t\tTHRUSTER_IND,\n\t\tENGINE_POSITION,\n\t\tTOTAL_TANKS,\n\t\tNO_WING_TANKS,\n\t\tNO_CENTRE_TANKS,\n\t\tSTRENGTHENED_FOR_HEAVY_CARGO,\n\t\tORE_CARGO_IND,\n\t\tFUEL_CAPACITY,\n\t\tFUEL_CONSUMPTION,\n\t\tPROPULSION_TYPE,\n\t\tPROPULSION_TEXT,\n\t\tSPEED,\n\t\tSPEED_TYPE,\n\t\tNO_CREW,\n\t\tNO_PASSENGERS,\n\t\tNO_BERTHS,\n\t\tNO_CABINS,\n\t\tLANE_LENGTH,\n\t\tLANE_WIDTH,\n\t\tNO_REEFER_PLUGS,\n\t\tCONVERSION_TEXT,\n\t\tCONVERSION_DATE,\n\t\tHATCH_TYPE,\n\t\tGEARLESS_IND,\n\t\tCO2_IND,\n\t\tBALE_CAPACITY,\n\t\tBALLAST_CAPACITY,\n\t\tBOLLARD_PULL,\n\t\tCAR_CAPACITY,\n\t\tTRAILER_CAPACITY,\n\t\tGAS_CAPACITY,\n\t\tGRAIN_CAPACITY,\n\t\tLIQUID_CAPACITY,\n\t\tLIQUID_CAPACITY_BARRELS,\n\t\tORE_CAPACITY_TONNES,\n\t\tPUMP_CAPACITY_CUBIC,\n\t\tPUMP_CAPACITY_TONNES,\n\t\tPUMP_DESCRIPTION,\n\t\tREFRIGERATED_CAPACITY,\n\t\tDECK_TANK_CAPACITY,\n\t\tSLOP_TANK_CAPACITY,\n\t\tTEU_CAPACITY,\n\t\tTEU_DECK_CAPACITY,\n\t\tTEU_HOLD_CAPACITY,\n\t\tTEU_OPERATION_CAPACITY,\n\t\tREFRIGERATED_TEU_CAPACITY,\n\t\tTEU_14T_CAPACITY,\n\t\tTOTAL_HATCHES,\n\t\tMAXIMUM_HATCH_WIDTH,\n\t\tMAXIMUM_HATCH_LENGTH,\n\t\tTOTAL_HOLDS,\n\t\tMAXIMUM_HOLD_WIDTH,\n\t\tMAXIMUM_HOLD_LENGTH,\n\t\tMAXIMUM_HOLD_DEPTH,\n\t\tBOW_CHAIN_STOPPERS,\n\t\tSPM_IND,\n\t\tBOW_LOAD_DISCHARGE,\n\t\tSTERN_LOAD_DISCHARGE,\n\t\tMANIFOLD_TYPE,\n\t\tMANIFOLD_DISTANCE,\n\t\tCLS_IND,\n\t\tIMO_RATING_1,\n\t\tIMO_RATING_2,\n\t\tIMO_RATING_3,\n\t\tNO_GRADES,\n\t\tNO_LINES,\n\t\tSBT_IND,\n\t\tSTAINLES_STEEL_TANKS,\n\t\tNO_STAINLESS_STEEL_TANKS,\n\t\tTANK_COATED_IND,\n\t\tTANK_COATED_TEXT,\n\t\tTANK_TEXT,\n\t\tTOTAL_PUMPS,\n\t\tHEAT_EXCHANGERS,\n\t\tCOIL_IND,\n\t\tCOIL_TEXT,\n\t\tCOW_IND,\n\t\tFLASH_POINT_60_IND,\n\t\tAMMONIA_IND,\n\t\tETHYLENE_IND,\n\t\tIGS_IND,\n\t\tLNG_CONTAINMENT_IND,\n\t\tGAS_MIN_PRESSURE,\n\t\tGAS_MAX_PRESSURE,\n\t\tPRESSURISED_IND,\n\t\tSEMI_PRESSURISED_IND,\n\t\tREFRIGERATED_IND,\n\t\tVCM_IND,\n\t\tTOTAL_GENERATORS,\n\t\tTOTAL_GENERATOR_POWER,\n\t\tTOTAL_AC_CURRENT_GENERATORS,\n\t\tTOTAL_DC_CURRENT_GENERATORS,\n\t\tTOTAL_BOILERS,\n\t\tCOMMON_BOILER_TYPE,\n\t\tTOTAL_LIFTING_GEAR,\n\t\tCOMMON_GEAR_TYPE_CODE,\n\t\tCOMMON_GEAR_TYPE,\n\t\tMAXIMUM_INDIVIDUAL_GEAR_SWL,\n\t\tTOTAL_PROPELLERS,\n\t\tCOMMON_PROPELLER_TYPE_CODE,\n\t\tCOMMON_PROPELLER_TYPE,\n\t\tBUILT_PLACE,\n\t\tYARD_NUMBER,\n\t\tobj_ship_builder = VESSEL_BUILDER,\n\t\tORDER_DATE,\n\t\tORDER_VALUE,\n\t\tORDER_CANCELLED,\n\t\tSCHEDULED_CONSTRUCTION_END,\n\t\tORIGINAL_SCHED_CONS_END,\n\t\tobj_date_construction_start = CONSTRUCTION_START,\n\t\tobj_date_launch = LAUNCH_DATE,\n\t\tobj_date_construction_end = CONSTRUCTION_END,\n\t\tobj_date_dead = DEAD_DATE,\n\t\tLOSS_DATE,\n\t\tBROKEN_END_DATE,\n\t\tBREAKER_COMPANY,\n\t\tBROKEN_PLACE,\n\t\tLT_TONNES,\n\t\tCURRENT_NAME,\n\t\tSTART_DATE,\n\t\tPREVIOUS_NAME,\n\t\tNAME_CHANGES_PREVIOUS_3_YEARS,\n\t\tCURRENT_FLAG,\n\t\tCURRENT_FLAG_START_DATE,\n\t\tFLAG_OFFICIAL_NUMBER,\n\t\tPREVIOUS_FLAG,\n\t\tFLAG_CHANGES_PREVIOUS_3_YEARS,\n\t\tobj_class1_code = CLASS1_CODE,\n\t\tobj_class1 = CLASS1,\n\t\tCLASS1_START_DATE,\n\t\tCLASS1_NOTATION,\n\t\tCLASS1_RATING,\n\t\tCLASS1_VESSEL_ID,\n\t\tCLASS1_ESP_IND,\n\t\tCLASS1_ICE_CLASS,\n\t\tCLASS1_ICE_CLASS_TEXT,\n\t\tCLASS1_SUSPENSION_IND,\n\t\tCLASS1_PROVISIONAL_IND,\n\t\tCLASS1_PROVISIONAL_END_DATE,\n\t\tCLASS1_LAST_SURVEY_DATE,\n\t\tobj_class2_code = CLASS2_CODE,\n\t\tobj_class2 = CLASS2,\n\t\tCLASS2_START_DATE,\n\t\tCLASS2_NOTATION,\n\t\tCLASS2_RATING,\n\t\tCLASS2_VESSEL_ID,\n\t\tCLASS2_ESP_IND,\n\t\tCLASS2_ICE_CLASS,\n\t\tCLASS2_ICE_CLASS_TEXT,\n\t\tCLASS2_SUSPENSION_IND,\n\t\tCLASS2_PROVISIONAL_IND,\n\t\tCLASS2_PROVISIONAL_END_DATE,\n\t\tCLASS2_LAST_SURVEY_DATE,\n\t\tCLASS_CHANGES_PREVIOUS_3_YEARS,\n\t\tPI_CLUB_ID,\n\t\tPI_CLUB,\n\t\tPI_START_DATE,\n\t\tPI_CHANGES_PREVIOUS_3_YEARS,\n\t\tEARLIEST_ENGINE_DOB,\n\t\tNO_ENGINES,\n\t\tPOWER_KW,\n\t\tMAXIMUM_RPM,\n\t\tHP,\n\t\tENGINE_BUILDER,\n\t\tENGINE_BUILT_TOWN,\n\t\tENGINE_DESIGNATION,\n\t\tENGINE_DESIGNER,\n\t\tBORE,\n\t\tSTROKE,\n\t\tENGINE_ACTION,\n\t\tNO_CYLINDERS,\n\t\tCYLINDER_ARRANGEMENT,\n\t\tENGINE_TYPE,\n\t\tSTROKE_TYPE,\n\t\tFUEL_TYPE,\n\t\tFUEL_TYPE2,\n\t\tINMARSAT_CODE,\n\t\tINMARSAT_NUMBER,\n\t\tANSWER_BACK,\n\t\tBENEFICIAL_OWNER_ID,\n\t\tBENEFICIAL_OWNER_START_DATE,\n\t\tCOMMERCIAL_OPERATOR_ID,\n\t\tCOMMERCIAL_OP_START_DATE,\n\t\tREGISTERED_OWNER_ID,\n\t\tREGISTERED_OWNER_START_DATE,\n\t\tTHIRD_PARTY_OPERATOR_ID,\n\t\tTHIRD_PARTY_OPERATOR_START_DAT,\n\t\tTECHNICAL_MANAGER_ID,\n\t\tTECHNICAL_MANAGER_START_DATE,\n\t\tNOMINAL_OWNER_ID,\n\t\tNOMINAL_OWNER_START_DATE,\n\t\tTOTAL_CASUALTIES,\n\t\tTOTAL_CASUALTIES_LAST_5_YEARS,\n\t\tTOTAL_CASUALTIES_LAST_12_MONTH,\n\t\tCASUALTY_DATE,\n\t\tCOLLISIONS,\n\t\tMACHINERY_DAMAGE,\n\t\tHULL_DAMAGE,\n\t\tPIRACY,\n\t\tINCIDENTS_RESULT_IN_POLLUTION,\n\t\tINCIDENT_RESULT_IN_LOS_OF_LIFE,\n\t\tTOTAL_DEAD,\n\t\tTOTAL_MISSING,\n\t\tTOTAL_INJURED,\n\t\tLATEST_INCIDENT_PRECIS,\n\t\tTOTAL_INSPECTIONS,\n\t\tTOTAL_DETENTIONS,\n\t\tINSPECTIONS_LAST_3_YEARS,\n\t\tDETENTIONS_LAST_3_YEARS,\n\t\tINSPECTIONS_LAST_12_MONTHS,\n\t\tDETENTIONS_LAST_12_MONTHS,\n\t\tLATEST_INSPECTION_DATE,\n\t\tNUMBER_DEFICIENCI_LAST_3_YEAR,\n\t\tDETENTION_IND,\n\t\tINSPECTION_PRECIS,\n\t\tNUMBER_OWNER,\n\t\tCOUNT_ENG_BUILDER,\n\t\tCOUNT_DESIGNATION,\n\t\tCOUNT_GBOWNER_CHG_5Y,\n\t\tVALID_FROM,\n\t\tVALID_TO,\n\t\tINSERT_DATE,\n\t\tUPDATE_DATE,\n\t\tcompany_id_mgr = manager@company_id_mgr,\n\t\tobj_manager = manager@obj_manager,\n\t\tcompany_id_benOwner,\n\t\tobj_gbo_owner,\n\t\tcompany_id_comOper = commercialOperator@company_id_comOper,\n\t\tobj_operator = commercialOperator@obj_operator,\n\t\tcompany_id_regOwner,\n\t\tobj_reg_owner,\n\t\tcompany_id_benOwnCtry,\n\t\tobj_gb_owner_country_desc,\n\t\tobj_gb_owner_country,\n\t\tcompany_id_mgrCntry,\n\t\tobj_manager_country_desc,\n\t\tobj_manager_country_code,\n\t\tcompany_id_operCntry,\n\t\tobj_operator_country_desc,\n\t\tobj_operator_country_code,\n\t\tcompany_id_cowcnty,\n\t\tobj_reg_owner_country_desc,\n\t\tobj_reg_owner_country\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> tmptabell\ntmptabell derive(code_type_id_market = 806,\n\t\tcode_type_id_object_type = 45,\n\t\tsource_system = 'LLOYDS',\n\t\tcode_type_id_country = 50,\n\t\tcode_type_id_flac = 100,\n\t\tobj_gard_objectid = ERROR_FUNCTION(''),\n\t\tobj_flag_iso3 = ERROR_FUNCTION(''),\n\t\tobj_status = ERROR_FUNCTION(''),\n\t\tobj_class3 = ERROR_FUNCTION(''),\n\t\tobj_class3_code = ERROR_FUNCTION(''),\n\t\tobj_m3 = ERROR_FUNCTION(''),\n\t\tobj_ship_builder_country = ERROR_FUNCTION('')) ~> derivedColumns\nderivedColumns, tcrossreference lookup(ERROR_FUNCTION('') == ERROR_FUNCTION(''),\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> marketArea\nmarketArea, tcrossreference lookup(ERROR_FUNCTION('') == ERROR_FUNCTION(''),\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> country\ncountry, tcrossreference lookup(ERROR_FUNCTION('') == ERROR_FUNCTION(''),\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> objectTypeDesc\nobjectTypeDesc, tcrossreference lookup(ERROR_FUNCTION('') == ERROR_FUNCTION(''),\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> falgDesc\nfalgDesc derive(tobereplaced_obj_object_type = case(isNull(target_description_object_type), obj_object_type, target_description_object_type),\n\t\ttobefound_obj_falg_iso3 = case(isNull(target_description_flag), obj_flag_iso3, target_description_flag)) ~> expression\nlloydscompany select(mapColumn(\n\t\tcompany_id_benOwnCtry = COMPANY_ID,\n\t\tobj_gb_owner_country_desc = COUNTRY,\n\t\tobj_gb_owner_country = ISO3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> beneficialOwnerCountry\nlloydscompany select(mapColumn(\n\t\tcompany_id_mgrCntry = COMPANY_ID,\n\t\tobj_manager_country_desc = COUNTRY,\n\t\tobj_manager_country_code = ISO3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> managerCountry\nlloydscompany select(mapColumn(\n\t\tcompany_id_operCntry = COMPANY_ID,\n\t\tobj_operator_country_desc = COUNTRY,\n\t\tobj_operator_country_code = ISO3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> operatorCountry\nlloydscompany select(mapColumn(\n\t\tcompany_id_cowcnty = COMPANY_ID,\n\t\tobj_reg_owner_country_desc = COUNTRY,\n\t\tobj_reg_owner_country = ISO3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> commercialOwnerCntry\ncompanyOperatorCnty, commercialOwnerCntry lookup(COMMERCIAL_OPERATOR_ID == company_id_cowcnty,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> companyComOwnerCnty"
		}
	}
}