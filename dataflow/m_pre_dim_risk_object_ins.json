{
	"name": "m_pre_dim_risk_object_ins",
	"properties": {
		"description": "Insurance mapping from pre dim risk object",
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "Ica"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "ina"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "paa"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "peb"
				},
				{
					"dataset": {
						"referenceName": "Oltp05",
						"type": "DatasetReference"
					},
					"name": "tcross"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "pebtable"
				},
				{
					"name": "pebtable1"
				},
				{
					"name": "maxpebver"
				},
				{
					"name": "pebmaxpeb"
				},
				{
					"name": "icatable"
				},
				{
					"name": "inatable"
				},
				{
					"name": "paafunct0",
					"description": "paafunct ==0"
				},
				{
					"name": "paatable"
				},
				{
					"name": "icaina"
				},
				{
					"name": "inapaa"
				}
			],
			"script": "source(output(\n\t\ticaadmfeerate as decimal(38,18),\n\t\ticaagaid as string,\n\t\ticaaggregate as decimal(38,18),\n\t\ticaamtcod as string,\n\t\ticaamtlevel as decimal(38,18),\n\t\ticaavrperspre as decimal(38,18),\n\t\ticac1000prem as decimal(38,18),\n\t\ticacadate as timestamp,\n\t\ticacantxt as string,\n\t\ticacasign as string,\n\t\ticachdate as timestamp,\n\t\ticachhour as decimal(38,18),\n\t\ticacorrty as decimal(38,18),\n\t\ticacrdate as timestamp,\n\t\ticacrobbid as string,\n\t\ticacrsign as string,\n\t\ticacslynsw as string,\n\t\ticadayamt as decimal(38,18),\n\t\ticadaysinall as decimal(38,18),\n\t\ticadeclaredamt as decimal(38,18),\n\t\ticadeclaredamtlocal as decimal(38,18),\n\t\ticadednote as string,\n\t\ticadeliverydate as timestamp,\n\t\ticaendate as timestamp,\n\t\ticaenhour as decimal(38,18),\n\t\ticaeoamt as decimal(38,18),\n\t\ticaeoamtcod as string,\n\t\ticaexhausted as decimal(38,18),\n\t\ticaexpendate as timestamp,\n\t\ticaexpenhour as decimal(38,18),\n\t\ticaexptext as string,\n\t\ticaextndisc as decimal(38,18),\n\t\ticaextshare as decimal(38,18),\n\t\ticafixownrnote as string,\n\t\ticafixownrynsw as string,\n\t\ticagt as decimal(38,18),\n\t\ticaicaid as string,\n\t\ticainaid as string,\n\t\ticaindate as timestamp,\n\t\ticaint100prem as decimal(38,18),\n\t\ticaintcurr as string,\n\t\ticaintgrlag as decimal(38,18),\n\t\ticaintosprem as decimal(38,18),\n\t\ticaintrate as decimal(38,18),\n\t\ticaknvmark as string,\n\t\ticalaunchdate as timestamp,\n\t\ticalimldescr as string,\n\t\ticaludate as timestamp,\n\t\ticalusign as string,\n\t\ticamincurr as string,\n\t\ticaminpre as decimal(38,18),\n\t\ticanoofpersons as decimal(38,18),\n\t\ticanote as string,\n\t\ticaobno as decimal(38,18),\n\t\ticaoforder as decimal(38,18),\n\t\ticaosvolamt as decimal(38,18),\n\t\ticaourshare as decimal(38,18),\n\t\ticaowndisc as decimal(38,18),\n\t\ticaoyrno as decimal(38,18),\n\t\ticaoyrnote as string,\n\t\ticaoyrto as decimal(38,18),\n\t\ticapaymfreq as decimal(38,18),\n\t\ticapaymperc as decimal(38,18),\n\t\ticaperspre as decimal(38,18),\n\t\ticapmlamt as decimal(38,18),\n\t\ticapmlcurr as string,\n\t\ticapremgt as decimal(38,18),\n\t\ticaprevyadmfee as decimal(38,18),\n\t\ticaprevyinstad as decimal(38,18),\n\t\ticaprevynatpre as decimal(38,18),\n\t\ticaprevypre as decimal(38,18),\n\t\ticaprevyrate as decimal(38,18),\n\t\ticaprovst as decimal(38,18),\n\t\ticaprwdate as timestamp,\n\t\ticarinote as string,\n\t\ticariobjecttype as string,\n\t\ticasondisc as decimal(38,18),\n\t\ticastat3 as string,\n\t\ticastdate as timestamp,\n\t\ticasthour as decimal(38,18),\n\t\ticasufix2 as string,\n\t\ticat1000prem as decimal(38,18),\n\t\ticatlorat as decimal(38,18),\n\t\ticatotamt as decimal(38,18),\n\t\ticaunitamt as decimal(38,18),\n\t\ticaunitprem as decimal(38,18),\n\t\ticaunits as decimal(38,18),\n\t\ticauwaid as string,\n\t\ticauwkey as string,\n\t\ticauwtotamt as decimal(38,18),\n\t\ticawroforder as decimal(38,18),\n\t\ticawrshare as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> Ica\nsource(output(\n\t\tinaaccadrpeaid as decimal(38,18),\n\t\tinaag100e as string,\n\t\tinaagaid as string,\n\t\tinaareacd as string,\n\t\tinaassetno as decimal(38,18),\n\t\tinaassetsubno as decimal(38,18),\n\t\tinaborind as string,\n\t\tinabusnsubcla as decimal(38,18),\n\t\tinabusntyp as decimal(38,18),\n\t\tinacapoty as decimal(38,18),\n\t\tinacedent as decimal(38,18),\n\t\tinaclmadrpeaid as decimal(38,18),\n\t\tinaclmlead as decimal(38,18),\n\t\tinacondco as decimal(38,18),\n\t\tinacondset as string,\n\t\tinacooroccynsw as string,\n\t\tinacrdate as timestamp,\n\t\tinacrobbid as string,\n\t\tinacroynsw as string,\n\t\tinacrsign as string,\n\t\tinacshind as decimal(38,18),\n\t\tinacurr as string,\n\t\tinadescr6 as string,\n\t\tinadescr7 as string,\n\t\tinadwbsname as string,\n\t\tinaebusnsubcla as decimal(38,18),\n\t\tinaetcdone as string,\n\t\tinaetcdonedate as timestamp,\n\t\tinaetcpremium as string,\n\t\tinafileref as decimal(38,18),\n\t\tinafortcode as decimal(38,18),\n\t\tinagroup as decimal(38,18),\n\t\tinaimpexp as decimal(38,18),\n\t\tinainaid as string,\n\t\tinaindex as decimal(38,18),\n\t\tinainktp as string,\n\t\tinainno as decimal(38,18),\n\t\tinaintnote as string,\n\t\tinaintrst as string,\n\t\tinainttype as string,\n\t\tinaintyp as decimal(38,18),\n\t\tinaisaid as string,\n\t\tinaitaid as string,\n\t\tinaitemno as string,\n\t\tinaiyear as decimal(38,18),\n\t\tinaknvmark as string,\n\t\tinalocpolissued as string,\n\t\tinalosstxt35 as string,\n\t\tinalostcode as string,\n\t\tinalosttxt35 as string,\n\t\tinaludate as timestamp,\n\t\tinalusign as string,\n\t\tinamainin as string,\n\t\tinamutual as string,\n\t\tinanatsw as string,\n\t\tinanopers as decimal(38,18),\n\t\tinaob100e as string,\n\t\tinaobno as decimal(38,18),\n\t\tinaoperatingname as string,\n\t\tinaoperator as decimal(38,18),\n\t\tinaordercode as string,\n\t\tinaordertxt35 as string,\n\t\tinaoxno as decimal(38,18),\n\t\tinaoxrefid as string,\n\t\tinapayer as decimal(38,18),\n\t\tinapiffotype as decimal(38,18),\n\t\tinapintsh as decimal(38,18),\n\t\tinapirdctype as decimal(38,18),\n\t\tinapnote as string,\n\t\tinapofid as string,\n\t\tinaratema as string,\n\t\tinaratind as decimal(38,18),\n\t\tinareinnoof as decimal(38,18),\n\t\tinareinshare as decimal(38,18),\n\t\tinareinynsw as string,\n\t\tinarencod as decimal(38,18),\n\t\tinarenewswitches as string,\n\t\tinarenfieldsman as string,\n\t\tinarentxt as string,\n\t\tinaretyp as decimal(38,18),\n\t\tinariscod as decimal(38,18),\n\t\tinartlead as decimal(38,18),\n\t\tinaseasonmonthp as decimal(38,18),\n\t\tinaseasonnote as string,\n\t\tinaseasonynsw as string,\n\t\tinaslipref as string,\n\t\tinasmallcraft as string,\n\t\tinastat1 as string,\n\t\tinastopsettlement as string,\n\t\tinasufix1 as string,\n\t\tinataxcod as string,\n\t\tinataxexternal as string,\n\t\tinatocefo as string,\n\t\tinatotind as decimal(38,18),\n\t\tinatrdescr as string,\n\t\tinatzone as string,\n\t\tinausecod as string,\n\t\tinauwradrpeaid as decimal(38,18),\n\t\tinavoyagededynsw as string,\n\t\tinawarranty2 as decimal(38,18),\n\t\tinawarrenty as decimal(38,18),\n\t\tinawarrsw as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> ina\nsource(output(\n\t\tpaabusncla as decimal(38,18),\n\t\tpaabusnsec as decimal(38,18),\n\t\tpaacaddrcountry as string,\n\t\tpaacaddress1 as string,\n\t\tpaacaddress2 as string,\n\t\tpaacaddress3 as string,\n\t\tpaacaddress4 as string,\n\t\tpaacaddress5 as string,\n\t\tpaacaddrpostal as string,\n\t\tpaaccmail as string,\n\t\tpaacfax as string,\n\t\tpaacname as string,\n\t\tpaacname2 as string,\n\t\tpaacontcname as string,\n\t\tpaacontcphone as string,\n\t\tpaacontemail as string,\n\t\tpaacontmobcphone as string,\n\t\tpaacontpeaid as decimal(38,18),\n\t\tpaacphone as string,\n\t\tpaactelex as string,\n\t\tpaafunct as decimal(38,18),\n\t\tpaaintnet as string,\n\t\tpaaintnote as string,\n\t\tpaalcname as string,\n\t\tpaalongname as string,\n\t\tpaamail as string,\n\t\tpaapeaid as decimal(38,18),\n\t\tpaarevcname as string,\n\t\tpaascname as string,\n\t\tpaaspbusndiv as decimal(38,18),\n\t\tpaawww as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> paa\nsource(output(\n\t\tpebbrdate as timestamp,\n\t\tpebcivilstatus as decimal(38,18),\n\t\tpebconbusncla as decimal(38,18),\n\t\tpebconbusndiv as decimal(38,18),\n\t\tpebconbusnsec as decimal(38,18),\n\t\tpebconcomp2 as decimal(38,18),\n\t\tpebconoffice as decimal(38,18),\n\t\tpebdistrict as string,\n\t\tpebdunco as decimal(38,18),\n\t\tpebemlcurr as string,\n\t\tpebemlmdescr as string,\n\t\tpebetcbroker as string,\n\t\tpebfortsector as decimal(38,18),\n\t\tpebforttrade as string,\n\t\tpebgeneml as decimal(38,18),\n\t\tpebgroup as decimal(38,18),\n\t\tpebhourprice as decimal(38,18),\n\t\tpebinstadynz as string,\n\t\tpebisolan as string,\n\t\tpebkycapprdate as timestamp,\n\t\tpebkycapproved as string,\n\t\tpebkyccompany as decimal(38,18),\n\t\tpebkyccompdescr as string,\n\t\tpebkycid as string,\n\t\tpebludate as timestamp,\n\t\tpeblusign as string,\n\t\tpebmacheml as decimal(38,18),\n\t\tpebmansanctdescr as string,\n\t\tpebmansanction as string,\n\t\tpebmdescr as string,\n\t\tpebmvaynsw as string,\n\t\tpebnmisic as string,\n\t\tpebnmnyk as string,\n\t\tpeboffsanctdescr as string,\n\t\tpeboffsanction as string,\n\t\tpebonrisk as string,\n\t\tpebonriskdate as timestamp,\n\t\tpebpaylevel as decimal(38,18),\n\t\tpebpeaid as decimal(38,18),\n\t\tpebpebid as string,\n\t\tpebpeoid as string,\n\t\tpebpeoopeaid as decimal(38,18),\n\t\tpebpersacc as decimal(38,18),\n\t\tpebpever as decimal(38,18),\n\t\tpebpibregdate as timestamp,\n\t\tpebpibregsign as string,\n\t\tpebpidcname as string,\n\t\tpebpidid as decimal(38,18),\n\t\tpebpricecurr as string,\n\t\tpebqadate as timestamp,\n\t\tpebqasign as string,\n\t\tpebqastatus as string,\n\t\tpebratcod as string,\n\t\tpebratcomp as decimal(38,18),\n\t\tpebratedate as timestamp,\n\t\tpebratludate as timestamp,\n\t\tpebratsign as string,\n\t\tpebreason as string,\n\t\tpebressign as string,\n\t\tpebsitid as string,\n\t\tpebsupporter as string,\n\t\tpebtaxno as string,\n\t\tpebtypelevel as decimal(38,18),\n\t\tpebusstate as string,\n\t\tpebvaldate as timestamp,\n\t\tpebverstat as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> peb\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\twildcardPaths:['tcrossreference.parquet']) ~> tcross\npeb select(mapColumn(\n\t\tpebpeaid,\n\t\tpebpever\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> pebtable\npeb select(mapColumn(\n\t\tpebpeaid,\n\t\tpebpever,\n\t\tpebisolan\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> pebtable1\npebtable aggregate(groupBy(pebpeaid),\n\tmax_pebver = max(pebpever)) ~> maxpebver\nmaxpebver, pebtable1 join(maxpebver@pebpeaid == pebtable1@pebpeaid\n\t&& max_pebver == pebpever,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> pebmaxpeb\nIca select(mapColumn(\n\t\ticaicaid,\n\t\ticaprwdate,\n\t\ticainaid\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> icatable\nina select(mapColumn(\n\t\tinainaid,\n\t\tinacedent\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> inatable\npaa filter(paafunct == 0) ~> paafunct0\npaafunct0 select(mapColumn(\n\t\tpaapeaid,\n\t\tpaacname\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> paatable\nicatable, inatable join(icainaid == inainaid,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> icaina\nicaina, paa join(inacedent == paapeaid,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> inapaa"
		}
	}
}