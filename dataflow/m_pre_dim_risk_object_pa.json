{
	"name": "m_pre_dim_risk_object_pa",
	"properties": {
		"description": "Start testing how to make the risk_object. Starting on PA",
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Other",
						"type": "DatasetReference"
					},
					"name": "tcross"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "pea"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "ica"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "iuv"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "iuw"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "ipa"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "isz"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "isa"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "aga"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "ina"
				},
				{
					"dataset": {
						"referenceName": "Paris",
						"type": "DatasetReference"
					},
					"name": "obb"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "FilterCoverage",
					"description": "Filter codetype 122 and Source system Paris"
				},
				{
					"name": "tcrossCoverage"
				},
				{
					"name": "FilterAgreementType"
				},
				{
					"name": "TcrossAgreementType"
				},
				{
					"name": "FilterBusinessArea"
				},
				{
					"name": "TcrossBusinessArea"
				},
				{
					"name": "FilterCurrency"
				},
				{
					"name": "TcrossCurrency"
				},
				{
					"name": "FilterVesselSubType"
				},
				{
					"name": "TcrossVesselSubType"
				},
				{
					"name": "icatable"
				},
				{
					"name": "peatable"
				},
				{
					"name": "IuvverstatA"
				},
				{
					"name": "iuvtable"
				},
				{
					"name": "iuwtable"
				},
				{
					"name": "IcaIuv"
				},
				{
					"name": "IcaIuw"
				},
				{
					"name": "IuwPea"
				},
				{
					"name": "Expression"
				},
				{
					"name": "AggregateIcaicaid"
				},
				{
					"name": "IpacodeOP"
				},
				{
					"name": "ipatable"
				}
			],
			"script": "source(output(\n\t\tSOURCE_CODE_KEY as string,\n\t\tSOURCE_SYSTEM as string,\n\t\tTARGET_CODE as string,\n\t\tTARGET_DESCRIPTION as string,\n\t\tCODE_TYPE as string,\n\t\tCODE_TYPE_ID as double,\n\t\tCODE2 as string,\n\t\tOM_X_REF as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> tcross\nsource(output(\n\t\tpeaaaddbo as decimal(38,18),\n\t\tpeaaccaddynsw as string,\n\t\tpeaaclmadv as decimal(38,18),\n\t\tpeaaclmbo as decimal(38,18),\n\t\tpeaaclobo as decimal(38,18),\n\t\tpeaacorbo as decimal(38,18),\n\t\tpeaaddbor as decimal(38,18),\n\t\tpeaaddmailfreq as decimal(38,18),\n\t\tpeaalternatepayer as decimal(38,18),\n\t\tpeaaprobo as decimal(38,18),\n\t\tpeabirtno as string,\n\t\tpeabirtws as decimal(38,18),\n\t\tpeacalamt as decimal(38,18),\n\t\tpeacalcurr as string,\n\t\tpeaccint as string,\n\t\tpeaccintr as decimal(38,18),\n\t\tpeacclamt as decimal(38,18),\n\t\tpeacclcurr as string,\n\t\tpeaccode as decimal(38,18),\n\t\tpeaclamailfreq as decimal(38,18),\n\t\tpeaclmadv as decimal(38,18),\n\t\tpeaclmbor as decimal(38,18),\n\t\tpeaclmintynsw as string,\n\t\tpeaclmmailfreq as decimal(38,18),\n\t\tpeaclobor as decimal(38,18),\n\t\tpeaclomet as decimal(38,18),\n\t\tpeaclosmailfreq as decimal(38,18),\n\t\tpeacolid as string,\n\t\tpeacomp2 as decimal(38,18),\n\t\tpeacorbo as decimal(38,18),\n\t\tpeacorrmailfreq as decimal(38,18),\n\t\tpeacrdate as timestamp,\n\t\tpeacrmid as decimal(38,18),\n\t\tpeacrsign as string,\n\t\tpeacruser as decimal(38,18),\n\t\tpeacustomerid as string,\n\t\tpeadueday as decimal(38,18),\n\t\tpeaendate as timestamp,\n\t\tpeaextid as string,\n\t\tpeaextid2 as string,\n\t\tpeaexttransfer as string,\n\t\tpeaexttransfer2 as string,\n\t\tpeafromcomp as decimal(38,18),\n\t\tpeaie2busndiv as decimal(38,18),\n\t\tpeaie2busnse as decimal(38,18),\n\t\tpeaie3busndiv as decimal(38,18),\n\t\tpeaie3busnse as decimal(38,18),\n\t\tpeaiebusndiv as decimal(38,18),\n\t\tpeaiebusnse as decimal(38,18),\n\t\tpeaiecon1 as decimal(38,18),\n\t\tpeaiecon2 as decimal(38,18),\n\t\tpeaiecon3 as decimal(38,18),\n\t\tpeaiecon4 as decimal(38,18),\n\t\tpeaiecon5 as decimal(38,18),\n\t\tpeaiecond as string,\n\t\tpeaiediv as string,\n\t\tpeaieint as string,\n\t\tpeaieint1 as string,\n\t\tpeaieint2 as string,\n\t\tpeaieint3 as string,\n\t\tpeaieint4 as string,\n\t\tpeaieint5 as string,\n\t\tpeaiesect as string,\n\t\tpeaincreday as decimal(38,18),\n\t\tpeaingiro as decimal(38,18),\n\t\tpeaingiroludate as timestamp,\n\t\tpeaingirolusign as string,\n\t\tpeaingirono as string,\n\t\tpeainvisible as string,\n\t\tpeaiselectronic as string,\n\t\tpeaiyear as decimal(38,18),\n\t\tpeaknvmark as string,\n\t\tpealang2 as string,\n\t\tpealeicode as string,\n\t\tpealudate as timestamp,\n\t\tpealusign as string,\n\t\tpealuuser as decimal(38,18),\n\t\tpeamailcndnsplit as string,\n\t\tpeamailsizemb as decimal(38,18),\n\t\tpeamailuseservadress as string,\n\t\tpeamasked as string,\n\t\tpeamaxper as decimal(38,18),\n\t\tpeamdescr as string,\n\t\tpeamexamt as decimal(38,18),\n\t\tpeamexcdate as timestamp,\n\t\tpeamexcurr as string,\n\t\tpeamexpro as decimal(38,18),\n\t\tpeanopdue as decimal(38,18),\n\t\tpeanopurr as string,\n\t\tpeanotaco as decimal(38,18),\n\t\tpeanotdays as decimal(38,18),\n\t\tpeanotlay as decimal(38,18),\n\t\tpeanotsort as decimal(38,18),\n\t\tpeaorgno as string,\n\t\tpeaorigmemberfrom as decimal(38,18),\n\t\tpeaoutcreday as decimal(38,18),\n\t\tpeaoutgiro as decimal(38,18),\n\t\tpeaoutgiroludate as timestamp,\n\t\tpeaoutgirolusign as string,\n\t\tpeaoutgirono as string,\n\t\tpeapeaid as decimal(38,18),\n\t\tpeapersid as string,\n\t\tpeapersrfl as decimal(38,18),\n\t\tpeapibregsign as string,\n\t\tpeaprobor as decimal(38,18),\n\t\tpeaprovmailfreq as decimal(38,18),\n\t\tpeapurtyp as decimal(38,18),\n\t\tpearesdat as timestamp,\n\t\tpeasex as string,\n\t\tpeastaamt as decimal(38,18),\n\t\tpeastaniv as decimal(38,18),\n\t\tpeastatyp as decimal(38,18),\n\t\tpeastdate as timestamp,\n\t\tpeastensw as decimal(38,18),\n\t\tpeastopcod as decimal(38,18),\n\t\tpeastoppremnote as string,\n\t\tpeastopuse as string,\n\t\tpeasttniv as decimal(38,18),\n\t\tpeasttprmclm as decimal(38,18),\n\t\tpeasubtype as decimal(38,18),\n\t\tpeasw10 as string,\n\t\tpeaswink as decimal(38,18),\n\t\tpeaswrun as decimal(38,18),\n\t\tpeausecolfee as string,\n\t\tpeavatno as string,\n\t\tpeavendorid as string,\n\t\tpeaxlcurr as string,\n\t\tpeaxlpoin as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> pea\nsource(output(\n\t\ticaadmfeerate as decimal(38,18),\n\t\ticaagaid as string,\n\t\ticaaggregate as decimal(38,18),\n\t\ticaamtcod as string,\n\t\ticaamtlevel as decimal(38,18),\n\t\ticaavrperspre as decimal(38,18),\n\t\ticac1000prem as decimal(38,18),\n\t\ticacadate as timestamp,\n\t\ticacantxt as string,\n\t\ticacasign as string,\n\t\ticachdate as timestamp,\n\t\ticachhour as decimal(38,18),\n\t\ticacorrty as decimal(38,18),\n\t\ticacrdate as timestamp,\n\t\ticacrobbid as string,\n\t\ticacrsign as string,\n\t\ticacslynsw as string,\n\t\ticadayamt as decimal(38,18),\n\t\ticadaysinall as decimal(38,18),\n\t\ticadeclaredamt as decimal(38,18),\n\t\ticadeclaredamtlocal as decimal(38,18),\n\t\ticadednote as string,\n\t\ticadeliverydate as timestamp,\n\t\ticaendate as timestamp,\n\t\ticaenhour as decimal(38,18),\n\t\ticaeoamt as decimal(38,18),\n\t\ticaeoamtcod as string,\n\t\ticaexhausted as decimal(38,18),\n\t\ticaexpendate as timestamp,\n\t\ticaexpenhour as decimal(38,18),\n\t\ticaexptext as string,\n\t\ticaextndisc as decimal(38,18),\n\t\ticaextshare as decimal(38,18),\n\t\ticafixownrnote as string,\n\t\ticafixownrynsw as string,\n\t\ticagt as decimal(38,18),\n\t\ticaicaid as string,\n\t\ticainaid as string,\n\t\ticaindate as timestamp,\n\t\ticaint100prem as decimal(38,18),\n\t\ticaintcurr as string,\n\t\ticaintgrlag as decimal(38,18),\n\t\ticaintosprem as decimal(38,18),\n\t\ticaintrate as decimal(38,18),\n\t\ticaknvmark as string,\n\t\ticalaunchdate as timestamp,\n\t\ticalimldescr as string,\n\t\ticaludate as timestamp,\n\t\ticalusign as string,\n\t\ticamincurr as string,\n\t\ticaminpre as decimal(38,18),\n\t\ticanoofpersons as decimal(38,18),\n\t\ticanote as string,\n\t\ticaobno as decimal(38,18),\n\t\ticaoforder as decimal(38,18),\n\t\ticaosvolamt as decimal(38,18),\n\t\ticaourshare as decimal(38,18),\n\t\ticaowndisc as decimal(38,18),\n\t\ticaoyrno as decimal(38,18),\n\t\ticaoyrnote as string,\n\t\ticaoyrto as decimal(38,18),\n\t\ticapaymfreq as decimal(38,18),\n\t\ticapaymperc as decimal(38,18),\n\t\ticaperspre as decimal(38,18),\n\t\ticapmlamt as decimal(38,18),\n\t\ticapmlcurr as string,\n\t\ticapremgt as decimal(38,18),\n\t\ticaprevyadmfee as decimal(38,18),\n\t\ticaprevyinstad as decimal(38,18),\n\t\ticaprevynatpre as decimal(38,18),\n\t\ticaprevypre as decimal(38,18),\n\t\ticaprevyrate as decimal(38,18),\n\t\ticaprovst as decimal(38,18),\n\t\ticaprwdate as timestamp,\n\t\ticarinote as string,\n\t\ticariobjecttype as string,\n\t\ticasondisc as decimal(38,18),\n\t\ticastat3 as string,\n\t\ticastdate as timestamp,\n\t\ticasthour as decimal(38,18),\n\t\ticasufix2 as string,\n\t\ticat1000prem as decimal(38,18),\n\t\ticatlorat as decimal(38,18),\n\t\ticatotamt as decimal(38,18),\n\t\ticaunitamt as decimal(38,18),\n\t\ticaunitprem as decimal(38,18),\n\t\ticaunits as decimal(38,18),\n\t\ticauwaid as string,\n\t\ticauwkey as string,\n\t\ticauwtotamt as decimal(38,18),\n\t\ticawroforder as decimal(38,18),\n\t\ticawrshare as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> ica\nsource(output(\n\t\tiuvcrdate as timestamp,\n\t\tiuvcrsign as string,\n\t\tiuvicaid as string,\n\t\tiuviuvid as string,\n\t\tiuviuvver as decimal(38,18),\n\t\tiuvuwaid as string,\n\t\tiuvuwbid as string,\n\t\tiuvvaldate as timestamp,\n\t\tiuvverstat as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> iuv\nsource(output(\n\t\tiuwaccg as decimal(38,18),\n\t\tiuwaddbordrule as decimal(38,18),\n\t\tiuwborefl as string,\n\t\tiuwbroker as decimal(38,18),\n\t\tiuwclabordrule as decimal(38,18),\n\t\tiuwclmbordrule as decimal(38,18),\n\t\tiuwclobordrule as decimal(38,18),\n\t\tiuwcomcod as string,\n\t\tiuwcorbordrule as decimal(38,18),\n\t\tiuwgrndisc as decimal(38,18),\n\t\tiuwinsurer as decimal(38,18),\n\t\tiuwinsurerscontact as string,\n\t\tiuwinsurerver as string,\n\t\tiuwiuvid as string,\n\t\tiuwiuwid as string,\n\t\tiuwln3 as decimal(38,18),\n\t\tiuwnendisc as decimal(38,18),\n\t\tiuworate as decimal(38,18),\n\t\tiuwoutbusntyp as decimal(38,18),\n\t\tiuwpartisip as decimal(38,18),\n\t\tiuwpgqid as string,\n\t\tiuwprobordrule as decimal(38,18),\n\t\tiuwreof as decimal(38,18),\n\t\tiuwrescod as decimal(38,18),\n\t\tiuwshare as decimal(38,18),\n\t\tiuwtrnref as string,\n\t\tiuwuwlid as string,\n\t\tiuwuwndisc as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> iuw\nsource(output(\n\t\tipaabatementpercentage as decimal(38,18),\n\t\tipaaccrebamtp as decimal(38,18),\n\t\tipaaccrebbase as decimal(38,18),\n\t\tipaaccrebp as decimal(38,18),\n\t\tipaaccrebsh as decimal(38,18),\n\t\tipaadarea as string,\n\t\tipaadcom as decimal(38,18),\n\t\tipaadcomc as decimal(38,18),\n\t\tipaaddst as decimal(38,18),\n\t\tipaadicomamtp as decimal(38,18),\n\t\tipaadicombase as decimal(38,18),\n\t\tipaadicomp as decimal(38,18),\n\t\tipaadmfee as decimal(38,18),\n\t\tipaadocomamtp as decimal(38,18),\n\t\tipaadocombase as decimal(38,18),\n\t\tipaadocomp as decimal(38,18),\n\t\tipaagaid as string,\n\t\tipaagbaseamtp as decimal(38,18),\n\t\tipaagtynsw as string,\n\t\tipaapprovestatus as string,\n\t\tipaassetsubno as decimal(38,18),\n\t\tipabonusamt as decimal(38,18),\n\t\tipabonusndisc as decimal(38,18),\n\t\tipaccqid as string,\n\t\tipaclodate as timestamp,\n\t\tipaclstat as decimal(38,18),\n\t\tipacosig1 as string,\n\t\tipacosig2 as string,\n\t\tipacrdate as timestamp,\n\t\tipacrsign as string,\n\t\tipacurr as string,\n\t\tipadwbsname as string,\n\t\tipaeingrpre as decimal(38,18),\n\t\tipaendate as timestamp,\n\t\tipaenhour as decimal(38,18),\n\t\tipaeoutpre as decimal(38,18),\n\t\tipagnsw as decimal(38,18),\n\t\tipagrossamtp as decimal(38,18),\n\t\tipagrossprem as decimal(38,18),\n\t\tipaicaid as string,\n\t\tipaienteredprem as decimal(38,18),\n\t\tipainaid as string,\n\t\tipaindate as timestamp,\n\t\tipainstad as decimal(38,18),\n\t\tipainstcalctype as decimal(38,18),\n\t\tipainstpertype as decimal(38,18),\n\t\tipaipaid as string,\n\t\tipairatecrew as decimal(38,18),\n\t\tipaiusdgt as decimal(38,18),\n\t\tipaknvmark as string,\n\t\tipalastinstamtp as decimal(38,18),\n\t\tipalastinstperc as decimal(38,18),\n\t\tipalisig1 as string,\n\t\tipalisig2 as string,\n\t\tipaludate as timestamp,\n\t\tipalusign as string,\n\t\tipamaninsynsw as string,\n\t\tipamarketripercentage as decimal(38,18),\n\t\tipaminprem as decimal(38,18),\n\t\tipaminrate as decimal(38,18),\n\t\tipanatpre as decimal(38,18),\n\t\tipanetamtp as decimal(38,18),\n\t\tipanetprem as decimal(38,18),\n\t\tipanote as string,\n\t\tipanoterm as decimal(38,18),\n\t\tipaobno as decimal(38,18),\n\t\tipaorate as decimal(38,18),\n\t\tipaotherexpences as decimal(38,18),\n\t\tipaousdgt as decimal(38,18),\n\t\tipapcdtxt as string,\n\t\tipapcod2 as string,\n\t\tipapcode as string,\n\t\tipapdays as decimal(38,18),\n\t\tipapocid as string,\n\t\tipapocprtln3 as decimal(38,18),\n\t\tipapolnn19 as string,\n\t\tipapoolpercentage as decimal(38,18),\n\t\tipapremn3 as decimal(38,18),\n\t\tipapremri as string,\n\t\tipaprfcomamtp as decimal(38,18),\n\t\tipaprfcombase as decimal(38,18),\n\t\tipaprfcomp as decimal(38,18),\n\t\tipaprocomamtp as decimal(38,18),\n\t\tipaprocombase as decimal(38,18),\n\t\tipaprocomp as decimal(38,18),\n\t\tiparate as decimal(38,18),\n\t\tiparatype as string,\n\t\tiparelcallamtp as decimal(38,18),\n\t\tiparelcallperc as decimal(38,18),\n\t\tipareopenipaid as string,\n\t\tiparesig1 as decimal(38,18),\n\t\tiparesig2 as decimal(38,18),\n\t\tiparetndisc as decimal(38,18),\n\t\tiparetynsw as string,\n\t\tiparicalcdate as timestamp,\n\t\tiparipercentage as decimal(38,18),\n\t\tiparistor as decimal(38,18),\n\t\tiparoundrule as string,\n\t\tipasecrebamtp as decimal(38,18),\n\t\tipasecrebbase as decimal(38,18),\n\t\tipasecrebp as decimal(38,18),\n\t\tipaslipsw as string,\n\t\tipastdate as timestamp,\n\t\tipasthour as decimal(38,18),\n\t\tipatarifamt as decimal(38,18),\n\t\tipatarifndisc as decimal(38,18),\n\t\tipataxamt as decimal(38,18),\n\t\tipataxgnsw as decimal(38,18),\n\t\tipatxcom as decimal(38,18),\n\t\tipatxcomc as decimal(38,18),\n\t\tipavalueicaid as string,\n\t\tipavalueipaid as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> ipa\nsource(output(\n\t\tiszaccadrpeaid as decimal(38,18),\n\t\tiszactnodate as timestamp,\n\t\tiszactnoofemp as decimal(38,18),\n\t\tiszadcom as decimal(38,18),\n\t\tiszagaid as string,\n\t\tiszagtnol as decimal(38,18),\n\t\tiszagtppro as decimal(38,18),\n\t\tiszagtprov as decimal(38,18),\n\t\tiszbusntyp as decimal(38,18),\n\t\tiszcedent as decimal(38,18),\n\t\tiszclmadrpeaid as decimal(38,18),\n\t\tiszclmlead as decimal(38,18),\n\t\tiszcondco as decimal(38,18),\n\t\tiszcrdate as timestamp,\n\t\tiszcrsign as string,\n\t\tiszcshind as decimal(38,18),\n\t\tiszdayamt as decimal(38,18),\n\t\tiszdaysinall as decimal(38,18),\n\t\tiszdedkey as string,\n\t\tiszdefcroynsw as string,\n\t\tiszdefcurr as string,\n\t\tiszdefffotype as decimal(38,18),\n\t\tiszdefinstcalctype as decimal(38,18),\n\t\tiszdefinstpertype as decimal(38,18),\n\t\tiszdefintrst as string,\n\t\tiszdefrdctype as decimal(38,18),\n\t\tiszdefwarrsw as string,\n\t\tiszendate as timestamp,\n\t\tiszenhour as decimal(38,18),\n\t\tiszeoamt as decimal(38,18),\n\t\tiszfee1ynsw as string,\n\t\tiszfee2ynsw as string,\n\t\tiszicospr as decimal(38,18),\n\t\tiszienteredprem as decimal(38,18),\n\t\tisziszid as string,\n\t\tiszludate as timestamp,\n\t\tiszlusign as string,\n\t\tiszmaxdays as decimal(38,18),\n\t\tiszmaxgt as decimal(38,18),\n\t\tiszmaxprem as decimal(38,18),\n\t\tiszmincurr as string,\n\t\tiszmindays as decimal(38,18),\n\t\tiszmingt as decimal(38,18),\n\t\tiszminprem as decimal(38,18),\n\t\tiszmplamt as decimal(38,18),\n\t\tisznoofemp as decimal(38,18),\n\t\tisznoterm as decimal(38,18),\n\t\tiszorate as decimal(38,18),\n\t\tiszosamt as decimal(38,18),\n\t\tiszowndisc as decimal(38,18),\n\t\tiszpayer as decimal(38,18),\n\t\tiszrate as decimal(38,18),\n\t\tiszratema as string,\n\t\tiszratind as decimal(38,18),\n\t\tiszristor as decimal(38,18),\n\t\tiszsecnn as decimal(38,18),\n\t\tiszsondisc as decimal(38,18),\n\t\tiszstdate as timestamp,\n\t\tiszsthour as decimal(38,18),\n\t\tisztlorat as decimal(38,18),\n\t\tisztotamt as decimal(38,18),\n\t\tisztotind as decimal(38,18),\n\t\tisztxcom as decimal(38,18),\n\t\tisztzone as string,\n\t\tiszusdgt as decimal(38,18),\n\t\tiszuwkey as string,\n\t\tiszuwradrpeaid as decimal(38,18),\n\t\tiszwarranty2 as decimal(38,18),\n\t\tiszwarrenty as decimal(38,18)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> isz\nsource(output(\n\t\tisaafpcovered as string,\n\t\tisaagaid as string,\n\t\tisaaggid as string,\n\t\tisaassured as decimal(38,18),\n\t\tisabusnbranch as decimal(38,18),\n\t\tisacrdate as timestamp,\n\t\tisacrsign as string,\n\t\tisadednote as string,\n\t\tisadisablcovered as string,\n\t\tisaeg100prem as decimal(38,18),\n\t\tisaegcurr as string,\n\t\tisaegprem as decimal(38,18),\n\t\tisaentertype as decimal(38,18),\n\t\tisaexpadcom as decimal(38,18),\n\t\tisaexpagtnol as decimal(38,18),\n\t\tisaexpagtppro as decimal(38,18),\n\t\tisaexpagtprov as decimal(38,18),\n\t\tisaexpcshind as decimal(38,18),\n\t\tisaexpdays as decimal(38,18),\n\t\tisaexpendate as timestamp,\n\t\tisaexpiretype as decimal(38,18),\n\t\tisaexpnoofve as decimal(38,18),\n\t\tisaexpnote as string,\n\t\tisaexposprem as decimal(38,18),\n\t\tisaexpowdisc as string,\n\t\tisaexpownret as decimal(38,18),\n\t\tisaexppro as decimal(38,18),\n\t\tisaexpsodisc as string,\n\t\tisaexpstdate as timestamp,\n\t\tisaexptopamt as decimal(38,18),\n\t\tisaexptopcurr as string,\n\t\tisaexptopname as string,\n\t\tisaexptotind as decimal(38,18),\n\t\tisaexptxcom as decimal(38,18),\n\t\tisafilingstate as string,\n\t\tisafromsecnn as decimal(38,18),\n\t\tisaisaid as string,\n\t\tisaknvmark as string,\n\t\tisalayertype as decimal(38,18),\n\t\tisalisttxt35 as string,\n\t\tisalongname as string,\n\t\tisalostcode as string,\n\t\tisalosttxt35 as string,\n\t\tisaludate as timestamp,\n\t\tisalusign as string,\n\t\tisamaxpro as decimal(38,18),\n\t\tisaminpro as decimal(38,18),\n\t\tisanextsecnn as decimal(38,18),\n\t\tisanoofve as decimal(38,18),\n\t\tisanote as string,\n\t\tisaobjctp as string,\n\t\tisaobjtfr as decimal(38,18),\n\t\tisaobjtto as decimal(38,18),\n\t\tisaobno as decimal(38,18),\n\t\tisaoffshoreynsw as string,\n\t\tisaordercode as string,\n\t\tisaordersecnn as decimal(38,18),\n\t\tisaordertxt35 as string,\n\t\tisaownerincynsw as string,\n\t\tisaownret as decimal(38,18),\n\t\tisaoxno as decimal(38,18),\n\t\tisaoxrefid as string,\n\t\tisaprevsecnn as decimal(38,18),\n\t\tisaproduct as string,\n\t\tisaquesettlonly as string,\n\t\tisarecpro as decimal(38,18),\n\t\tisaseccode as string,\n\t\tisasecnam as string,\n\t\tisasecnn as decimal(38,18),\n\t\tisasectype as string,\n\t\tisasigpro as decimal(38,18),\n\t\tisaslipref as string,\n\t\tisastatus as string,\n\t\tisasurplbroker as decimal(38,18),\n\t\tisataraynsw as string,\n\t\tisatarbynsw as string,\n\t\tisatarcynsw as string,\n\t\tisatardynsw as string,\n\t\tisatareynsw as string,\n\t\tisatopname as string,\n\t\tisatopvalueamt as decimal(38,18),\n\t\tisatopvaluecurr as string,\n\t\tisaufafpynsw as string,\n\t\tisausecod as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> isa\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> aga\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> ina\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet') ~> obb\ntcross filter(SOURCE_SYSTEM == 'PARIS' && \r\nCODE_TYPE_ID == 122) ~> FilterCoverage\nFilterCoverage select(mapColumn(\n\t\tcov_source_code_key = SOURCE_CODE_KEY,\n\t\tcov_target_coede = TARGET_CODE\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> tcrossCoverage\ntcross filter(SOURCE_SYSTEM == 'PARIS' && \r\n CODE_TYPE_ID == 113) ~> FilterAgreementType\nFilterAgreementType select(mapColumn(\n\t\tagt_source_code_key = SOURCE_CODE_KEY,\n\t\tagt_target_code = TARGET_CODE,\n\t\tagt_target_description = TARGET_DESCRIPTION\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> TcrossAgreementType\ntcross filter(SOURCE_SYSTEM =='PARIS' && \r\n  CODE_TYPE_ID == 106) ~> FilterBusinessArea\nFilterBusinessArea select(mapColumn(\n\t\tbua_source_code_key = SOURCE_CODE_KEY,\n\t\tbua_target_code = TARGET_CODE\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> TcrossBusinessArea\ntcross filter(SOURCE_SYSTEM  =='PARIS' &&  CODE_TYPE_ID  ==124) ~> FilterCurrency\nFilterCurrency select(mapColumn(\n\t\tsource_code_key = SOURCE_CODE_KEY,\n\t\ttarget_code = TARGET_CODE\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> TcrossCurrency\ntcross filter(SOURCE_SYSTEM == 'PARIS'  \r\n&& CODE_TYPE_ID  == 45) ~> FilterVesselSubType\nFilterVesselSubType select(mapColumn(\n\t\tsub_type_source_code_key = SOURCE_CODE_KEY,\n\t\tsub_type_target_code = TARGET_CODE,\n\t\tsub_type_target_description = TARGET_DESCRIPTION\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> TcrossVesselSubType\nica select(mapColumn(\n\t\ticaicaid,\n\t\ticaourshare\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> icatable\npea select(mapColumn(\n\t\tpeapeaid,\n\t\tpeaccode\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> peatable\niuv filter(iuvverstat == 'A') ~> IuvverstatA\nIuvverstatA select(mapColumn(\n\t\tiuvicaid,\n\t\tiuviuvid\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> iuvtable\niuw select(mapColumn(\n\t\tiuwiuwid = iuwiuvid,\n\t\tiuwpartisip,\n\t\tiuwoutbusntyp,\n\t\tiuwshare\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> iuwtable\nicatable, iuvtable join(icaicaid == iuvicaid,\n\tjoinType:'inner',\n\tbroadcast: 'none')~> IcaIuv\nIcaIuv, iuwtable join(iuviuvid == iuwiuwid,\n\tjoinType:'inner',\n\tbroadcast: 'none')~> IcaIuw\nIcaIuw, peatable join(iuwpartisip == peapeaid,\n\tjoinType:'inner',\n\tbroadcast: 'none')~> IuwPea\nIuwPea derive(own_share = case(peaccode == 91,\r\n    iifNull( iuwshare  ,0), iuwshare ),\n\t\tcut_share = case(peaccode  == 92,\r\niifNull( iuwshare  ,0) \r\n,iuwshare)\r\n ,\n\t\tco_share = case(peaccode !=91 ||peaccode != 92 ,case(iuwoutbusntyp == 2, iifNull(iuwshare, 0)),iuwshare),\n\t\tre_share = case(peaccode !=91 ||peaccode != 92 ,case(iuwoutbusntyp == 3, iifNull(iuwshare, 0)))\r\n) ~> Expression\nExpression aggregate(groupBy(icaicaid),\n\town_share = sum(own_share),\n\t\tre_share = sum(re_share),\n\t\tco_share = sum(co_share),\n\t\tcut_share = sum(cut_share),\n\t\ticaourshare = max(icaourshare)) ~> AggregateIcaicaid\nipa filter(ipapcode == 'O'||ipapcode == 'P'\r\n&& ipapremn3== 1) ~> IpacodeOP\nIpacodeOP select(mapColumn(\n\t\tipaicaid,\n\t\tiparate,\n\t\tipaiuddgt = ipaiusdgt,\n\t\tipairatecrew\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ipatable"
		}
	}
}