{
	"name": "m_pre_dim_sub_claim_detail_pa",
	"properties": {
		"description": "Created by olseir 29.06.2020\nBased on m_pre_diom_sub_claim_detail_me in Oracle",
		"folder": {
			"name": "dwh_prepare/pre_dim"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "lga",
					"description": "distinct lgalcaid where lgacrcode = R"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "lca"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "ica"
				},
				{
					"dataset": {
						"referenceName": "azure_sql_server",
						"type": "DatasetReference"
					},
					"name": "aga"
				},
				{
					"name": "source1"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "lgalca"
				},
				{
					"name": "lgalcaica"
				},
				{
					"name": "lgalcaicaaga"
				}
			],
			"script": "source(output(\n\t\tlgalcaid as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select distinct  lgalcaid from dwh_stage.p_lgatable\\nwhere lgacrcode = \\'R\\'',\n\tformat: 'query') ~> lga\nsource(output(\n\t\tlcarecovachintnote as string,\n\t\tlcarecovachdate as date,\n\t\tlcarecovachynsw as string,\n\t\tlcarecovachsign as string,\n\t\tlcarecovremdate as date,\n\t\tlcaicaid as string,\n\t\tlcarecovpotynsw as string,\n\t\tlcarecovpotintnote as string,\n\t\tlcarecovccvid as short,\n\t\tlcatrtmco as integer,\n\t\tlcalcaid as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select  lcarecovachintnote, lcarecovachdate, lcarecovachynsw, lcarecovachsign, lcarecovremdate, lcaicaid, lcarecovpotynsw, lcarecovpotintnote, lcarecovccvid, lcatrtmco , lcalcaid\\nfrom dwh_stage.p_lcatable',\n\tformat: 'query') ~> lca\nsource(output(\n\t\ticaicaid as string,\n\t\ticaagaid as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select icaicaid, icaagaid from dwh_stage.p_icatable',\n\tformat: 'query') ~> ica\nsource(output(\n\t\tagaagaid as string,\n\t\tagabusndiv as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'select agaagaid, agabusndiv from dwh_stage.p_agatable',\n\tformat: 'query') ~> aga\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> source1\nlga, lca join(lgalcaid == lcaicaid,\n\tjoinType:'right',\n\tbroadcast: 'auto')~> lgalca\nlgalca, ica join(lgalcaid == icaicaid,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> lgalcaica\nlgalcaica, aga join(icaagaid == agaagaid,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> lgalcaicaaga"
		}
	}
}