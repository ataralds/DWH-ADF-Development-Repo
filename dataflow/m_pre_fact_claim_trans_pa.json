{
	"name": "m_pre_fact_claim_trans_pa",
	"properties": {
		"description": "Pre fact mapping for claim transactions, excluding guarantees and advance payments.",
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"name": "mapsys",
					"description": "source_system=='PARIS'"
				},
				{
					"name": "ica"
				},
				{
					"name": "obb"
				},
				{
					"name": "oba"
				},
				{
					"name": "aga"
				},
				{
					"name": "agz"
				},
				{
					"name": "fal"
				},
				{
					"name": "lca"
				},
				{
					"name": "lcc"
				},
				{
					"name": "lab"
				},
				{
					"name": "ina"
				},
				{
					"name": "fil"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "xrefCoverage"
				},
				{
					"name": "xrefBusinessarea"
				},
				{
					"name": "xrefExpense"
				},
				{
					"name": "expense"
				},
				{
					"name": "bua"
				},
				{
					"name": "cov"
				},
				{
					"name": "clmcat"
				},
				{
					"name": "xrefClaimcategory"
				},
				{
					"name": "agttype"
				},
				{
					"name": "xrefAgreementtype"
				},
				{
					"name": "fapcurr"
				},
				{
					"name": "xrefCurrencyFAP"
				}
			],
			"script": "source(output(\n\t\tcode_type_id as integer,\n\t\tsource_system as string,\n\t\ttarget_code as string,\n\t\ttarget_description as string,\n\t\tsource_code_key as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> mapsys\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> ica\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> obb\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> oba\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> aga\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> agz\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> fal\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> lca\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> lcc\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> lab\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> ina\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> fil\ncov select(mapColumn(\n\t\teach(match(name=='target_code'||name=='target_description'||name=='source_code_key'),\n\t\t\t$$+'_cov' = $$)\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> xrefCoverage\nbua select(mapColumn(\n\t\teach(match(name=='target_code'||name=='target_description'||name=='source_code_key'),\n\t\t\t$$+'_bua' = $$)\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> xrefBusinessarea\nexpense select(mapColumn(\n\t\teach(match(name=='target_code'||name=='target_description'||name=='source_code_key'),\n\t\t\t$$+'_expense' = $$)\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> xrefExpense\nmapsys filter(ERROR_FUNCTION('')) ~> expense\nmapsys filter(code_type_id==106) ~> bua\nmapsys filter(code_type_id==122) ~> cov\nmapsys filter(code_type_id==797) ~> clmcat\nclmcat select(mapColumn(\n\t\teach(match(name=='target_code'||name=='target_description'||name=='source_code_key'),\n\t\t\t$$+'_clmcat' = $$)\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> xrefClaimcategory\nmapsys filter(code_type_id==113) ~> agttype\nagttype select(mapColumn(\n\t\teach(match(name=='target_code'||name=='target_description'||name=='source_code_key'),\n\t\t\t$$+'_agttype' = $$)\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> xrefAgreementtype\nmapsys filter(code_type_id==124) ~> fapcurr\nfapcurr select(mapColumn(\n\t\teach(match(name=='target_code'||name=='target_description'||name=='source_code_key'),\n\t\t\t$$+'_fapcurr' = $$)\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> xrefCurrencyFAP"
		}
	}
}